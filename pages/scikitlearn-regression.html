<!DOCTYPE html>
<html lang="en">
<head>
        <meta charset="utf-8" />
        <title>Scikit-Learn Regression</title>
        <link rel="stylesheet" href="/theme/css/main.css" />

        <!--[if IE]>
            <script src="https://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
        <![endif]-->
</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="/">Andrew Burnie's Data Science Blog </a></h1>
                <nav><ul>
                </ul></nav>
        </header><!-- /#banner -->
<section id="content" class="body">
    <h1 class="entry-title">Scikit-Learn Regression</h1>
    
    <style type="text/css">/*!
*
* IPython notebook
*
*/
/* CSS font colors for translated ANSI colors. */
.ansibold {
  font-weight: bold;
}
/* use dark versions for foreground, to improve visibility */
.ansiblack {
  color: black;
}
.ansired {
  color: darkred;
}
.ansigreen {
  color: darkgreen;
}
.ansiyellow {
  color: #c4a000;
}
.ansiblue {
  color: darkblue;
}
.ansipurple {
  color: darkviolet;
}
.ansicyan {
  color: steelblue;
}
.ansigray {
  color: gray;
}
/* and light for background, for the same reason */
.ansibgblack {
  background-color: black;
}
.ansibgred {
  background-color: red;
}
.ansibggreen {
  background-color: green;
}
.ansibgyellow {
  background-color: yellow;
}
.ansibgblue {
  background-color: blue;
}
.ansibgpurple {
  background-color: magenta;
}
.ansibgcyan {
  background-color: cyan;
}
.ansibggray {
  background-color: gray;
}
div.cell {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  border-radius: 2px;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
  border-width: 1px;
  border-style: solid;
  border-color: transparent;
  width: 100%;
  padding: 5px;
  /* This acts as a spacer between cells, that is outside the border */
  margin: 0px;
  outline: none;
  border-left-width: 1px;
  padding-left: 5px;
  background: linear-gradient(to right, transparent -40px, transparent 1px, transparent 1px, transparent 100%);
}
div.cell.jupyter-soft-selected {
  border-left-color: #90CAF9;
  border-left-color: #E3F2FD;
  border-left-width: 1px;
  padding-left: 5px;
  border-right-color: #E3F2FD;
  border-right-width: 1px;
  background: #E3F2FD;
}
@media print {
  div.cell.jupyter-soft-selected {
    border-color: transparent;
  }
}
div.cell.selected {
  border-color: #ababab;
  border-left-width: 0px;
  padding-left: 6px;
  background: linear-gradient(to right, #42A5F5 -40px, #42A5F5 5px, transparent 5px, transparent 100%);
}
@media print {
  div.cell.selected {
    border-color: transparent;
  }
}
div.cell.selected.jupyter-soft-selected {
  border-left-width: 0;
  padding-left: 6px;
  background: linear-gradient(to right, #42A5F5 -40px, #42A5F5 7px, #E3F2FD 7px, #E3F2FD 100%);
}
.edit_mode div.cell.selected {
  border-color: #66BB6A;
  border-left-width: 0px;
  padding-left: 6px;
  background: linear-gradient(to right, #66BB6A -40px, #66BB6A 5px, transparent 5px, transparent 100%);
}
@media print {
  .edit_mode div.cell.selected {
    border-color: transparent;
  }
}
.prompt {
  /* This needs to be wide enough for 3 digit prompt numbers: In[100]: */
  min-width: 14ex;
  /* This padding is tuned to match the padding on the CodeMirror editor. */
  padding: 0.4em;
  margin: 0px;
  font-family: monospace;
  text-align: right;
  /* This has to match that of the the CodeMirror class line-height below */
  line-height: 1.21429em;
  /* Don't highlight prompt number selection */
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  -khtml-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
  /* Use default cursor */
  cursor: default;
}
@media (max-width: 540px) {
  .prompt {
    text-align: left;
  }
}
div.inner_cell {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  /* Old browsers */
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  box-flex: 1;
  /* Modern browsers */
  flex: 1;
}
@-moz-document url-prefix() {
  div.inner_cell {
    overflow-x: hidden;
  }
}
/* input_area and input_prompt must match in top border and margin for alignment */
div.input_area {
  border: 1px solid #cfcfcf;
  border-radius: 2px;
  background: #f7f7f7;
  line-height: 1.21429em;
}
/* This is needed so that empty prompt areas can collapse to zero height when there
   is no content in the output_subarea and the prompt. The main purpose of this is
   to make sure that empty JavaScript output_subareas have no height. */
div.prompt:empty {
  padding-top: 0;
  padding-bottom: 0;
}
div.unrecognized_cell {
  padding: 5px 5px 5px 0px;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
div.unrecognized_cell .inner_cell {
  border-radius: 2px;
  padding: 5px;
  font-weight: bold;
  color: red;
  border: 1px solid #cfcfcf;
  background: #eaeaea;
}
div.unrecognized_cell .inner_cell a {
  color: inherit;
  text-decoration: none;
}
div.unrecognized_cell .inner_cell a:hover {
  color: inherit;
  text-decoration: none;
}
@media (max-width: 540px) {
  div.unrecognized_cell > div.prompt {
    display: none;
  }
}
div.code_cell {
  /* avoid page breaking on code cells when printing */
}
@media print {
  div.code_cell {
    page-break-inside: avoid;
  }
}
/* any special styling for code cells that are currently running goes here */
div.input {
  page-break-inside: avoid;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.input {
    /* Old browsers */
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-box-align: stretch;
    display: -moz-box;
    -moz-box-orient: vertical;
    -moz-box-align: stretch;
    display: box;
    box-orient: vertical;
    box-align: stretch;
    /* Modern browsers */
    display: flex;
    flex-direction: column;
    align-items: stretch;
  }
}
/* input_area and input_prompt must match in top border and margin for alignment */
div.input_prompt {
  color: #303F9F;
  border-top: 1px solid transparent;
}
div.input_area > div.highlight {
  margin: 0.4em;
  border: none;
  padding: 0px;
  background-color: transparent;
}
div.input_area > div.highlight > pre {
  margin: 0px;
  border: none;
  padding: 0px;
  background-color: transparent;
}
/* The following gets added to the <head> if it is detected that the user has a
 * monospace font with inconsistent normal/bold/italic height.  See
 * notebookmain.js.  Such fonts will have keywords vertically offset with
 * respect to the rest of the text.  The user should select a better font.
 * See: https://github.com/ipython/ipython/issues/1503
 *
 * .CodeMirror span {
 *      vertical-align: bottom;
 * }
 */
.CodeMirror {
  line-height: 1.21429em;
  /* Changed from 1em to our global default */
  font-size: 14px;
  height: auto;
  /* Changed to auto to autogrow */
  background: none;
  /* Changed from white to allow our bg to show through */
}
.CodeMirror-scroll {
  /*  The CodeMirror docs are a bit fuzzy on if overflow-y should be hidden or visible.*/
  /*  We have found that if it is visible, vertical scrollbars appear with font size changes.*/
  overflow-y: hidden;
  overflow-x: auto;
}
.CodeMirror-lines {
  /* In CM2, this used to be 0.4em, but in CM3 it went to 4px. We need the em value because */
  /* we have set a different line-height and want this to scale with that. */
  padding: 0.4em;
}
.CodeMirror-linenumber {
  padding: 0 8px 0 4px;
}
.CodeMirror-gutters {
  border-bottom-left-radius: 2px;
  border-top-left-radius: 2px;
}
.CodeMirror pre {
  /* In CM3 this went to 4px from 0 in CM2. We need the 0 value because of how we size */
  /* .CodeMirror-lines */
  padding: 0;
  border: 0;
  border-radius: 0;
}
/*

Original style from softwaremaniacs.org (c) Ivan Sagalaev <Maniac@SoftwareManiacs.Org>
Adapted from GitHub theme

*/
.highlight-base {
  color: #000;
}
.highlight-variable {
  color: #000;
}
.highlight-variable-2 {
  color: #1a1a1a;
}
.highlight-variable-3 {
  color: #333333;
}
.highlight-string {
  color: #BA2121;
}
.highlight-comment {
  color: #408080;
  font-style: italic;
}
.highlight-number {
  color: #080;
}
.highlight-atom {
  color: #88F;
}
.highlight-keyword {
  color: #008000;
  font-weight: bold;
}
.highlight-builtin {
  color: #008000;
}
.highlight-error {
  color: #f00;
}
.highlight-operator {
  color: #AA22FF;
  font-weight: bold;
}
.highlight-meta {
  color: #AA22FF;
}
/* previously not defined, copying from default codemirror */
.highlight-def {
  color: #00f;
}
.highlight-string-2 {
  color: #f50;
}
.highlight-qualifier {
  color: #555;
}
.highlight-bracket {
  color: #997;
}
.highlight-tag {
  color: #170;
}
.highlight-attribute {
  color: #00c;
}
.highlight-header {
  color: blue;
}
.highlight-quote {
  color: #090;
}
.highlight-link {
  color: #00c;
}
/* apply the same style to codemirror */
.cm-s-ipython span.cm-keyword {
  color: #008000;
  font-weight: bold;
}
.cm-s-ipython span.cm-atom {
  color: #88F;
}
.cm-s-ipython span.cm-number {
  color: #080;
}
.cm-s-ipython span.cm-def {
  color: #00f;
}
.cm-s-ipython span.cm-variable {
  color: #000;
}
.cm-s-ipython span.cm-operator {
  color: #AA22FF;
  font-weight: bold;
}
.cm-s-ipython span.cm-variable-2 {
  color: #1a1a1a;
}
.cm-s-ipython span.cm-variable-3 {
  color: #333333;
}
.cm-s-ipython span.cm-comment {
  color: #408080;
  font-style: italic;
}
.cm-s-ipython span.cm-string {
  color: #BA2121;
}
.cm-s-ipython span.cm-string-2 {
  color: #f50;
}
.cm-s-ipython span.cm-meta {
  color: #AA22FF;
}
.cm-s-ipython span.cm-qualifier {
  color: #555;
}
.cm-s-ipython span.cm-builtin {
  color: #008000;
}
.cm-s-ipython span.cm-bracket {
  color: #997;
}
.cm-s-ipython span.cm-tag {
  color: #170;
}
.cm-s-ipython span.cm-attribute {
  color: #00c;
}
.cm-s-ipython span.cm-header {
  color: blue;
}
.cm-s-ipython span.cm-quote {
  color: #090;
}
.cm-s-ipython span.cm-link {
  color: #00c;
}
.cm-s-ipython span.cm-error {
  color: #f00;
}
.cm-s-ipython span.cm-tab {
  background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAMCAYAAAAkuj5RAAAAAXNSR0IArs4c6QAAAGFJREFUSMft1LsRQFAQheHPowAKoACx3IgEKtaEHujDjORSgWTH/ZOdnZOcM/sgk/kFFWY0qV8foQwS4MKBCS3qR6ixBJvElOobYAtivseIE120FaowJPN75GMu8j/LfMwNjh4HUpwg4LUAAAAASUVORK5CYII=);
  background-position: right;
  background-repeat: no-repeat;
}
div.output_wrapper {
  /* this position must be relative to enable descendents to be absolute within it */
  position: relative;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  z-index: 1;
}
/* class for the output area when it should be height-limited */
div.output_scroll {
  /* ideally, this would be max-height, but FF barfs all over that */
  height: 24em;
  /* FF needs this *and the wrapper* to specify full width, or it will shrinkwrap */
  width: 100%;
  overflow: auto;
  border-radius: 2px;
  -webkit-box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8);
  box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8);
  display: block;
}
/* output div while it is collapsed */
div.output_collapsed {
  margin: 0px;
  padding: 0px;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
}
div.out_prompt_overlay {
  height: 100%;
  padding: 0px 0.4em;
  position: absolute;
  border-radius: 2px;
}
div.out_prompt_overlay:hover {
  /* use inner shadow to get border that is computed the same on WebKit/FF */
  -webkit-box-shadow: inset 0 0 1px #000;
  box-shadow: inset 0 0 1px #000;
  background: rgba(240, 240, 240, 0.5);
}
div.output_prompt {
  color: #D84315;
}
/* This class is the outer container of all output sections. */
div.output_area {
  padding: 0px;
  page-break-inside: avoid;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
div.output_area .MathJax_Display {
  text-align: left !important;
}
div.output_area 
div.output_area 
div.output_area img,
div.output_area svg {
  max-width: 100%;
  height: auto;
}
div.output_area img.unconfined,
div.output_area svg.unconfined {
  max-width: none;
}
/* This is needed to protect the pre formating from global settings such
   as that of bootstrap */
.output {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.output_area {
    /* Old browsers */
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-box-align: stretch;
    display: -moz-box;
    -moz-box-orient: vertical;
    -moz-box-align: stretch;
    display: box;
    box-orient: vertical;
    box-align: stretch;
    /* Modern browsers */
    display: flex;
    flex-direction: column;
    align-items: stretch;
  }
}
div.output_area pre {
  margin: 0;
  padding: 0;
  border: 0;
  vertical-align: baseline;
  color: black;
  background-color: transparent;
  border-radius: 0;
}
/* This class is for the output subarea inside the output_area and after
   the prompt div. */
div.output_subarea {
  overflow-x: auto;
  padding: 0.4em;
  /* Old browsers */
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  box-flex: 1;
  /* Modern browsers */
  flex: 1;
  max-width: calc(100% - 14ex);
}
div.output_scroll div.output_subarea {
  overflow-x: visible;
}
/* The rest of the output_* classes are for special styling of the different
   output types */
/* all text output has this class: */
div.output_text {
  text-align: left;
  color: #000;
  /* This has to match that of the the CodeMirror class line-height below */
  line-height: 1.21429em;
}
/* stdout/stderr are 'text' as well as 'stream', but execute_result/error are *not* streams */
div.output_stderr {
  background: #fdd;
  /* very light red background for stderr */
}
div.output_latex {
  text-align: left;
}
/* Empty output_javascript divs should have no height */
div.output_javascript:empty {
  padding: 0;
}
.js-error {
  color: darkred;
}
/* raw_input styles */
div.raw_input_container {
  line-height: 1.21429em;
  padding-top: 5px;
}
pre.raw_input_prompt {
  /* nothing needed here. */
}
input.raw_input {
  font-family: monospace;
  font-size: inherit;
  color: inherit;
  width: auto;
  /* make sure input baseline aligns with prompt */
  vertical-align: baseline;
  /* padding + margin = 0.5em between prompt and cursor */
  padding: 0em 0.25em;
  margin: 0em 0.25em;
}
input.raw_input:focus {
  box-shadow: none;
}
p.p-space {
  margin-bottom: 10px;
}
div.output_unrecognized {
  padding: 5px;
  font-weight: bold;
  color: red;
}
div.output_unrecognized a {
  color: inherit;
  text-decoration: none;
}
div.output_unrecognized a:hover {
  color: inherit;
  text-decoration: none;
}
.rendered_html {
  color: #000;
  /* any extras will just be numbers: */
}



.rendered_html :link {
  text-decoration: underline;
}
.rendered_html :visited {
  text-decoration: underline;
}






.rendered_html h1:first-child {
  margin-top: 0.538em;
}
.rendered_html h2:first-child {
  margin-top: 0.636em;
}
.rendered_html h3:first-child {
  margin-top: 0.777em;
}
.rendered_html h4:first-child {
  margin-top: 1em;
}
.rendered_html h5:first-child {
  margin-top: 1em;
}
.rendered_html h6:first-child {
  margin-top: 1em;
}








.rendered_html * + ul {
  margin-top: 1em;
}
.rendered_html * + ol {
  margin-top: 1em;
}


.rendered_html pre,



.rendered_html tr,
.rendered_html th,

.rendered_html td,


.rendered_html * + table {
  margin-top: 1em;
}

.rendered_html * + p {
  margin-top: 1em;
}

.rendered_html * + img {
  margin-top: 1em;
}
.rendered_html img,

.rendered_html img.unconfined,

div.text_cell {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.text_cell > div.prompt {
    display: none;
  }
}
div.text_cell_render {
  /*font-family: "Helvetica Neue", Arial, Helvetica, Geneva, sans-serif;*/
  outline: none;
  resize: none;
  width: inherit;
  border-style: none;
  padding: 0.5em 0.5em 0.5em 0.4em;
  color: #000;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
}
a.anchor-link:link {
  text-decoration: none;
  padding: 0px 20px;
  visibility: hidden;
}
h1:hover .anchor-link,
h2:hover .anchor-link,
h3:hover .anchor-link,
h4:hover .anchor-link,
h5:hover .anchor-link,
h6:hover .anchor-link {
  visibility: visible;
}
.text_cell.rendered .input_area {
  display: none;
}
.text_cell.rendered 
.text_cell.unrendered .text_cell_render {
  display: none;
}
.cm-header-1,
.cm-header-2,
.cm-header-3,
.cm-header-4,
.cm-header-5,
.cm-header-6 {
  font-weight: bold;
  font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
}
.cm-header-1 {
  font-size: 185.7%;
}
.cm-header-2 {
  font-size: 157.1%;
}
.cm-header-3 {
  font-size: 128.6%;
}
.cm-header-4 {
  font-size: 110%;
}
.cm-header-5 {
  font-size: 100%;
  font-style: italic;
}
.cm-header-6 {
  font-size: 100%;
  font-style: italic;
}
</style>
<style type="text/css">.highlight .hll { background-color: #ffffcc }
.highlight  { background: #f8f8f8; }
.highlight .c { color: #408080; font-style: italic } /* Comment */
.highlight .err { border: 1px solid #FF0000 } /* Error */
.highlight .k { color: #008000; font-weight: bold } /* Keyword */
.highlight .o { color: #666666 } /* Operator */
.highlight .ch { color: #408080; font-style: italic } /* Comment.Hashbang */
.highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */
.highlight .cp { color: #BC7A00 } /* Comment.Preproc */
.highlight .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */
.highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */
.highlight .cs { color: #408080; font-style: italic } /* Comment.Special */
.highlight .gd { color: #A00000 } /* Generic.Deleted */
.highlight .ge { font-style: italic } /* Generic.Emph */
.highlight .gr { color: #FF0000 } /* Generic.Error */
.highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.highlight .gi { color: #00A000 } /* Generic.Inserted */
.highlight .go { color: #888888 } /* Generic.Output */
.highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.highlight .gs { font-weight: bold } /* Generic.Strong */
.highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.highlight .gt { color: #0044DD } /* Generic.Traceback */
.highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: #008000 } /* Keyword.Pseudo */
.highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.highlight .kt { color: #B00040 } /* Keyword.Type */
.highlight .m { color: #666666 } /* Literal.Number */
.highlight .s { color: #BA2121 } /* Literal.String */
.highlight .na { color: #7D9029 } /* Name.Attribute */
.highlight .nb { color: #008000 } /* Name.Builtin */
.highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.highlight .no { color: #880000 } /* Name.Constant */
.highlight .nd { color: #AA22FF } /* Name.Decorator */
.highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */
.highlight .ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.highlight .nf { color: #0000FF } /* Name.Function */
.highlight .nl { color: #A0A000 } /* Name.Label */
.highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */
.highlight .nv { color: #19177C } /* Name.Variable */
.highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.highlight .w { color: #bbbbbb } /* Text.Whitespace */
.highlight .mb { color: #666666 } /* Literal.Number.Bin */
.highlight .mf { color: #666666 } /* Literal.Number.Float */
.highlight .mh { color: #666666 } /* Literal.Number.Hex */
.highlight .mi { color: #666666 } /* Literal.Number.Integer */
.highlight .mo { color: #666666 } /* Literal.Number.Oct */
.highlight .sb { color: #BA2121 } /* Literal.String.Backtick */
.highlight .sc { color: #BA2121 } /* Literal.String.Char */
.highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.highlight .s2 { color: #BA2121 } /* Literal.String.Double */
.highlight .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */
.highlight .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.highlight .sx { color: #008000 } /* Literal.String.Other */
.highlight .sr { color: #BB6688 } /* Literal.String.Regex */
.highlight .s1 { color: #BA2121 } /* Literal.String.Single */
.highlight .ss { color: #19177C } /* Literal.String.Symbol */
.highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */
.highlight .vc { color: #19177C } /* Name.Variable.Class */
.highlight .vg { color: #19177C } /* Name.Variable.Global */
.highlight .vi { color: #19177C } /* Name.Variable.Instance */
.highlight .il { color: #666666 } /* Literal.Number.Integer.Long */</style>
<style type="text/css">
/* Temporary definitions which will become obsolete with Notebook release 5.0 */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-bold { font-weight: bold; }
</style>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The below is a guide to implementing regression machine learning tools using <a href="http://scikit-learn.org/stable/index.html">scikit-learn</a>, a Python package specifically designed for the implementation of machine learning. First, how to implement Ordinary Least Squares is examined, then how the problem of overfitting can be reduced using ridge regression and lasso regression.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 style="text-align: center">The Data Used</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The below uses the Boston house prices dataset, which is one of the <a href="http://scikit-learn.org/stable/datasets/index.html#toy-datasets">'toy datasets'</a> that comes with the scikit-learn package.</p>
<p>This requires importing the <code>datasets</code> module:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [1]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">datasets</span>

<span class="n">boston</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">load_boston</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 style="text-align: center">Preparing the Data</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The dataset provided consists of the following information:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [2]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="k">print</span> <span class="p">[</span><span class="n">s</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">boston</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>['data', 'feature_names', 'DESCR', 'target']
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Full details as to what this dataset contains can be found by running <code>print datasets.load_boston()['DESCR']</code>. There are no missing attribute values, and so focus can be on the data analysis.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>First we randomly split the dataset into a training and test dataset. Here we allocate 25% of the data to the test set:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [3]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.cross_validation</span> <span class="kn">import</span> <span class="n">train_test_split</span>

<span class="n">x_train</span><span class="p">,</span> <span class="n">x_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">boston</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">boston</span><span class="o">.</span><span class="n">target</span><span class="p">,</span> 
                                                    <span class="n">test_size</span> <span class="o">=</span> <span class="mf">0.25</span><span class="p">,</span> <span class="n">random_state</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Note that pandas DataFrames are an <a href="http://scikit-learn.org/stable/modules/generated/sklearn.cross_validation.train_test_split.html">acceptable input</a>, and that output type matches input type (as of version 0.16)</p>
<p>If another user also sets argument <code>random_state = 0</code>, they should get the same split in the data.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 style="text-align: center">Ordinary Least Squares</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We need to import the <code>linear_model</code> module:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [4]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">linear_model</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>As pandas and NumPy provide us with useful (but non-essential) tools:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [5]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="kn">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>To train our model, we run the following:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [6]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">reg_1</span> <span class="o">=</span> <span class="n">linear_model</span><span class="o">.</span><span class="n">LinearRegression</span><span class="p">()</span>
<span class="n">reg_1</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt output_prompt">Out[6]:</div>
<div class="output_text output_subarea output_execute_result">
<pre>LinearRegression(copy_X=True, fit_intercept=True, n_jobs=1, normalize=False)</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Note: <code>reg_1.fit()</code> accepts <a href="http://scikit-learn.org/stable/modules/generated/sklearn.linear_model.LinearRegression.html#sklearn.linear_model.LinearRegression.fit">NumPy arrays as inputs</a>. Hence, if our data is in pandas DataFrame or Series form, then we must apply the <a href="http://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.as_matrix.html"><code>pandas.DataFrame.as_matrix()</code></a> function to convert it into a NumPy array first.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can then find the coefficients for each feature (excluding the intercept):</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [7]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">reg_1</span><span class="o">.</span><span class="n">coef_</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt output_prompt">Out[7]:</div>
<div class="output_text output_subarea output_execute_result">
<pre>array([ -1.16869578e-01,   4.39939421e-02,  -5.34808462e-03,
         2.39455391e+00,  -1.56298371e+01,   3.76145473e+00,
        -6.95007160e-03,  -1.43520477e+00,   2.39755946e-01,
        -1.12937318e-02,  -9.86626289e-01,   8.55687565e-03,
        -5.00029440e-01])</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can find the intercept as follows:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [8]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">reg_1</span><span class="o">.</span><span class="n">intercept_</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt output_prompt">Out[8]:</div>
<div class="output_text output_subarea output_execute_result">
<pre>36.980455337621024</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can use pandas to match the coefficients with <code>feature_names</code>:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [9]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">labelled_coeffs_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">'labels'</span> <span class="p">:</span> <span class="n">boston</span><span class="o">.</span><span class="n">feature_names</span><span class="p">,</span>
                    <span class="s1">'coefficient'</span><span class="p">:</span> <span class="n">reg_1</span><span class="o">.</span><span class="n">coef_</span><span class="p">}</span>

<span class="n">labelled_coeffs_frame</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">labelled_coeffs_dict</span><span class="p">)</span>

<span class="n">labelled_coeffs_frame</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt output_prompt">Out[9]:</div>
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>coefficient</th>
<th>labels</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>-0.116870</td>
<td>CRIM</td>
</tr>
<tr>
<th>1</th>
<td>0.043994</td>
<td>ZN</td>
</tr>
<tr>
<th>2</th>
<td>-0.005348</td>
<td>INDUS</td>
</tr>
<tr>
<th>3</th>
<td>2.394554</td>
<td>CHAS</td>
</tr>
<tr>
<th>4</th>
<td>-15.629837</td>
<td>NOX</td>
</tr>
<tr>
<th>5</th>
<td>3.761455</td>
<td>RM</td>
</tr>
<tr>
<th>6</th>
<td>-0.006950</td>
<td>AGE</td>
</tr>
<tr>
<th>7</th>
<td>-1.435205</td>
<td>DIS</td>
</tr>
<tr>
<th>8</th>
<td>0.239756</td>
<td>RAD</td>
</tr>
<tr>
<th>9</th>
<td>-0.011294</td>
<td>TAX</td>
</tr>
<tr>
<th>10</th>
<td>-0.986626</td>
<td>PTRATIO</td>
</tr>
<tr>
<th>11</th>
<td>0.008557</td>
<td>B</td>
</tr>
<tr>
<th>12</th>
<td>-0.500029</td>
<td>LSTAT</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can then formulate predictions using <code>reg_1.predict(data)</code>:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [10]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">reg_1</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x_test</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt output_prompt">Out[10]:</div>
<div class="output_text output_subarea output_execute_result">
<pre>array([ 24.95242095])</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Note that we use <code>[0:1]</code> even though the prediction is for one value, as inputting 1D arrays will raise <code>ValueError</code> in 0.19</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 style="text-align: center">Significance Testing</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Scikit-learn does not provide an easy way to perform significance tests on individual coefficients. If this is required, a more suitable Python package is <a href="https://pypi.python.org/pypi/statsmodels/0.6.0">statsmodels</a></p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 style="text-align: center">Quality Metrics</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Quality Metrics can be found as follows:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [11]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">metrics</span>

<span class="c1">#Mean Squared Error</span>

<span class="n">mean_squared_error</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">reg_1</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x_test</span><span class="p">),</span> <span class="n">y_test</span><span class="p">)</span>
<span class="c1">#gives same result as: np.mean((reg_1.predict(x_test) - y_test) ** 2)</span>

<span class="k">print</span> <span class="s2">"Mean Squared Error (MSE): {0}"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">mean_squared_error</span><span class="p">)</span>


<span class="c1">#Coefficient of Determination</span>

<span class="n">coefficient_of_determination</span> <span class="o">=</span> <span class="n">reg_1</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">x_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>
<span class="c1">#gives same result as metrics.r2_score(y_true = y_test, y_pred = reg_1.predict(x_test))</span>

<span class="k">print</span> <span class="s2">"R Squared: {0}"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">coefficient_of_determination</span><span class="p">)</span>


<span class="c1">#Residual Sum of Squares (RSS)</span>

<span class="n">RSS</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">reg_1</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x_test</span><span class="p">)</span> <span class="o">-</span> <span class="n">y_test</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>

<span class="k">print</span> <span class="s2">"RSS: {0}"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">RSS</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Mean Squared Error (MSE): 29.7905591642
R Squared: 0.635362078667
RSS: 3783.40101386
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>A full list of metrics is available <a href="http://scikit-learn.org/stable/modules/model_evaluation.html">here</a></p>
<p>Note that all of the above metrics - including <code>score()</code> - apply to all of the Generalized Linear Models in Scikit-learn.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 style="text-align: center">Regularised Regression</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>When the number of observations is much larger than the number of variables, the Ordinary Least Squares' approach will tend to exhibit a low variance - estimates will change little given minor pertubations in the data. Hence, the predictive performance will be strong (Cassella et al, 2015).</p>
<p>However, when the number of observations and variables is similar, there is a risk of overfitting - the model fits the training dataset well but cannot be generalised reliably. When the number of observations is less than the number of variables, Ordinary Least Squares cannot be used at all. In these scenarios, regularisation is required.</p>
<p>Two commonly used approaches are: the <strong>ridge regression</strong> (L<sub>2</sub> regularised regression) and the <strong>lasso regression</strong> (L<sub>1</sub> regularised regression). Both modify the model optimisation process to penalise higher coefficient values, as high values are an indicator of overfitting.</p>
<p>The higher the tuning parameter value (denoted <code>alpha</code> in Scikit-learn), the more higher coefficient values will be penalised. Hence, for both regularised regression approaches, the higher <code>alpha</code>, the lower the coefficient values the optimisation process will generate - with a limit of zero. If <code>alpha</code> is zero, then an Ordinary Least Squares regression will be run.</p>
<p>Under <strong>ridge regression</strong>, all of the features will be kept in the model as we increase <code>alpha</code>. This means a slower, less interpretable model. However, its performance is better when most of the included features drive the target value (Cassella et al, 2015).</p>
<p>Under <strong>lasso regression</strong>, some of the features' values will become exactly zero, as we increase <code>alpha</code>. Hence, a sparser, faster, more interpretable model results. Its performance is better when only a few of the included features are thought to truly drive the dependent variable's value (Cassella et al, 2015). The value of lasso in aiding model interpretation means that it may be performed, even if Ordinary Least Squares is generating reliable predictions.</p>
<p>Both ridge and lasso regression are unreliable when there is a high correlation between different features' values. Ridge leads coefficient values to converge, whilst lasso arbitrarily removes features. Here Elastic Net may provide a more suitable approach (Hastie et al, 2013). This provides a hybrid between lasso and ridge.</p>
<p>The below will discuss how the lasso and ridge regression approaches can be implemented in scikit-learn:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 style="text-align: center">Ridge Regression</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The below uses a tuning parameter value of 0.5, and requires <code>linear_model</code> module:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [12]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">reg_ridge</span> <span class="o">=</span> <span class="n">linear_model</span><span class="o">.</span><span class="n">Ridge</span><span class="p">(</span><span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">)</span>
<span class="n">reg_ridge</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt output_prompt">Out[12]:</div>
<div class="output_text output_subarea output_execute_result">
<pre>Ridge(alpha=0.5, copy_X=True, fit_intercept=True, max_iter=None,
   normalize=False, random_state=None, solver='auto', tol=0.001)</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Coefficients, the intercept and predictions can all be found in the same way as with Ordinary Least Squares:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [13]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="k">print</span> <span class="s2">"Coefficients are: {0}"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">reg_ridge</span><span class="o">.</span><span class="n">coef_</span><span class="p">)</span>

<span class="k">print</span> <span class="s2">"Intercept is: {0}"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">reg_ridge</span><span class="o">.</span><span class="n">intercept_</span><span class="p">)</span>

<span class="k">print</span> <span class="s2">"Prediction for first house in test dataset: {0}"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">reg_ridge</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x_test</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">]))</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Coefficients are: [ -1.14800388e-01   4.48854707e-02  -2.49113266e-02   2.35025027e+00
  -1.07096752e+01   3.79227215e+00  -1.17800878e-02  -1.37038928e+00
   2.24039660e-01  -1.15836405e-02  -9.32419484e-01   8.79786724e-03
  -5.05077028e-01]
Intercept is: 33.5779570383
Prediction for first house in test dataset: [ 24.98197093]
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 style="text-align: center">Finding Optimal `alpha`</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The problem with the above approach is that it arbitrarily chose 0.5 for the value of the tuning parameter value <code>alpha</code>. The following are widely used approaches to choosing <code>alpha</code>:</p>
<ul>
<li><strong>Hold-Out Validation</strong>: One approach to finding the optimal value for <code>alpha</code> would be to split the train data further into a train and validation dataset. The validation dataset could then be used to compare the performance of different models with different values of <code>alpha</code>. Scikit-learn <a href="http://scikit-learn.org/stable/modules/cross_validation.html#cross-validation">discourages</a> Hold-Out Validation, arguing that it reduces the data available for learning the model and that results become dependent on the train/validation split.</li>
</ul>
<ul>
<li><strong>Cross-validation (CV)</strong>: under k-fold CV, we split the train dataset randomly into k subsets - 'folds'. With each fold, we train the model using the rest of the data, and then calculate a validation error using that fold. The final CV error is the mean of these validation errors. Setting k = size of train dataset leads to Leave One Out CV (LOO), this is computationally the slowest technique and leads to the higest variation in estimates of the true error. However, LOO also leads to the least biased estimates of performance. <a href="http://scikit-learn.org/stable/modules/cross_validation.html#leave-one-out-loo">Scikit-learn recommends 5-fold or 10-fold CV</a>.</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 style="text-align: center">Cross-Validation</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>CV is particularly simple to implement in Scikit-learn. There is a version of ridge regression with built-in CV (<a href="http://scikit-learn.org/stable/modules/generated/sklearn.linear_model.RidgeCV.html#sklearn.linear_model.RidgeCV"><code>sklearn.linear_model.RidgeCV</code></a>):</p>
<ul>
<li>The user has to specify which <code>alpha</code> values are to be tested (<code>alphas=</code>). </li>
<li>By default, Generalised Cross-Validation is performed (an efficient form of LOO), although k-fold CV is possible through specifying <code>cv=</code> to k.</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The below example is of 5-fold CV:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [14]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">reg_CV</span> <span class="o">=</span> <span class="n">linear_model</span><span class="o">.</span><span class="n">RidgeCV</span><span class="p">(</span><span class="n">alphas</span><span class="o">=</span><span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">],</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">reg_CV</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt output_prompt">Out[14]:</div>
<div class="output_text output_subarea output_execute_result">
<pre>RidgeCV(alphas=[0.1, 1.0, 10.0], cv=5, fit_intercept=True, gcv_mode=None,
    normalize=False, scoring=None, store_cv_values=False)</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can specify a range of <code>alpha</code> values to be tested using <a href="http://docs.scipy.org/doc/numpy/reference/generated/numpy.linspace.html"><code>numpy.linspace</code></a>. If we want <code>alpha</code> values to be evenly spaced across a log scale, the we can use <a href="http://docs.scipy.org/doc/numpy/reference/generated/numpy.logspace.html"><code>numpy.logspace</code></a> instead.</p>
<p>Below provides an example:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [15]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">reg_CV_2</span> <span class="o">=</span> <span class="n">linear_model</span><span class="o">.</span><span class="n">RidgeCV</span><span class="p">(</span><span class="n">alphas</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">stop</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="mi">100</span><span class="p">),</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">reg_CV_2</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt output_prompt">Out[15]:</div>
<div class="output_text output_subarea output_execute_result">
<pre>RidgeCV(alphas=array([  0.1,   0.2, ...,   9.9,  10. ]), cv=5,
    fit_intercept=True, gcv_mode=None, normalize=False, scoring=None,
    store_cv_values=False)</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>To find which of the alphas values is optimal:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [16]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">reg_CV</span><span class="o">.</span><span class="n">alpha_</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt output_prompt">Out[16]:</div>
<div class="output_text output_subarea output_execute_result">
<pre>0.1</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Coefficients, the intercept and predictions can all be found in the same way as with Ordinary Least Squares:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [17]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="k">print</span> <span class="s2">"Coefficients are: {0}"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">reg_CV</span><span class="o">.</span><span class="n">coef_</span><span class="p">)</span>

<span class="k">print</span> <span class="s2">"Intercept is: {0}"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">reg_CV</span><span class="o">.</span><span class="n">intercept_</span><span class="p">)</span>

<span class="k">print</span> <span class="s2">"Prediction for first house in test dataset: {0}"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">reg_CV</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x_test</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">]))</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Coefficients are: [ -1.16312779e-01   4.42262853e-02  -1.05869052e-02   2.38600155e+00
  -1.43141090e+01   3.77098515e+00  -8.25299886e-03  -1.41784612e+00
   2.35494165e-01  -1.13687149e-02  -9.72048173e-01   8.62134022e-03
  -5.01282582e-01]
Intercept is: 36.059824542
Prediction for first house in test dataset: [ 24.960623]
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 style="text-align: center">Hold-Out Validation</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>To perform Hold-Out Validation, we first need a validation and a training set:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [18]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">x_train_2</span><span class="p">,</span> <span class="n">x_valid</span><span class="p">,</span> <span class="n">y_train_2</span><span class="p">,</span> <span class="n">y_valid</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">x_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> 
                                                          <span class="n">test_size</span> <span class="o">=</span> <span class="mf">0.25</span><span class="p">,</span> <span class="n">random_state</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We train the model on the training data, using several different specific values of <code>alpha</code>:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [19]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">reg_ridge_01</span> <span class="o">=</span> <span class="n">linear_model</span><span class="o">.</span><span class="n">Ridge</span><span class="p">(</span><span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">)</span>
<span class="n">reg_ridge_01</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x_train_2</span><span class="p">,</span> <span class="n">y_train_2</span><span class="p">)</span>

<span class="n">reg_ridge_1</span> <span class="o">=</span> <span class="n">linear_model</span><span class="o">.</span><span class="n">Ridge</span><span class="p">(</span><span class="n">alpha</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">)</span>
<span class="n">reg_ridge_1</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x_train_2</span><span class="p">,</span> <span class="n">y_train_2</span><span class="p">)</span>

<span class="n">reg_ridge_10</span> <span class="o">=</span> <span class="n">linear_model</span><span class="o">.</span><span class="n">Ridge</span><span class="p">(</span><span class="n">alpha</span> <span class="o">=</span> <span class="mf">10.0</span><span class="p">)</span>
<span class="n">reg_ridge_10</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x_train_2</span><span class="p">,</span> <span class="n">y_train_2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt output_prompt">Out[19]:</div>
<div class="output_text output_subarea output_execute_result">
<pre>Ridge(alpha=10.0, copy_X=True, fit_intercept=True, max_iter=None,
   normalize=False, random_state=None, solver='auto', tol=0.001)</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can then compare the models on the validation set, e.g. using Mean Squared Error:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [20]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">MSE_ridge_01</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">reg_ridge_01</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x_valid</span><span class="p">),</span> <span class="n">y_valid</span><span class="p">)</span>
<span class="n">MSE_ridge_1</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">reg_ridge_1</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x_valid</span><span class="p">),</span> <span class="n">y_valid</span><span class="p">)</span>
<span class="n">MSE_ridge_10</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">reg_ridge_10</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x_valid</span><span class="p">),</span> <span class="n">y_valid</span><span class="p">)</span>

<span class="n">alphas</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mi">10</span><span class="p">]</span>
<span class="n">mses</span> <span class="o">=</span> <span class="p">[</span><span class="n">MSE_ridge_01</span><span class="p">,</span> <span class="n">MSE_ridge_1</span><span class="p">,</span> <span class="n">MSE_ridge_10</span><span class="p">]</span>

<span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
    <span class="k">print</span> <span class="s2">"MSE for alpha = {0} is: {1}"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">alphas</span><span class="p">[</span><span class="n">index</span><span class="p">],</span> <span class="n">mses</span><span class="p">[</span><span class="n">index</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>MSE for alpha = 0.1 is: 21.7981625853
MSE for alpha = 1.0 is: 21.316986281
MSE for alpha = 10 is: 21.5791901245
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The above suggests an <code>alpha</code> of 1.0 is optimal.</p>
<p>The below shows how the Validation Error can be visualised for a range of different values of <code>alpha</code> examined:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [21]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="o">%</span><span class="k">matplotlib</span> inline

<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">"Validation Error for different alpha"</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">"alpha"</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">"MSE"</span><span class="p">)</span>

<span class="n">alphas</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">stop</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>

<span class="n">mses</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">alpha</span> <span class="ow">in</span> <span class="n">alphas</span><span class="p">:</span>
    <span class="n">reg_model</span> <span class="o">=</span> <span class="n">linear_model</span><span class="o">.</span><span class="n">Ridge</span><span class="p">(</span><span class="n">alpha</span> <span class="o">=</span> <span class="n">alpha</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x_train_2</span><span class="p">,</span> <span class="n">y_train_2</span><span class="p">)</span>
    <span class="n">mse</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">reg_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x_valid</span><span class="p">),</span> <span class="n">y_valid</span><span class="p">)</span>
    <span class="n">mses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mse</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">alphas</span><span class="p">,</span> <span class="n">mses</span><span class="p">,</span> <span class="s1">'b-'</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
">
</img></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 style="text-align: center">Lasso Regression</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Similar to Ridge Regression, the below uses a tuning parameter value of 0.5, and requires linear_model module:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [22]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">reg_lasso</span> <span class="o">=</span> <span class="n">linear_model</span><span class="o">.</span><span class="n">Ridge</span><span class="p">(</span><span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">)</span>
<span class="n">reg_lasso</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt output_prompt">Out[22]:</div>
<div class="output_text output_subarea output_execute_result">
<pre>Ridge(alpha=0.5, copy_X=True, fit_intercept=True, max_iter=None,
   normalize=False, random_state=None, solver='auto', tol=0.001)</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Coefficients, the intercept and predictions can all be found in the same way as with Ordinary Least Squares:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [23]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="k">print</span> <span class="s2">"Coefficients are: {0}"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">reg_lasso</span><span class="o">.</span><span class="n">coef_</span><span class="p">)</span>

<span class="k">print</span> <span class="s2">"Intercept is: {0}"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">reg_lasso</span><span class="o">.</span><span class="n">intercept_</span><span class="p">)</span>

<span class="k">print</span> <span class="s2">"Prediction for first house in test dataset: {0}"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">reg_lasso</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x_test</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">]))</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Coefficients are: [ -1.14800388e-01   4.48854707e-02  -2.49113266e-02   2.35025027e+00
  -1.07096752e+01   3.79227215e+00  -1.17800878e-02  -1.37038928e+00
   2.24039660e-01  -1.15836405e-02  -9.32419484e-01   8.79786724e-03
  -5.05077028e-01]
Intercept is: 33.5779570383
Prediction for first house in test dataset: [ 24.98197093]
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 style="text-align: center">Cross-Validation</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Just as with ridge regression, there is a version of lasso regression with built-in CV (<a href="http://scikit-learn.org/stable/modules/generated/sklearn.linear_model.LassoCV.html#sklearn.linear_model.LassoCV"><code>sklearn.linear_model.LassoCV</code></a>). We specify a lasso regression to be run on specific <code>alpha</code>:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [24]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">reg_lasso_CV</span> <span class="o">=</span> <span class="n">linear_model</span><span class="o">.</span><span class="n">LassoCV</span><span class="p">(</span><span class="n">eps</span> <span class="o">=</span> <span class="bp">None</span><span class="p">,</span> <span class="n">n_alphas</span> <span class="o">=</span> <span class="bp">None</span><span class="p">,</span> <span class="n">alphas</span><span class="o">=</span><span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">],</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">reg_lasso_CV</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt output_prompt">Out[24]:</div>
<div class="output_text output_subarea output_execute_result">
<pre>LassoCV(alphas=[0.1, 1.0, 10.0], copy_X=True, cv=5, eps=None,
    fit_intercept=True, max_iter=1000, n_alphas=None, n_jobs=1,
    normalize=False, positive=False, precompute='auto', random_state=None,
    selection='cyclic', tol=0.0001, verbose=False)</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Note that the default cross-validation technique (<code>cv=</code>) is three-fold cross-validation.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Unlike with ridge regression, we can specify parameters that determine how the lasso regression iteratively fits along a regularisation path - specifically the length of the path <code>eps=</code> (default sets <code>alpha_min/alpha_max = 0.001</code>) and the number of alphas along the path <code>n_alphas=</code> (default 100):</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [25]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">reg_lasso_CV_2</span> <span class="o">=</span> <span class="n">linear_model</span><span class="o">.</span><span class="n">LassoCV</span><span class="p">(</span><span class="n">eps</span> <span class="o">=</span> <span class="mf">0.001</span><span class="p">,</span> <span class="n">n_alphas</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">reg_lasso_CV_2</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt output_prompt">Out[25]:</div>
<div class="output_text output_subarea output_execute_result">
<pre>LassoCV(alphas=None, copy_X=True, cv=5, eps=0.001, fit_intercept=True,
    max_iter=1000, n_alphas=100, n_jobs=1, normalize=False, positive=False,
    precompute='auto', random_state=None, selection='cyclic', tol=0.0001,
    verbose=False)</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Finding values is similar to ridge regression:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [26]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="k">print</span> <span class="s2">"Alpha is: {0}"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">reg_lasso_CV_2</span><span class="o">.</span><span class="n">alpha_</span><span class="p">)</span>

<span class="k">print</span> <span class="s2">"Coefficients are: {0}"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">reg_lasso_CV_2</span><span class="o">.</span><span class="n">coef_</span><span class="p">)</span>

<span class="k">print</span> <span class="s2">"Intercept is: {0}"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">reg_lasso_CV_2</span><span class="o">.</span><span class="n">intercept_</span><span class="p">)</span>

<span class="k">print</span> <span class="s2">"Prediction for first house in test dataset: {0}"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">reg_lasso_CV_2</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x_test</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">]))</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Alpha is: 0.802130471801
Coefficients are: [-0.07043985  0.04926236 -0.01149994  0.         -0.          1.39269
  0.0062027  -0.81494627  0.19846461 -0.01397329 -0.81248557  0.00771568
 -0.69739794]
Intercept is: 41.0249442227
Prediction for first house in test dataset: [ 24.49035948]
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Note that the lasso regression introduces a bias in the coefficient values. Hence, if our aim is a model that we can interpret, then we should rerun an Ordinary Least Squares regression including only those features with non-zero coefficients. The above approach also seeks to optimise the model for predictions <strong>not</strong> for interpretation. The best model for interpretation purposes tends to have <a href="http://scikit-learn.org/stable/modules/feature_selection.html#l1-based-feature-selection">fewer features</a> than that provided by <code>LassoCV</code></p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 style="text-align: center">Coefficient Path</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This shows how coefficient values fall to zero as we increase alpha. This can be used to indicate those most important features that are most robust to increasing the tuning parameter:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [27]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.cm</span> <span class="kn">as</span> <span class="nn">cm</span>


<span class="n">alphas_lasso</span><span class="p">,</span> <span class="n">coeffs_lasso</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">linear_model</span><span class="o">.</span><span class="n">lasso_path</span><span class="p">(</span><span class="n">x_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> 
                                                        <span class="n">eps</span> <span class="o">=</span> <span class="mf">0.001</span><span class="p">,</span> <span class="n">n_alphas</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">"-Log(alpha)"</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">"coefficients"</span><span class="p">)</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_color_cycle</span><span class="p">([</span><span class="n">cm</span><span class="o">.</span><span class="n">Paired</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">140</span><span class="p">,</span> <span class="mi">20</span><span class="p">)]</span> <span class="o">+</span> 
                   <span class="p">[</span><span class="n">cm</span><span class="o">.</span><span class="n">Paired</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">140</span><span class="p">,</span> <span class="mi">280</span><span class="p">,</span> <span class="mi">20</span><span class="p">)])</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">alphas_lasso</span><span class="p">),</span> <span class="n">coeffs_lasso</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">labels</span> <span class="o">=</span> <span class="n">boston</span><span class="o">.</span><span class="n">feature_names</span><span class="p">,</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">1.02</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="o">.</span><span class="mi">102</span><span class="p">),</span> <span class="n">loc</span><span class="o">=</span><span class="s2">"best"</span><span class="p">,</span>
           <span class="n">ncol</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">"expand"</span><span class="p">,</span> <span class="n">borderaxespad</span><span class="o">=</span><span class="mf">0.</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre>/Users/andrewburnie/anaconda/envs/ml/lib/python2.7/site-packages/matplotlib/cbook.py:137: MatplotlibDeprecationWarning: The set_color_cycle attribute was deprecated in version 1.5. Use set_prop_cycle instead.
  warnings.warn(message, mplDeprecation, stacklevel=1)
</pre>
</div>
</div>
<div class="output_area"><div class="prompt"></div>
<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
LFgQ8C7nk08+mY0bN7Jy5coa4zdu3MiKFSv49a9/3eTa66LwCJPExERmz57N5ZdfzqJFiyguLqai
ooIlS5Zw4403Njh9fd1dVv2xZWVl8frrr1NQUIC1ljfeeIOvv/6agQMHhuETikh9kpOTufjii5k9
ezbgPeX+1FNPZe3atf7v8xdffEFxcTFvvPFGQPPu06cPl156KZMnT+ajjz7C4/Hw1VdfMW7cOE49
9dSAt5gaQ+ERRjNmzGDevHncfvvtpKen061bNx588EHGjh1b5zRVxzzq6+6yKoQSExO588476d69
O8nJycycOZOHHnqoRveXIhK4urqRbuz7Va6++mreeOMNvvzyS55//nmuvPJKOnTo4P8+V3VLvf/e
hMbM/8EHH+Tiiy/mvPPOIyEhgTPOOIOTTz6Z558Pze56dUMrItKGqRtaEREJG4WHiIgETOEhIiIB
U3iIiEjAFB4iIhIwhYeIiARM4SEiIgFTeIiISMAUHiIiEjCFR5j06NGDjh07Ulxc7B/3+OOP17jn
TENdSI4bN85/B84qY8eO5corrwz9BxBpw6p3Q5uamspZZ53F5s2bnS7LUQqPMDHG4PF4uO+++w4Y
D43rQvLBBx/kpZde4t133wW8/X+sWbOGuXPnhu+DiLRB1buh3bp1K+np6f5+ddoqhUcYXX/99dx7
770H9GH8/fffN6oLyY4dO3LPPfcwbdo0Nm7cyFVXXcUjjzxCbGysA59GpG2pum9eVFQU48aN4+uv
v3a4ImcpPMLouOOOIzMzk7/+9a81xr/99tuN7kJy6tSp9OrVi2OOOYYzzjhDnTyJhFlRURELFy5k
8ODBTpfiqDbVk+C8f54flPnMuCi74UZ1mD17NkOHDuXqq6/2jwu0C8kTTzyRt956i8mTJze5DpGW
5tXHHw3KfEb9blqTpqvqhragoID09HSWLl0alHpaqjYVHgez0g+WX/ziF4waNYq77rqLfv36AYF1
Iblu3Truuecepk+fzowZM/j0009xu91hqV3ESU1d6QdLVTe01lpefvllhg0bxtq1a0lPT3e0Lqdo
t5UDZs2axaOPPuo/W+Pkk09mw4YNjepCctq0acyYMYO///3vxMfHM2fOnLDWLtJWVR3zMMYwduxY
3G4377//vsNVOUfh4YBDDz2Uc889lwceeADwdiH5+9//vsEuJOfPn8+uXbv44x//CMBjjz3GX//6
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
">
</img></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The above coefficient path suggests that 'B' is the most important feature. 'ZN', 'AGE' and 'LSTAT' are also important. To get different colors for the different features, we have used the module <code>matplotlib.cm</code>. It is important to choose a colour map where the colours vary noticeably. The colour maps available can be seen <a href="http://matplotlib.org/examples/color/colormaps_reference.html">here</a>. Note that combining color maps (as in the above code) can enhance colour variation.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Above based on code provided by <a href="http://scikit-learn.org/stable/auto_examples/linear_model/plot_lasso_coordinate_descent_path.html">Scikit-learn</a>. For more information on how to set the legend see <a href="http://matplotlib.org/users/legend_guide.html">matplotlib documentation</a>.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 style="text-align: center">Correlation Matrix</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Lasso and ridge regressions are unreliable when there is a high correlation between different features. We can check for this correlation through use of a correlation matrix. The below examines the strength of the <strong>linear</strong> relationships using Pearson Product-Moment Correlation Coefficients using <a href="http://docs.scipy.org/doc/numpy/reference/generated/numpy.corrcoef.html">NumPy</a>:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [28]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">correlation_matrix</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">corrcoef</span><span class="p">(</span><span class="n">x_train</span><span class="p">,</span> <span class="n">rowvar</span> <span class="o">=</span> <span class="mi">0</span><span class="p">))</span>

<span class="c1">#rowvar = 0 to as rows relate to different records, columns to variables</span>

<span class="c1">#To label the different features:</span>

<span class="n">correlation_matrix</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">boston</span><span class="o">.</span><span class="n">feature_names</span>
<span class="n">correlation_matrix</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">boston</span><span class="o">.</span><span class="n">feature_names</span>

<span class="n">correlation_matrix</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt output_prompt">Out[28]:</div>
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>CRIM</th>
<th>ZN</th>
<th>INDUS</th>
<th>CHAS</th>
<th>NOX</th>
<th>RM</th>
<th>AGE</th>
<th>DIS</th>
<th>RAD</th>
<th>TAX</th>
<th>PTRATIO</th>
<th>B</th>
<th>LSTAT</th>
</tr>
</thead>
<tbody>
<tr>
<th>CRIM</th>
<td>1.000000</td>
<td>-0.199932</td>
<td>0.388912</td>
<td>-0.051498</td>
<td>0.424337</td>
<td>-0.185924</td>
<td>0.338865</td>
<td>-0.365796</td>
<td>0.613971</td>
<td>0.567040</td>
<td>0.270841</td>
<td>-0.300679</td>
<td>0.454672</td>
</tr>
<tr>
<th>ZN</th>
<td>-0.199932</td>
<td>1.000000</td>
<td>-0.528755</td>
<td>-0.052096</td>
<td>-0.524911</td>
<td>0.327201</td>
<td>-0.584627</td>
<td>0.660710</td>
<td>-0.313989</td>
<td>-0.327254</td>
<td>-0.383914</td>
<td>0.168671</td>
<td>-0.428367</td>
</tr>
<tr>
<th>INDUS</th>
<td>0.388912</td>
<td>-0.528755</td>
<td>1.000000</td>
<td>0.046481</td>
<td>0.755708</td>
<td>-0.395119</td>
<td>0.635201</td>
<td>-0.696408</td>
<td>0.578671</td>
<td>0.729234</td>
<td>0.377993</td>
<td>-0.339950</td>
<td>0.616902</td>
</tr>
<tr>
<th>CHAS</th>
<td>-0.051498</td>
<td>-0.052096</td>
<td>0.046481</td>
<td>1.000000</td>
<td>0.059083</td>
<td>0.081925</td>
<td>0.068587</td>
<td>-0.087921</td>
<td>0.007005</td>
<td>-0.027192</td>
<td>-0.092955</td>
<td>0.075155</td>
<td>-0.045924</td>
</tr>
<tr>
<th>NOX</th>
<td>0.424337</td>
<td>-0.524911</td>
<td>0.755708</td>
<td>0.059083</td>
<td>1.000000</td>
<td>-0.287367</td>
<td>0.743524</td>
<td>-0.773083</td>
<td>0.628727</td>
<td>0.686920</td>
<td>0.175481</td>
<td>-0.376619</td>
<td>0.599609</td>
</tr>
<tr>
<th>RM</th>
<td>-0.185924</td>
<td>0.327201</td>
<td>-0.395119</td>
<td>0.081925</td>
<td>-0.287367</td>
<td>1.000000</td>
<td>-0.248617</td>
<td>0.193052</td>
<td>-0.174508</td>
<td>-0.272416</td>
<td>-0.370481</td>
<td>0.131769</td>
<td>-0.612997</td>
</tr>
<tr>
<th>AGE</th>
<td>0.338865</td>
<td>-0.584627</td>
<td>0.635201</td>
<td>0.068587</td>
<td>0.743524</td>
<td>-0.248617</td>
<td>1.000000</td>
<td>-0.760456</td>
<td>0.444960</td>
<td>0.508152</td>
<td>0.237848</td>
<td>-0.255566</td>
<td>0.615801</td>
</tr>
<tr>
<th>DIS</th>
<td>-0.365796</td>
<td>0.660710</td>
<td>-0.696408</td>
<td>-0.087921</td>
<td>-0.773083</td>
<td>0.193052</td>
<td>-0.760456</td>
<td>1.000000</td>
<td>-0.474487</td>
<td>-0.532434</td>
<td>-0.174499</td>
<td>0.262156</td>
<td>-0.516540</td>
</tr>
<tr>
<th>RAD</th>
<td>0.613971</td>
<td>-0.313989</td>
<td>0.578671</td>
<td>0.007005</td>
<td>0.628727</td>
<td>-0.174508</td>
<td>0.444960</td>
<td>-0.474487</td>
<td>1.000000</td>
<td>0.902384</td>
<td>0.443599</td>
<td>-0.436661</td>
<td>0.468507</td>
</tr>
<tr>
<th>TAX</th>
<td>0.567040</td>
<td>-0.327254</td>
<td>0.729234</td>
<td>-0.027192</td>
<td>0.686920</td>
<td>-0.272416</td>
<td>0.508152</td>
<td>-0.532434</td>
<td>0.902384</td>
<td>1.000000</td>
<td>0.449566</td>
<td>-0.427663</td>
<td>0.540966</td>
</tr>
<tr>
<th>PTRATIO</th>
<td>0.270841</td>
<td>-0.383914</td>
<td>0.377993</td>
<td>-0.092955</td>
<td>0.175481</td>
<td>-0.370481</td>
<td>0.237848</td>
<td>-0.174499</td>
<td>0.443599</td>
<td>0.449566</td>
<td>1.000000</td>
<td>-0.157012</td>
<td>0.383061</td>
</tr>
<tr>
<th>B</th>
<td>-0.300679</td>
<td>0.168671</td>
<td>-0.339950</td>
<td>0.075155</td>
<td>-0.376619</td>
<td>0.131769</td>
<td>-0.255566</td>
<td>0.262156</td>
<td>-0.436661</td>
<td>-0.427663</td>
<td>-0.157012</td>
<td>1.000000</td>
<td>-0.388120</td>
</tr>
<tr>
<th>LSTAT</th>
<td>0.454672</td>
<td>-0.428367</td>
<td>0.616902</td>
<td>-0.045924</td>
<td>0.599609</td>
<td>-0.612997</td>
<td>0.615801</td>
<td>-0.516540</td>
<td>0.468507</td>
<td>0.540966</td>
<td>0.383061</td>
<td>-0.388120</td>
<td>1.000000</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can observe a high correlation between some of the features - such as RAD and TAX (0.90). This weakens the reliability of the lasso and ridge regression approaches.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 style="text-align: center">Further Reading</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The above was written using:</p>
<ul>
<li><a href="http://scikit-learn.org/stable/modules/linear_model.html">Scikit-learn guidance on Generalized Linear Models</a></li>
<li>Cassella, G., Fienberg, S. and Olkin, I., 2015. "An Introduction to Statistical Learning: with Applications in R". New York: Springer. Available online as a <a href="http://www-bcf.usc.edu/~gareth/ISL/index.html">pdf</a></li>
<li>Hastie, T., Tibshirani, R., Friedman, J., 2013. "The Elements of Statistical Learning: Data Mining, Inference, and Prediction". New York: Springer. Available online as a <a href="http://statweb.stanford.edu/~tibs/ElemStatLearn/">pdf</a></li>
</ul>
</div>
</div>
</div>
<script type="text/javascript">if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = '//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML';
    mathjaxscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: 'center'," +
        "    displayIndent: '0em'," +
        "    showMathMenu: true," +
        "    tex2jax: { " +
        "        inlineMath: [ ['$','$'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }" +
        "    } " +
        "}); ";
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
</script>

</section>
        <section id="extras" class="body">
                <div class="blogroll">
                        <h2>blogroll</h2>
                        <ul>
                            <li><a href="http://getpelican.com/">Pelican</a></li>
                            <li><a href="http://python.org/">Python.org</a></li>
                            <li><a href="http://jinja.pocoo.org/">Jinja2</a></li>
                            <li><a href="http://pandas.pydata.org/">Pandas</a></li>
                            <li><a href="http://matplotlib.org/">Matplotlib</a></li>
                            <li><a href="http://scikit-learn.org/stable/">Scikit-learn</a></li>
                        </ul>
                </div><!-- /.blogroll -->
                <div class="social">
                        <h2>social</h2>
                        <ul>

                            <li><a href="https://uk.linkedin.com/in/apburnie">LinkedIn Profile</a></li>
                            <li><a href="https://github.com/Andrew47">GitHub Profile</a></li>
                        </ul>
                </div><!-- /.social -->
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a href="http://getpelican.com/">Pelican</a>, which takes great advantage of <a href="http://python.org">Python</a>.
                </address><!-- /#about -->

                <p>The theme is by <a href="http://coding.smashingmagazine.com/2009/08/04/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->

</body>
</html>