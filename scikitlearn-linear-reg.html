<!DOCTYPE html>
<html lang="en">

<head>
      <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="canonical" href="http://Andrew47.github.io/scikitlearn-linear-reg.html" />

    <title>  Andrew Burnie: Data Science Blog &mdash; Scikit-Learn Linear Regression
</title>




    <link rel="stylesheet" href="/theme/css/style.css">

    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->


    <meta name="author" content="Andrew Burnie">
    <meta name="description" content="The below is a guide to implementing linear regression machine learning tools using scikit-learn, a Python package specifically designed for the implementation of machine learning. First, how to implement Ordinary Least Squares is examined, then how the problem of overfitting can be reduced using ridge regression, lasso regression and elastic net.">
  <meta name="tags" contents="python, scikit-learn, regression, linear regression, lasso, ridge, elastic net, ">
</head>

<body>
<header class="header">
  <div class="container">
    <div class="header-inner">
      <h1 class="header-name">
        <a class="nodec" href="http://Andrew47.github.io">Andrew Burnie: Data Science Blog</a>
      </h1>
      <h3 class="header-text"></h3>
      <ul class="header-menu list-inline">
              <li class="muted">|</li>
            <li><a class="nodec" href="http://Andrew47.github.io/pages/author.html">Author</a></li>
              <li class="muted">|</li>
          <li><a class="nodec" href="http://Andrew47.github.io/categories.html">Categories</a></li>
          <li class="muted">|</li>
          <li><a class="nodec" href="http://Andrew47.github.io/tags.html">Tags</a></li>
          <li class="muted">|</li>
          <li><a class="nodec icon-mail-alt" href="mailto:apburnie@hotmail.co.uk"></a></li>
          <li><a class="nodec icon-github" href="https://github.com/Andrew47"></a></li>
      </ul>
    </div>
  </div>
</header> <!-- /.header -->  <div class="container">
  <div class="post full-post">
    <h1 class="post-title">
      <a href="/scikitlearn-linear-reg.html" title="Permalink to Scikit-Learn Linear Regression">Scikit-Learn Linear Regression</a>
    </h1>
    <ul class="list-inline">
      <li class="post-date">
        <a class="text-muted" href="/scikitlearn-linear-reg.html" title="2016-08-20T15:30:00+01:00">Sat 20 August 2016</a>
      </li>
      <li class="muted">&middot;</li>
      <li class="post-category">
        <a href="/category/scikit-learn.html">scikit-learn</a>
      </li>
        <li class="muted">&middot;</li>
        <li>
            <a href="/tag/python.html">python</a>,             <a href="/tag/scikit-learn.html">scikit-learn</a>,             <a href="/tag/regression.html">regression</a>,             <a href="/tag/linear-regression.html">linear regression</a>,             <a href="/tag/lasso.html">lasso</a>,             <a href="/tag/ridge.html">ridge</a>,             <a href="/tag/elastic-net.html">elastic net</a>        </li>
    </ul>
    <div class="post-content">
      <style type="text/css">/*!
*
* IPython notebook
*
*/
/* CSS font colors for translated ANSI colors. */
.ansibold {
  font-weight: bold;
}
/* use dark versions for foreground, to improve visibility */
.ansiblack {
  color: black;
}
.ansired {
  color: darkred;
}
.ansigreen {
  color: darkgreen;
}
.ansiyellow {
  color: #c4a000;
}
.ansiblue {
  color: darkblue;
}
.ansipurple {
  color: darkviolet;
}
.ansicyan {
  color: steelblue;
}
.ansigray {
  color: gray;
}
/* and light for background, for the same reason */
.ansibgblack {
  background-color: black;
}
.ansibgred {
  background-color: red;
}
.ansibggreen {
  background-color: green;
}
.ansibgyellow {
  background-color: yellow;
}
.ansibgblue {
  background-color: blue;
}
.ansibgpurple {
  background-color: magenta;
}
.ansibgcyan {
  background-color: cyan;
}
.ansibggray {
  background-color: gray;
}
div.cell {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  border-radius: 2px;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
  border-width: 1px;
  border-style: solid;
  border-color: transparent;
  width: 100%;
  padding: 5px;
  /* This acts as a spacer between cells, that is outside the border */
  margin: 0px;
  outline: none;
  border-left-width: 1px;
  padding-left: 5px;
  background: linear-gradient(to right, transparent -40px, transparent 1px, transparent 1px, transparent 100%);
}
div.cell.jupyter-soft-selected {
  border-left-color: #90CAF9;
  border-left-color: #E3F2FD;
  border-left-width: 1px;
  padding-left: 5px;
  border-right-color: #E3F2FD;
  border-right-width: 1px;
  background: #E3F2FD;
}
@media print {
  div.cell.jupyter-soft-selected {
    border-color: transparent;
  }
}
div.cell.selected {
  border-color: #ababab;
  border-left-width: 0px;
  padding-left: 6px;
  background: linear-gradient(to right, #42A5F5 -40px, #42A5F5 5px, transparent 5px, transparent 100%);
}
@media print {
  div.cell.selected {
    border-color: transparent;
  }
}
div.cell.selected.jupyter-soft-selected {
  border-left-width: 0;
  padding-left: 6px;
  background: linear-gradient(to right, #42A5F5 -40px, #42A5F5 7px, #E3F2FD 7px, #E3F2FD 100%);
}
.edit_mode div.cell.selected {
  border-color: #66BB6A;
  border-left-width: 0px;
  padding-left: 6px;
  background: linear-gradient(to right, #66BB6A -40px, #66BB6A 5px, transparent 5px, transparent 100%);
}
@media print {
  .edit_mode div.cell.selected {
    border-color: transparent;
  }
}
.prompt {
  /* This needs to be wide enough for 3 digit prompt numbers: In[100]: */
  min-width: 14ex;
  /* This padding is tuned to match the padding on the CodeMirror editor. */
  padding: 0.4em;
  margin: 0px;
  font-family: monospace;
  text-align: right;
  /* This has to match that of the the CodeMirror class line-height below */
  line-height: 1.21429em;
  /* Don't highlight prompt number selection */
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  -khtml-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
  /* Use default cursor */
  cursor: default;
}
@media (max-width: 540px) {
  .prompt {
    text-align: left;
  }
}
div.inner_cell {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  /* Old browsers */
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  box-flex: 1;
  /* Modern browsers */
  flex: 1;
}
@-moz-document url-prefix() {
  div.inner_cell {
    overflow-x: hidden;
  }
}
/* input_area and input_prompt must match in top border and margin for alignment */
div.input_area {
  border: 1px solid #cfcfcf;
  border-radius: 2px;
  background: #f7f7f7;
  line-height: 1.21429em;
}
/* This is needed so that empty prompt areas can collapse to zero height when there
   is no content in the output_subarea and the prompt. The main purpose of this is
   to make sure that empty JavaScript output_subareas have no height. */
div.prompt:empty {
  padding-top: 0;
  padding-bottom: 0;
}
div.unrecognized_cell {
  padding: 5px 5px 5px 0px;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
div.unrecognized_cell .inner_cell {
  border-radius: 2px;
  padding: 5px;
  font-weight: bold;
  color: red;
  border: 1px solid #cfcfcf;
  background: #eaeaea;
}
div.unrecognized_cell .inner_cell a {
  color: inherit;
  text-decoration: none;
}
div.unrecognized_cell .inner_cell a:hover {
  color: inherit;
  text-decoration: none;
}
@media (max-width: 540px) {
  div.unrecognized_cell > div.prompt {
    display: none;
  }
}
div.code_cell {
  /* avoid page breaking on code cells when printing */
}
@media print {
  div.code_cell {
    page-break-inside: avoid;
  }
}
/* any special styling for code cells that are currently running goes here */
div.input {
  page-break-inside: avoid;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.input {
    /* Old browsers */
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-box-align: stretch;
    display: -moz-box;
    -moz-box-orient: vertical;
    -moz-box-align: stretch;
    display: box;
    box-orient: vertical;
    box-align: stretch;
    /* Modern browsers */
    display: flex;
    flex-direction: column;
    align-items: stretch;
  }
}
/* input_area and input_prompt must match in top border and margin for alignment */
div.input_prompt {
  color: #303F9F;
  border-top: 1px solid transparent;
}
div.input_area > div.highlight {
  margin: 0.4em;
  border: none;
  padding: 0px;
  background-color: transparent;
}
div.input_area > div.highlight > pre {
  margin: 0px;
  border: none;
  padding: 0px;
  background-color: transparent;
}
/* The following gets added to the <head> if it is detected that the user has a
 * monospace font with inconsistent normal/bold/italic height.  See
 * notebookmain.js.  Such fonts will have keywords vertically offset with
 * respect to the rest of the text.  The user should select a better font.
 * See: https://github.com/ipython/ipython/issues/1503
 *
 * .CodeMirror span {
 *      vertical-align: bottom;
 * }
 */
.CodeMirror {
  line-height: 1.21429em;
  /* Changed from 1em to our global default */
  font-size: 14px;
  height: auto;
  /* Changed to auto to autogrow */
  background: none;
  /* Changed from white to allow our bg to show through */
}
.CodeMirror-scroll {
  /*  The CodeMirror docs are a bit fuzzy on if overflow-y should be hidden or visible.*/
  /*  We have found that if it is visible, vertical scrollbars appear with font size changes.*/
  overflow-y: hidden;
  overflow-x: auto;
}
.CodeMirror-lines {
  /* In CM2, this used to be 0.4em, but in CM3 it went to 4px. We need the em value because */
  /* we have set a different line-height and want this to scale with that. */
  padding: 0.4em;
}
.CodeMirror-linenumber {
  padding: 0 8px 0 4px;
}
.CodeMirror-gutters {
  border-bottom-left-radius: 2px;
  border-top-left-radius: 2px;
}
.CodeMirror pre {
  /* In CM3 this went to 4px from 0 in CM2. We need the 0 value because of how we size */
  /* .CodeMirror-lines */
  padding: 0;
  border: 0;
  border-radius: 0;
}
/*

Original style from softwaremaniacs.org (c) Ivan Sagalaev <Maniac@SoftwareManiacs.Org>
Adapted from GitHub theme

*/
.highlight-base {
  color: #000;
}
.highlight-variable {
  color: #000;
}
.highlight-variable-2 {
  color: #1a1a1a;
}
.highlight-variable-3 {
  color: #333333;
}
.highlight-string {
  color: #BA2121;
}
.highlight-comment {
  color: #408080;
  font-style: italic;
}
.highlight-number {
  color: #080;
}
.highlight-atom {
  color: #88F;
}
.highlight-keyword {
  color: #008000;
  font-weight: bold;
}
.highlight-builtin {
  color: #008000;
}
.highlight-error {
  color: #f00;
}
.highlight-operator {
  color: #AA22FF;
  font-weight: bold;
}
.highlight-meta {
  color: #AA22FF;
}
/* previously not defined, copying from default codemirror */
.highlight-def {
  color: #00f;
}
.highlight-string-2 {
  color: #f50;
}
.highlight-qualifier {
  color: #555;
}
.highlight-bracket {
  color: #997;
}
.highlight-tag {
  color: #170;
}
.highlight-attribute {
  color: #00c;
}
.highlight-header {
  color: blue;
}
.highlight-quote {
  color: #090;
}
.highlight-link {
  color: #00c;
}
/* apply the same style to codemirror */
.cm-s-ipython span.cm-keyword {
  color: #008000;
  font-weight: bold;
}
.cm-s-ipython span.cm-atom {
  color: #88F;
}
.cm-s-ipython span.cm-number {
  color: #080;
}
.cm-s-ipython span.cm-def {
  color: #00f;
}
.cm-s-ipython span.cm-variable {
  color: #000;
}
.cm-s-ipython span.cm-operator {
  color: #AA22FF;
  font-weight: bold;
}
.cm-s-ipython span.cm-variable-2 {
  color: #1a1a1a;
}
.cm-s-ipython span.cm-variable-3 {
  color: #333333;
}
.cm-s-ipython span.cm-comment {
  color: #408080;
  font-style: italic;
}
.cm-s-ipython span.cm-string {
  color: #BA2121;
}
.cm-s-ipython span.cm-string-2 {
  color: #f50;
}
.cm-s-ipython span.cm-meta {
  color: #AA22FF;
}
.cm-s-ipython span.cm-qualifier {
  color: #555;
}
.cm-s-ipython span.cm-builtin {
  color: #008000;
}
.cm-s-ipython span.cm-bracket {
  color: #997;
}
.cm-s-ipython span.cm-tag {
  color: #170;
}
.cm-s-ipython span.cm-attribute {
  color: #00c;
}
.cm-s-ipython span.cm-header {
  color: blue;
}
.cm-s-ipython span.cm-quote {
  color: #090;
}
.cm-s-ipython span.cm-link {
  color: #00c;
}
.cm-s-ipython span.cm-error {
  color: #f00;
}
.cm-s-ipython span.cm-tab {
  background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAMCAYAAAAkuj5RAAAAAXNSR0IArs4c6QAAAGFJREFUSMft1LsRQFAQheHPowAKoACx3IgEKtaEHujDjORSgWTH/ZOdnZOcM/sgk/kFFWY0qV8foQwS4MKBCS3qR6ixBJvElOobYAtivseIE120FaowJPN75GMu8j/LfMwNjh4HUpwg4LUAAAAASUVORK5CYII=);
  background-position: right;
  background-repeat: no-repeat;
}
div.output_wrapper {
  /* this position must be relative to enable descendents to be absolute within it */
  position: relative;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  z-index: 1;
}
/* class for the output area when it should be height-limited */
div.output_scroll {
  /* ideally, this would be max-height, but FF barfs all over that */
  height: 24em;
  /* FF needs this *and the wrapper* to specify full width, or it will shrinkwrap */
  width: 100%;
  overflow: auto;
  border-radius: 2px;
  -webkit-box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8);
  box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8);
  display: block;
}
/* output div while it is collapsed */
div.output_collapsed {
  margin: 0px;
  padding: 0px;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
}
div.out_prompt_overlay {
  height: 100%;
  padding: 0px 0.4em;
  position: absolute;
  border-radius: 2px;
}
div.out_prompt_overlay:hover {
  /* use inner shadow to get border that is computed the same on WebKit/FF */
  -webkit-box-shadow: inset 0 0 1px #000;
  box-shadow: inset 0 0 1px #000;
  background: rgba(240, 240, 240, 0.5);
}
div.output_prompt {
  color: #D84315;
}
/* This class is the outer container of all output sections. */
div.output_area {
  padding: 0px;
  page-break-inside: avoid;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
div.output_area .MathJax_Display {
  text-align: left !important;
}
div.output_area 
div.output_area 
div.output_area img,
div.output_area svg {
  max-width: 100%;
  height: auto;
}
div.output_area img.unconfined,
div.output_area svg.unconfined {
  max-width: none;
}
/* This is needed to protect the pre formating from global settings such
   as that of bootstrap */
.output {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.output_area {
    /* Old browsers */
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-box-align: stretch;
    display: -moz-box;
    -moz-box-orient: vertical;
    -moz-box-align: stretch;
    display: box;
    box-orient: vertical;
    box-align: stretch;
    /* Modern browsers */
    display: flex;
    flex-direction: column;
    align-items: stretch;
  }
}
div.output_area pre {
  margin: 0;
  padding: 0;
  border: 0;
  vertical-align: baseline;
  color: black;
  background-color: transparent;
  border-radius: 0;
}
/* This class is for the output subarea inside the output_area and after
   the prompt div. */
div.output_subarea {
  overflow-x: auto;
  padding: 0.4em;
  /* Old browsers */
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  box-flex: 1;
  /* Modern browsers */
  flex: 1;
  max-width: calc(100% - 14ex);
}
div.output_scroll div.output_subarea {
  overflow-x: visible;
}
/* The rest of the output_* classes are for special styling of the different
   output types */
/* all text output has this class: */
div.output_text {
  text-align: left;
  color: #000;
  /* This has to match that of the the CodeMirror class line-height below */
  line-height: 1.21429em;
}
/* stdout/stderr are 'text' as well as 'stream', but execute_result/error are *not* streams */
div.output_stderr {
  background: #fdd;
  /* very light red background for stderr */
}
div.output_latex {
  text-align: left;
}
/* Empty output_javascript divs should have no height */
div.output_javascript:empty {
  padding: 0;
}
.js-error {
  color: darkred;
}
/* raw_input styles */
div.raw_input_container {
  line-height: 1.21429em;
  padding-top: 5px;
}
pre.raw_input_prompt {
  /* nothing needed here. */
}
input.raw_input {
  font-family: monospace;
  font-size: inherit;
  color: inherit;
  width: auto;
  /* make sure input baseline aligns with prompt */
  vertical-align: baseline;
  /* padding + margin = 0.5em between prompt and cursor */
  padding: 0em 0.25em;
  margin: 0em 0.25em;
}
input.raw_input:focus {
  box-shadow: none;
}
p.p-space {
  margin-bottom: 10px;
}
div.output_unrecognized {
  padding: 5px;
  font-weight: bold;
  color: red;
}
div.output_unrecognized a {
  color: inherit;
  text-decoration: none;
}
div.output_unrecognized a:hover {
  color: inherit;
  text-decoration: none;
}
.rendered_html {
  color: #000;
  /* any extras will just be numbers: */
}



.rendered_html :link {
  text-decoration: underline;
}
.rendered_html :visited {
  text-decoration: underline;
}






.rendered_html h1:first-child {
  margin-top: 0.538em;
}
.rendered_html h2:first-child {
  margin-top: 0.636em;
}
.rendered_html h3:first-child {
  margin-top: 0.777em;
}
.rendered_html h4:first-child {
  margin-top: 1em;
}
.rendered_html h5:first-child {
  margin-top: 1em;
}
.rendered_html h6:first-child {
  margin-top: 1em;
}








.rendered_html * + ul {
  margin-top: 1em;
}
.rendered_html * + ol {
  margin-top: 1em;
}


.rendered_html pre,



.rendered_html tr,
.rendered_html th,

.rendered_html td,


.rendered_html * + table {
  margin-top: 1em;
}

.rendered_html * + p {
  margin-top: 1em;
}

.rendered_html * + img {
  margin-top: 1em;
}
.rendered_html img,

.rendered_html img.unconfined,

div.text_cell {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.text_cell > div.prompt {
    display: none;
  }
}
div.text_cell_render {
  /*font-family: "Helvetica Neue", Arial, Helvetica, Geneva, sans-serif;*/
  outline: none;
  resize: none;
  width: inherit;
  border-style: none;
  padding: 0.5em 0.5em 0.5em 0.4em;
  color: #000;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
}
a.anchor-link:link {
  text-decoration: none;
  padding: 0px 20px;
  visibility: hidden;
}
h1:hover .anchor-link,
h2:hover .anchor-link,
h3:hover .anchor-link,
h4:hover .anchor-link,
h5:hover .anchor-link,
h6:hover .anchor-link {
  visibility: visible;
}
.text_cell.rendered .input_area {
  display: none;
}
.text_cell.rendered 
.text_cell.unrendered .text_cell_render {
  display: none;
}
.cm-header-1,
.cm-header-2,
.cm-header-3,
.cm-header-4,
.cm-header-5,
.cm-header-6 {
  font-weight: bold;
  font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
}
.cm-header-1 {
  font-size: 185.7%;
}
.cm-header-2 {
  font-size: 157.1%;
}
.cm-header-3 {
  font-size: 128.6%;
}
.cm-header-4 {
  font-size: 110%;
}
.cm-header-5 {
  font-size: 100%;
  font-style: italic;
}
.cm-header-6 {
  font-size: 100%;
  font-style: italic;
}
</style>
<style type="text/css">.highlight .hll { background-color: #ffffcc }
.highlight  { background: #f8f8f8; }
.highlight .c { color: #408080; font-style: italic } /* Comment */
.highlight .err { border: 1px solid #FF0000 } /* Error */
.highlight .k { color: #008000; font-weight: bold } /* Keyword */
.highlight .o { color: #666666 } /* Operator */
.highlight .ch { color: #408080; font-style: italic } /* Comment.Hashbang */
.highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */
.highlight .cp { color: #BC7A00 } /* Comment.Preproc */
.highlight .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */
.highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */
.highlight .cs { color: #408080; font-style: italic } /* Comment.Special */
.highlight .gd { color: #A00000 } /* Generic.Deleted */
.highlight .ge { font-style: italic } /* Generic.Emph */
.highlight .gr { color: #FF0000 } /* Generic.Error */
.highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.highlight .gi { color: #00A000 } /* Generic.Inserted */
.highlight .go { color: #888888 } /* Generic.Output */
.highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.highlight .gs { font-weight: bold } /* Generic.Strong */
.highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.highlight .gt { color: #0044DD } /* Generic.Traceback */
.highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: #008000 } /* Keyword.Pseudo */
.highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.highlight .kt { color: #B00040 } /* Keyword.Type */
.highlight .m { color: #666666 } /* Literal.Number */
.highlight .s { color: #BA2121 } /* Literal.String */
.highlight .na { color: #7D9029 } /* Name.Attribute */
.highlight .nb { color: #008000 } /* Name.Builtin */
.highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.highlight .no { color: #880000 } /* Name.Constant */
.highlight .nd { color: #AA22FF } /* Name.Decorator */
.highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */
.highlight .ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.highlight .nf { color: #0000FF } /* Name.Function */
.highlight .nl { color: #A0A000 } /* Name.Label */
.highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */
.highlight .nv { color: #19177C } /* Name.Variable */
.highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.highlight .w { color: #bbbbbb } /* Text.Whitespace */
.highlight .mb { color: #666666 } /* Literal.Number.Bin */
.highlight .mf { color: #666666 } /* Literal.Number.Float */
.highlight .mh { color: #666666 } /* Literal.Number.Hex */
.highlight .mi { color: #666666 } /* Literal.Number.Integer */
.highlight .mo { color: #666666 } /* Literal.Number.Oct */
.highlight .sb { color: #BA2121 } /* Literal.String.Backtick */
.highlight .sc { color: #BA2121 } /* Literal.String.Char */
.highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.highlight .s2 { color: #BA2121 } /* Literal.String.Double */
.highlight .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */
.highlight .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.highlight .sx { color: #008000 } /* Literal.String.Other */
.highlight .sr { color: #BB6688 } /* Literal.String.Regex */
.highlight .s1 { color: #BA2121 } /* Literal.String.Single */
.highlight .ss { color: #19177C } /* Literal.String.Symbol */
.highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */
.highlight .vc { color: #19177C } /* Name.Variable.Class */
.highlight .vg { color: #19177C } /* Name.Variable.Global */
.highlight .vi { color: #19177C } /* Name.Variable.Instance */
.highlight .il { color: #666666 } /* Literal.Number.Integer.Long */</style>
<style type="text/css">
/* Temporary definitions which will become obsolete with Notebook release 5.0 */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-bold { font-weight: bold; }
</style>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The below is a guide to implementing linear regression machine learning tools using <a href="http://scikit-learn.org/stable/index.html">scikit-learn</a>, a Python package specifically designed for the implementation of machine learning. First, how to implement Ordinary Least Squares is examined, then how the problem of overfitting can be reduced using ridge regression, lasso regression and elastic net.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><h2 style="text-align: center">Index</h2>
Click on the links below to skip to that section:</p>
<ol>
<li><a href="#OLS">Ordinary Least Squares</a></li>
<li><a href="#QM">Quality Metrics</a></li>
<li><a href="#regularised">Regularised Regression:</a>
<ol>
<li><a href="#ridge">Ridge Regression</a></li>
<li><a href="#tuning">Optimising the Tuning Parameter</a></li>
<li><a href="#lasso">Lasso Regression</a></li>
<li><a href="#coefficient">Coefficient Path</a></li>
</ol>
</li>
<li><a href="#matrix">Correlation Matrix</a></li>
<li><a href="#elastic">Elastic Net</a></li>
</ol>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 style="text-align: center">The Data Used</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The below uses the Boston house prices dataset, which is one of the <a href="http://scikit-learn.org/stable/datasets/index.html#toy-datasets">'toy datasets'</a> that comes with the scikit-learn package.</p>
<p>This requires importing the <code>datasets</code> module:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [1]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">datasets</span>

<span class="n">boston</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">load_boston</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 style="text-align: center">Preparing the Data</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The dataset provided consists of the following information:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [2]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="k">print</span> <span class="p">[</span><span class="n">s</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">boston</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>['data', 'feature_names', 'DESCR', 'target']
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Full details as to what this dataset contains can be found by running <code>print datasets.load_boston()['DESCR']</code>. There are no missing attribute values, and so focus can be on the data analysis.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>First we randomly split the dataset into a training and test dataset. Here we allocate 25% of the data to the test set:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [3]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.cross_validation</span> <span class="kn">import</span> <span class="n">train_test_split</span>

<span class="n">x_train</span><span class="p">,</span> <span class="n">x_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">boston</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">boston</span><span class="o">.</span><span class="n">target</span><span class="p">,</span> 
                                                    <span class="n">test_size</span> <span class="o">=</span> <span class="mf">0.25</span><span class="p">,</span> <span class="n">random_state</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Note that pandas DataFrames are an <a href="http://scikit-learn.org/stable/modules/generated/sklearn.cross_validation.train_test_split.html">acceptable input</a>, and that output type matches input type (as of version 0.16)</p>
<p>If another user also sets argument <code>random_state = 0</code>, they should get the same split in the data.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 style="text-align: center"><a name="OLS"></a>1. Ordinary Least Squares</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We need to import the <code>linear_model</code> module:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [4]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">linear_model</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>As pandas and NumPy provide us with useful (but non-essential) tools:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [5]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="kn">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>To train our model, we run the following:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [6]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">reg_1</span> <span class="o">=</span> <span class="n">linear_model</span><span class="o">.</span><span class="n">LinearRegression</span><span class="p">()</span>
<span class="n">reg_1</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt output_prompt">Out[6]:</div>
<div class="output_text output_subarea output_execute_result">
<pre>LinearRegression(copy_X=True, fit_intercept=True, n_jobs=1, normalize=False)</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Note: <code>reg_1.fit()</code> accepts <a href="http://scikit-learn.org/stable/modules/generated/sklearn.linear_model.LinearRegression.html#sklearn.linear_model.LinearRegression.fit">NumPy arrays as inputs</a>. Hence, if our data is in pandas DataFrame or Series form, then we must apply the <a href="http://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.as_matrix.html"><code>pandas.DataFrame.as_matrix()</code></a> function to convert it into a NumPy array first.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can then find the coefficients for each feature (excluding the intercept):</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [7]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">reg_1</span><span class="o">.</span><span class="n">coef_</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt output_prompt">Out[7]:</div>
<div class="output_text output_subarea output_execute_result">
<pre>array([ -1.16869578e-01,   4.39939421e-02,  -5.34808462e-03,
         2.39455391e+00,  -1.56298371e+01,   3.76145473e+00,
        -6.95007160e-03,  -1.43520477e+00,   2.39755946e-01,
        -1.12937318e-02,  -9.86626289e-01,   8.55687565e-03,
        -5.00029440e-01])</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can find the intercept as follows:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [8]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">reg_1</span><span class="o">.</span><span class="n">intercept_</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt output_prompt">Out[8]:</div>
<div class="output_text output_subarea output_execute_result">
<pre>36.980455337620683</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can use pandas to match the coefficients with <code>feature_names</code>:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [9]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">labelled_coeffs_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">'labels'</span> <span class="p">:</span> <span class="n">boston</span><span class="o">.</span><span class="n">feature_names</span><span class="p">,</span>
                    <span class="s1">'coefficient'</span><span class="p">:</span> <span class="n">reg_1</span><span class="o">.</span><span class="n">coef_</span><span class="p">}</span>

<span class="n">labelled_coeffs_frame</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">labelled_coeffs_dict</span><span class="p">)</span>

<span class="n">labelled_coeffs_frame</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt output_prompt">Out[9]:</div>
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>coefficient</th>
<th>labels</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>-0.116870</td>
<td>CRIM</td>
</tr>
<tr>
<th>1</th>
<td>0.043994</td>
<td>ZN</td>
</tr>
<tr>
<th>2</th>
<td>-0.005348</td>
<td>INDUS</td>
</tr>
<tr>
<th>3</th>
<td>2.394554</td>
<td>CHAS</td>
</tr>
<tr>
<th>4</th>
<td>-15.629837</td>
<td>NOX</td>
</tr>
<tr>
<th>5</th>
<td>3.761455</td>
<td>RM</td>
</tr>
<tr>
<th>6</th>
<td>-0.006950</td>
<td>AGE</td>
</tr>
<tr>
<th>7</th>
<td>-1.435205</td>
<td>DIS</td>
</tr>
<tr>
<th>8</th>
<td>0.239756</td>
<td>RAD</td>
</tr>
<tr>
<th>9</th>
<td>-0.011294</td>
<td>TAX</td>
</tr>
<tr>
<th>10</th>
<td>-0.986626</td>
<td>PTRATIO</td>
</tr>
<tr>
<th>11</th>
<td>0.008557</td>
<td>B</td>
</tr>
<tr>
<th>12</th>
<td>-0.500029</td>
<td>LSTAT</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can interpret the above. A unit increase in a given feature increases the expected value of the target variable by the value of the coefficient, <strong>holding all of the other features fixed</strong>. By running <code>boston['DESCR']</code>, we can see that the target variable is the Median value of owner-occupied homes in \$1000's, whilst RM is the average number of rooms per dwelling. Hence, the above model suggests that, for every additional room on average per dwelling (unit increase in RM), there is an expected \$3761.46 increase in the median value of owner-occupied homes.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can then formulate predictions using <code>reg_1.predict(data)</code>:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [10]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">reg_1</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x_test</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt output_prompt">Out[10]:</div>
<div class="output_text output_subarea output_execute_result">
<pre>array([ 24.95242095])</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Note that we use <code>[0:1]</code> even though the prediction is for one value, as inputting 1D arrays will raise <code>ValueError</code> in 0.19</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 style="text-align: center">Significance Testing</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Scikit-learn does not provide an easy way to perform significance tests on individual coefficients. If this is required, a more suitable Python package is <a href="https://pypi.python.org/pypi/statsmodels/0.6.0">statsmodels</a></p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 style="text-align: center"><a name="QM"></a>2. Quality Metrics</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Quality Metrics can be found as follows:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [11]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">metrics</span>

<span class="c1">#Mean Squared Error</span>

<span class="n">mean_squared_error</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">reg_1</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x_test</span><span class="p">),</span> <span class="n">y_test</span><span class="p">)</span>
<span class="c1">#gives same result as: np.mean((reg_1.predict(x_test) - y_test) ** 2)</span>

<span class="k">print</span> <span class="s2">"Mean Squared Error (MSE): {0}"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">mean_squared_error</span><span class="p">)</span>


<span class="c1">#Coefficient of Determination</span>

<span class="n">coefficient_of_determination</span> <span class="o">=</span> <span class="n">reg_1</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">x_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>
<span class="c1">#gives same result as metrics.r2_score(y_true = y_test, y_pred = reg_1.predict(x_test))</span>

<span class="k">print</span> <span class="s2">"R Squared: {0}"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">coefficient_of_determination</span><span class="p">)</span>


<span class="c1">#Residual Sum of Squares (RSS)</span>

<span class="n">RSS</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">reg_1</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x_test</span><span class="p">)</span> <span class="o">-</span> <span class="n">y_test</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>

<span class="k">print</span> <span class="s2">"RSS: {0}"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">RSS</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Mean Squared Error (MSE): 29.7905591642
R Squared: 0.635362078667
RSS: 3783.40101386
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>A full list of metrics is available <a href="http://scikit-learn.org/stable/modules/model_evaluation.html">here</a></p>
<p>Note that all of the above metrics - including <code>score()</code> - apply to all of the Generalized Linear Models in Scikit-learn.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 style="text-align: center"><a name="regularised"></a>3. Regularised Regression</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>When the number of observations is much larger than the number of variables, the Ordinary Least Squares' approach will tend to exhibit a low variance - estimates will change little given minor pertubations in the data. Hence, the predictive performance will be strong (Cassella et al, 2015).</p>
<p>However, when the number of observations and variables is similar, there is a risk of overfitting - the model fits the training dataset well but cannot be generalised reliably. When the number of observations is less than the number of variables, Ordinary Least Squares cannot be used at all. In these scenarios, regularisation is required.</p>
<p>Two commonly used approaches are: the <strong>ridge regression</strong> (L<sub>2</sub> regularised regression) and the <strong>lasso regression</strong> (L<sub>1</sub> regularised regression). Both modify the model optimisation process to penalise higher coefficient values, as high values are an indicator of overfitting.</p>
<p>The higher the tuning parameter value (denoted <code>alpha</code> in Scikit-learn), the more higher coefficient values will be penalised. Hence, for both regularised regression approaches, the higher <code>alpha</code>, the lower the coefficient values the optimisation process will generate - with a limit of zero. If <code>alpha</code> is zero, then an Ordinary Least Squares regression will be run.</p>
<p>Under <strong>ridge regression</strong>, all of the features will be kept in the model as we increase <code>alpha</code>. This means a slower, less interpretable model. However, its performance is better when most of the included features drive the target value (Cassella et al, 2015).</p>
<p>Under <strong>lasso regression</strong>, some of the features' values will become exactly zero, as we increase <code>alpha</code>. Hence, a sparser, faster, more interpretable model results. Its performance is better when only a few of the included features are thought to truly drive the dependent variable's value (Cassella et al, 2015). The value of lasso in aiding model interpretation means that it may be performed, even if Ordinary Least Squares is generating reliable predictions.</p>
<p>Both ridge and lasso regression are unreliable when there is a high correlation between different features' values. Ridge leads coefficient values to converge, whilst lasso arbitrarily removes features. Here Elastic Net may provide a more suitable approach (Hastie et al, 2013). This provides a hybrid between lasso and ridge.</p>
<p>The below will discuss how the lasso and ridge regression approaches can be implemented in scikit-learn:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 style="text-align: center"><a name="ridge"></a>A. Ridge Regression</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The below uses a tuning parameter value of 0.5, and requires <code>linear_model</code> module:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [12]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">reg_ridge</span> <span class="o">=</span> <span class="n">linear_model</span><span class="o">.</span><span class="n">Ridge</span><span class="p">(</span><span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">)</span>
<span class="n">reg_ridge</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt output_prompt">Out[12]:</div>
<div class="output_text output_subarea output_execute_result">
<pre>Ridge(alpha=0.5, copy_X=True, fit_intercept=True, max_iter=None,
   normalize=False, random_state=None, solver='auto', tol=0.001)</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Coefficients, the intercept and predictions can all be found in the same way as with Ordinary Least Squares:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [13]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="k">print</span> <span class="s2">"Coefficients are: {0}"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">reg_ridge</span><span class="o">.</span><span class="n">coef_</span><span class="p">)</span>

<span class="k">print</span> <span class="s2">"Intercept is: {0}"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">reg_ridge</span><span class="o">.</span><span class="n">intercept_</span><span class="p">)</span>

<span class="k">print</span> <span class="s2">"Prediction for first house in test dataset: {0}"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">reg_ridge</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x_test</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">]))</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Coefficients are: [ -1.14800388e-01   4.48854707e-02  -2.49113266e-02   2.35025027e+00
  -1.07096752e+01   3.79227215e+00  -1.17800878e-02  -1.37038928e+00
   2.24039660e-01  -1.15836405e-02  -9.32419484e-01   8.79786724e-03
  -5.05077028e-01]
Intercept is: 33.5779570383
Prediction for first house in test dataset: [ 24.98197093]
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 style="text-align: center"><a name="tuning"></a>B. Optimising the Tuning Parameter</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The problem with the above approach is that it arbitrarily chose 0.5 for the value of the tuning parameter value <code>alpha</code>. The following are widely used approaches to choosing <code>alpha</code>:</p>
<ul>
<li><strong>Hold-Out Validation</strong>: One approach to finding the optimal value for <code>alpha</code> would be to split the train data further into a train and validation dataset. The validation dataset could then be used to compare the performance of different models with different values of <code>alpha</code>. Scikit-learn <a href="http://scikit-learn.org/stable/modules/cross_validation.html#cross-validation">discourages</a> Hold-Out Validation, arguing that it reduces the data available for learning the model and that results become dependent on the train/validation split.</li>
</ul>
<ul>
<li><strong>Cross-validation (CV)</strong>: under k-fold CV, we split the train dataset randomly into k subsets - 'folds'. With each fold, we train the model using the rest of the data, and then calculate a validation error using that fold. The final CV error is the mean of these validation errors. Setting k = size of train dataset leads to Leave One Out CV (LOO), this is computationally the slowest technique and leads to the higest variation in estimates of the true error. However, LOO also leads to the least biased estimates of performance. <a href="http://scikit-learn.org/stable/modules/cross_validation.html#leave-one-out-loo">Scikit-learn recommends 5-fold or 10-fold CV</a>.</li>
</ul>
<p>The above approaches can be extended to lasso regression and to the elastic net approach.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 style="text-align: center">Cross-Validation</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>CV is particularly simple to implement in Scikit-learn. There is a version of ridge regression with built-in CV (<a href="http://scikit-learn.org/stable/modules/generated/sklearn.linear_model.RidgeCV.html#sklearn.linear_model.RidgeCV"><code>sklearn.linear_model.RidgeCV</code></a>):</p>
<ul>
<li>The user has to specify which <code>alpha</code> values are to be tested (<code>alphas=</code>). </li>
<li>By default, Generalised Cross-Validation is performed (an efficient form of LOO), although k-fold CV is possible through specifying <code>cv=</code> to k.</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The below example is of 5-fold CV:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [14]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">reg_CV</span> <span class="o">=</span> <span class="n">linear_model</span><span class="o">.</span><span class="n">RidgeCV</span><span class="p">(</span><span class="n">alphas</span><span class="o">=</span><span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">],</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">reg_CV</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt output_prompt">Out[14]:</div>
<div class="output_text output_subarea output_execute_result">
<pre>RidgeCV(alphas=[0.1, 1.0, 10.0], cv=5, fit_intercept=True, gcv_mode=None,
    normalize=False, scoring=None, store_cv_values=False)</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can specify a range of <code>alpha</code> values to be tested using <a href="http://docs.scipy.org/doc/numpy/reference/generated/numpy.linspace.html"><code>numpy.linspace</code></a>. If we want <code>alpha</code> values to be evenly spaced across a log scale, the we can use <a href="http://docs.scipy.org/doc/numpy/reference/generated/numpy.logspace.html"><code>numpy.logspace</code></a> instead.</p>
<p>Below provides an example:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [15]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">reg_CV_2</span> <span class="o">=</span> <span class="n">linear_model</span><span class="o">.</span><span class="n">RidgeCV</span><span class="p">(</span><span class="n">alphas</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">stop</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="mi">100</span><span class="p">),</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">reg_CV_2</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt output_prompt">Out[15]:</div>
<div class="output_text output_subarea output_execute_result">
<pre>RidgeCV(alphas=array([  0.1,   0.2, ...,   9.9,  10. ]), cv=5,
    fit_intercept=True, gcv_mode=None, normalize=False, scoring=None,
    store_cv_values=False)</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>To find which of the alphas values is optimal:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [16]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">reg_CV</span><span class="o">.</span><span class="n">alpha_</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt output_prompt">Out[16]:</div>
<div class="output_text output_subarea output_execute_result">
<pre>0.1</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Coefficients, the intercept and predictions can all be found in the same way as with Ordinary Least Squares:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [17]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="k">print</span> <span class="s2">"Coefficients are: {0}"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">reg_CV</span><span class="o">.</span><span class="n">coef_</span><span class="p">)</span>

<span class="k">print</span> <span class="s2">"Intercept is: {0}"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">reg_CV</span><span class="o">.</span><span class="n">intercept_</span><span class="p">)</span>

<span class="k">print</span> <span class="s2">"Prediction for first house in test dataset: {0}"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">reg_CV</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x_test</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">]))</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Coefficients are: [ -1.16312779e-01   4.42262853e-02  -1.05869052e-02   2.38600155e+00
  -1.43141090e+01   3.77098515e+00  -8.25299886e-03  -1.41784612e+00
   2.35494165e-01  -1.13687149e-02  -9.72048173e-01   8.62134022e-03
  -5.01282582e-01]
Intercept is: 36.059824542
Prediction for first house in test dataset: [ 24.960623]
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 style="text-align: center">Hold-Out Validation</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>To perform Hold-Out Validation, we first need a validation and a training set:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [18]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">x_train_2</span><span class="p">,</span> <span class="n">x_valid</span><span class="p">,</span> <span class="n">y_train_2</span><span class="p">,</span> <span class="n">y_valid</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">x_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> 
                                                          <span class="n">test_size</span> <span class="o">=</span> <span class="mf">0.25</span><span class="p">,</span> <span class="n">random_state</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We train the model on the training data, using several different specific values of <code>alpha</code>:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [19]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">reg_ridge_01</span> <span class="o">=</span> <span class="n">linear_model</span><span class="o">.</span><span class="n">Ridge</span><span class="p">(</span><span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">)</span>
<span class="n">reg_ridge_01</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x_train_2</span><span class="p">,</span> <span class="n">y_train_2</span><span class="p">)</span>

<span class="n">reg_ridge_1</span> <span class="o">=</span> <span class="n">linear_model</span><span class="o">.</span><span class="n">Ridge</span><span class="p">(</span><span class="n">alpha</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">)</span>
<span class="n">reg_ridge_1</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x_train_2</span><span class="p">,</span> <span class="n">y_train_2</span><span class="p">)</span>

<span class="n">reg_ridge_10</span> <span class="o">=</span> <span class="n">linear_model</span><span class="o">.</span><span class="n">Ridge</span><span class="p">(</span><span class="n">alpha</span> <span class="o">=</span> <span class="mf">10.0</span><span class="p">)</span>
<span class="n">reg_ridge_10</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x_train_2</span><span class="p">,</span> <span class="n">y_train_2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt output_prompt">Out[19]:</div>
<div class="output_text output_subarea output_execute_result">
<pre>Ridge(alpha=10.0, copy_X=True, fit_intercept=True, max_iter=None,
   normalize=False, random_state=None, solver='auto', tol=0.001)</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can then compare the models on the validation set, e.g. using Mean Squared Error:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [20]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">MSE_ridge_01</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">reg_ridge_01</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x_valid</span><span class="p">),</span> <span class="n">y_valid</span><span class="p">)</span>
<span class="n">MSE_ridge_1</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">reg_ridge_1</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x_valid</span><span class="p">),</span> <span class="n">y_valid</span><span class="p">)</span>
<span class="n">MSE_ridge_10</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">reg_ridge_10</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x_valid</span><span class="p">),</span> <span class="n">y_valid</span><span class="p">)</span>

<span class="n">alphas</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mi">10</span><span class="p">]</span>
<span class="n">mses</span> <span class="o">=</span> <span class="p">[</span><span class="n">MSE_ridge_01</span><span class="p">,</span> <span class="n">MSE_ridge_1</span><span class="p">,</span> <span class="n">MSE_ridge_10</span><span class="p">]</span>

<span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
    <span class="k">print</span> <span class="s2">"MSE for alpha = {0} is: {1}"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">alphas</span><span class="p">[</span><span class="n">index</span><span class="p">],</span> <span class="n">mses</span><span class="p">[</span><span class="n">index</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>MSE for alpha = 0.1 is: 21.7981625853
MSE for alpha = 1.0 is: 21.316986281
MSE for alpha = 10 is: 21.5791901245
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The above suggests an <code>alpha</code> of 1.0 is optimal.</p>
<p>The below shows how the Validation Error can be visualised for a range of different values of <code>alpha</code> examined:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [21]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="o">%</span><span class="k">matplotlib</span> inline

<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">"Validation Error for different alpha"</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">"alpha"</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">"MSE"</span><span class="p">)</span>

<span class="n">alphas</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">stop</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>

<span class="n">mses</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">alpha</span> <span class="ow">in</span> <span class="n">alphas</span><span class="p">:</span>
    <span class="n">reg_model</span> <span class="o">=</span> <span class="n">linear_model</span><span class="o">.</span><span class="n">Ridge</span><span class="p">(</span><span class="n">alpha</span> <span class="o">=</span> <span class="n">alpha</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x_train_2</span><span class="p">,</span> <span class="n">y_train_2</span><span class="p">)</span>
    <span class="n">mse</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">reg_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x_valid</span><span class="p">),</span> <span class="n">y_valid</span><span class="p">)</span>
    <span class="n">mses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mse</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">alphas</span><span class="p">,</span> <span class="n">mses</span><span class="p">,</span> <span class="s1">'b-'</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
">
</img></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 style="text-align: center">Data Preparation for Lasso and Elastic Net Regression</h3><p>Under lasso and elastic net regression, features are dropped from the model as we increase the tuning parameter. This can lead to features being dropped simply because they are on a different scale and so are relatively small in magnitude. Hence, there is a need to standardise the features such that they are on the same scale. Following <a href="https://tektrace.wordpress.com/2016/04/09/lasso-regression-in-python-scikit-learn/">this code</a>, we will use <code>sklearn.preprocessing.scale</code>, and then redo the training and test split:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [47]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">preprocessing</span>

<span class="c1">#First we convert boston data into pandas dataframe to simplify subsequent code:</span>

<span class="n">boston</span><span class="o">.</span><span class="n">frame</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">boston</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">columns</span> <span class="o">=</span> <span class="n">boston</span><span class="o">.</span><span class="n">feature_names</span><span class="p">)</span>

<span class="n">boston</span><span class="o">.</span><span class="n">frame</span><span class="p">[</span><span class="s1">'MEDV'</span><span class="p">]</span> <span class="o">=</span> <span class="n">boston</span><span class="o">.</span><span class="n">target</span>

<span class="c1">#We scale our features:</span>

<span class="n">boston</span><span class="o">.</span><span class="n">scaled</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>

<span class="k">for</span> <span class="n">feature</span> <span class="ow">in</span> <span class="n">boston</span><span class="o">.</span><span class="n">feature_names</span><span class="p">:</span>
    <span class="n">boston</span><span class="o">.</span><span class="n">scaled</span><span class="p">[</span><span class="n">feature</span><span class="p">]</span> <span class="o">=</span> <span class="n">preprocessing</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="n">boston</span><span class="o">.</span><span class="n">frame</span><span class="p">[</span><span class="n">feature</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">'float64'</span><span class="p">))</span>

<span class="c1">#We form new train and test data:</span>

<span class="n">x_train_scale</span><span class="p">,</span> <span class="n">x_test_scale</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">boston</span><span class="o">.</span><span class="n">scaled</span><span class="p">,</span> <span class="n">boston</span><span class="o">.</span><span class="n">target</span><span class="p">,</span> 
                                                     <span class="n">test_size</span> <span class="o">=</span> <span class="mf">0.25</span><span class="p">,</span> <span class="n">random_state</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 style="text-align: center"><a name="lasso"></a>C. Lasso Regression</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Similar to Ridge Regression, the below uses a tuning parameter value of 0.2, and requires linear_model module:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [48]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">reg_lasso</span> <span class="o">=</span> <span class="n">linear_model</span><span class="o">.</span><span class="n">Lasso</span><span class="p">(</span><span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.2</span><span class="p">)</span>
<span class="n">reg_lasso</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x_train_scale</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt output_prompt">Out[48]:</div>
<div class="output_text output_subarea output_execute_result">
<pre>Lasso(alpha=0.2, copy_X=True, fit_intercept=True, max_iter=1000,
   normalize=False, positive=False, precompute=False, random_state=None,
   selection='cyclic', tol=0.0001, warm_start=False)</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Coefficients, the intercept and predictions can all be found in the same way as with Ordinary Least Squares:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [50]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="k">print</span> <span class="s2">"Coefficients are: {0}"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">reg_lasso</span><span class="o">.</span><span class="n">coef_</span><span class="p">)</span>

<span class="k">print</span> <span class="s2">"Intercept is: {0}"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">reg_lasso</span><span class="o">.</span><span class="n">intercept_</span><span class="p">)</span>

<span class="k">print</span> <span class="s2">"Prediction for first house in test dataset: {0}"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">reg_lasso</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x_test_scale</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">]))</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Coefficients are: [-0.46674344  0.35035239 -0.18496276  0.53128633 -0.92939344  2.85917225
 -0.         -1.53182198  0.         -0.23618372 -2.00033223  0.57413375
 -3.63243914]
Intercept is: 22.4399626172
Prediction for first house in test dataset: [ 26.68269931]
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Note that we had to scale <strong>both</strong> the train and test data - to ensure comparing like with like.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 style="text-align: center">Cross-Validation</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Just as with ridge regression, there is a version of lasso regression with built-in CV (<a href="http://scikit-learn.org/stable/modules/generated/sklearn.linear_model.LassoCV.html#sklearn.linear_model.LassoCV"><code>sklearn.linear_model.LassoCV</code></a>). We specify a lasso regression to be run on specific <code>alpha</code>:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [51]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">reg_lasso_CV</span> <span class="o">=</span> <span class="n">linear_model</span><span class="o">.</span><span class="n">LassoCV</span><span class="p">(</span><span class="n">eps</span> <span class="o">=</span> <span class="bp">None</span><span class="p">,</span> 
                                    <span class="n">n_alphas</span> <span class="o">=</span> <span class="bp">None</span><span class="p">,</span> 
                                    <span class="n">alphas</span><span class="o">=</span><span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">],</span> 
                                    <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">reg_lasso_CV</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x_train_scale</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt output_prompt">Out[51]:</div>
<div class="output_text output_subarea output_execute_result">
<pre>LassoCV(alphas=[0.1, 1.0, 10.0], copy_X=True, cv=5, eps=None,
    fit_intercept=True, max_iter=1000, n_alphas=None, n_jobs=1,
    normalize=False, positive=False, precompute='auto', random_state=None,
    selection='cyclic', tol=0.0001, verbose=False)</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Note that the default cross-validation technique (<code>cv=</code>) is three-fold cross-validation.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Unlike with ridge regression, we can specify parameters that determine how the lasso regression iteratively fits along a regularisation path - specifically the length of the path <code>eps=</code> (default sets <code>alpha_min/alpha_max = 0.001</code>) and the number of alphas along the path <code>n_alphas=</code> (default 100):</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [56]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">reg_lasso_CV_2</span> <span class="o">=</span> <span class="n">linear_model</span><span class="o">.</span><span class="n">LassoCV</span><span class="p">(</span><span class="n">eps</span> <span class="o">=</span> <span class="mf">0.001</span><span class="p">,</span> 
                                      <span class="n">n_alphas</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> 
                                      <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">reg_lasso_CV_2</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x_train_scale</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt output_prompt">Out[56]:</div>
<div class="output_text output_subarea output_execute_result">
<pre>LassoCV(alphas=None, copy_X=True, cv=5, eps=0.001, fit_intercept=True,
    max_iter=1000, n_alphas=100, n_jobs=1, normalize=False, positive=False,
    precompute='auto', random_state=None, selection='cyclic', tol=0.0001,
    verbose=False)</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Finding values is similar to ridge regression:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [61]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="k">print</span> <span class="s2">"Alpha is: {0}"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">reg_lasso_CV_2</span><span class="o">.</span><span class="n">alpha_</span><span class="p">)</span>

<span class="k">print</span> <span class="s2">"Coefficients are: {0}"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">reg_lasso_CV_2</span><span class="o">.</span><span class="n">coef_</span><span class="p">)</span>

<span class="k">print</span> <span class="s2">"Intercept is: {0}"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">reg_lasso_CV_2</span><span class="o">.</span><span class="n">intercept_</span><span class="p">)</span>

<span class="n">prediction</span> <span class="o">=</span> <span class="n">reg_lasso_CV_2</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x_test_scale</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">])</span>

<span class="k">print</span> <span class="s2">"Prediction for first house in test dataset: {0}"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">prediction</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Alpha is: 0.026505040743
Coefficients are: [-0.91537606  0.93198988 -0.0811701   0.6022494  -1.6848705   2.67386441
 -0.14422073 -2.80985844  1.69906242 -1.58759164 -2.10671451  0.74501583
 -3.58685561]
Intercept is: 22.4132944689
Prediction for first house in test dataset: [ 25.24257472]
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Note that the lasso regression introduces a bias in the coefficient values. Hence, if our aim is a model that we can interpret, then we should rerun an Ordinary Least Squares regression including only those features with non-zero coefficients. The above approach also seeks to optimise the model for predictions <strong>not</strong> for interpretation. The best model for interpretation purposes tends to have <a href="http://scikit-learn.org/stable/modules/feature_selection.html#l1-based-feature-selection">fewer features</a> than that provided by <code>LassoCV</code></p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 style="text-align: center"><a name="coefficient"></a>D. Coefficient Path</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This shows how coefficient values fall to zero as we increase alpha. This can be used to indicate those most important features that are most robust to increasing the tuning parameter. Coefficient paths can also be drawn for the elastic net approach:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [55]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.cm</span> <span class="kn">as</span> <span class="nn">cm</span>

<span class="n">alphas_lasso</span><span class="p">,</span> <span class="n">coeffs_lasso</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">linear_model</span><span class="o">.</span><span class="n">lasso_path</span><span class="p">(</span><span class="n">x_train_scale</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> 
                                                        <span class="n">eps</span> <span class="o">=</span> <span class="mf">0.001</span><span class="p">,</span> <span class="n">n_alphas</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">"-Log(alpha)"</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">"coefficients"</span><span class="p">)</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_color_cycle</span><span class="p">([</span><span class="n">cm</span><span class="o">.</span><span class="n">Paired</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">140</span><span class="p">,</span> <span class="mi">20</span><span class="p">)]</span> <span class="o">+</span> 
                   <span class="p">[</span><span class="n">cm</span><span class="o">.</span><span class="n">Paired</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">140</span><span class="p">,</span> <span class="mi">280</span><span class="p">,</span> <span class="mi">20</span><span class="p">)])</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">alphas_lasso</span><span class="p">),</span> <span class="n">coeffs_lasso</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">labels</span> <span class="o">=</span> <span class="n">boston</span><span class="o">.</span><span class="n">feature_names</span><span class="p">,</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">1.02</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="o">.</span><span class="mi">102</span><span class="p">),</span> <span class="n">loc</span><span class="o">=</span><span class="s2">"best"</span><span class="p">,</span>
           <span class="n">ncol</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">"expand"</span><span class="p">,</span> <span class="n">borderaxespad</span><span class="o">=</span><span class="mf">0.</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_png output_subarea ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAYIAAAGXCAYAAAC+4VehAAAABHNCSVQICAgIfAhkiAAAAAlwSFlz
AAALEgAACxIB0t1+/AAAIABJREFUeJzs3Xl8FPX9+PHXzN45NuQgEO5TDgVEpRwKglSpigcW5RL4
ab2tR/Gi9hDqiVq/aiu1HrWJCqWeVFHQioCooKAgl4gVOQQSEkg2x97z+f0xmyWBACHZZJPs+/l4
zGNmPvOZ2c9C9vOe+czM56MppRBCCJG49HgXQAghRHxJIBBCiAQngUAIIRKcBAIhhEhwEgiEECLB
SSAQQogEZ413AWrD5XLt8/l8beJdDiGEaE6cTme+1+tte7x8WnN4j0DTNNUcyimEEE2JpmkopbTj
5ZOmISGESHASCIQQIsFJIBBCiAQngUAIIRKcBIIYmTdvHoMGDSI1NZX27dtz4YUX8umnnzJ79mzs
djtut5uMjAzOOussVq1aFd1v+fLldOzYMbo+cuRIdF1nw4YN1Y4/btw4dF1nxYoVjfadhEgEXbp0
ISkpibS0tOhv9O9//zuVD6hcddVV/PGPf4zmf/HFF+nTpw9paWnk5OQwduxYysvL41X8mJBAEANP
PPEEM2bM4Pe//z0FBQXs3LmTm2++mXfeeQeAiRMn4vF4KCwsZOTIkVx++eXV9tc0rdpyr169yMvL
i6YdOHCAVatWkZ2d3ThfSIgEomkaixYtoqSkhB07djBz5kzmzJnDNddcc0Te5cuX87vf/Y4FCxZQ
UlLCli1bmDBhQhxKHVsSCOrJ4/Fw3333MXfuXC655BJcLhcWi4ULLriARx55pFpeXdeZMmUKe/bs
oaio6KjHnDJlCgsWLIiekcyfP5/LLrsMu93eoN9FiERV+VtLTU1l7NixLFiwgNzcXDZv3lwt35o1
axg2bBj9+/cHoFWrVkydOpXk5ORGL3MsSSCop88//xy/38+ll1563LyBQIDc3FwyMzNJT08/ar52
7drRt29fPvjgAwDy8vKYNm0a8i6FEI1j0KBBtG/fnk8++aRa+uDBg1myZAmzZs3is88+IxAIxKmE
sdUs3iw+nvlf747JcSYN7HDC+xQVFZGVlYWuHz2mLliwgHfffRePx0N6ejpvvPHGMfMDTJs2jdzc
XLp06UJJSQmDBw8+4bIJ0VwYH/06JsfRR/81JscB84TswIED1dLOOuss3nzzTebOncvTTz9NKBTi
2muv5fHHH6/WxNvctIhAUJcKPFYyMzMpLCzEMIyjVu4TJkwgLy+PAwcO8Mtf/pI1a9YwYsSIYx53
3LhxzJgxg8zMTKZOndoQRReiyYhlBR4rP/30ExkZGUekjxkzhjFjxgDw8ccfM378eHr37s21117b
2EWMGWkaqqehQ4ficDh4++23j5s3IyODv//978yaNYv8/Pxj5nW5XJx//vk8++yzTJs2LVbFFULU
wpdffsmePXs466yzjplv1KhRnHPOOWzcuLGRStYwJBDUk9vtZvbs2dx8880sXLgQr9dLKBRi8eLF
3HPPPUfkP+mkk/jFL37BnDlzjnvshx9++IjHS4UQDae0tJR3332XSZMmMXXqVE4++eRq2//zn/+w
YMECiouLAfjiiy9Yvnw5Q4cOjUdxY6ZFNA3F24wZM8jJyeGBBx7gyiuvJDU1ldNPP53f/e53LFmy
5Ij8d955J6NHj+bee+89YlvVdsa2bdvStm3bGrcJIWLnoosuwmq1ous6ffv25c477+T6668/Il96
ejpPP/00t9xyC36/n5ycHO655x4mTpwYh1LHjvQ+KoQQLZT0PiqEEKJWJBAIIUSCk0AghBAJTgKB
EEIkOAkEQgiR4CQQCCFEgpNAIIQQCU4CgRBCJDgJBEIIkeAkENTTvHnzSE1Nxe12R6fU1FR0XeeB
Bx5g1KhRuFwufvrpp+g+H330EV27do1jqYUQlSqHqnS73bRr146rrrqKioqKanlmzZqFrut8+eWX
1dJzc3OxWq3R33737t25+uqr2bZtW2N+hXqTQFBPkydPprS0FI/HE52efPJJ2rZtG+2WNiUlhfvv
v7/aftJvkBBNQ+VQlR6Ph3Xr1vH111/z8MMPV8vz8ssvk5mZWW0I2UrDhg3D4/FQUlLCf//7X1wu
F6effvoRo5s1ZRIIYuzrr7/m9ttvZ8GCBbRp0waAW2+9lfnz57N9+/Y4l04IUZPKvsyys7MZM2YM
69ati25bsWIF+/bt4+mnn2b+/PmEQqEaj6FpGl27duWZZ57h7LPPZtasWY1R9JiQQBBDJSUlXH75
5dx3330MHz48mt6+fXuuvfZa/vjHP8axdEKI49m9ezfvv/8+PXv2jKbl5eVx0UUXcfnllwPwzjvv
HPc4l1122RHDXDZlLaIb6tMf/DAmx1n7u3Prtf/UqVPp378/d9555xHbZs6cSc+ePdmyZUu9PkOI
FumhlNgc596yOu1WOeZ4WVkZo0ePjp7Ne71eXnvtNV555RWsVivjx48nLy+PcePGHfN4NQ1z2ZS1
iEBQ3wo8Fh555BG2bNnC2rVra9yelZXFr3/9a/7whz9w4403NnLphGji6liBx8rChQsZNWoUn3zy
CZMnT6awsBC3282bb76JzWbj/PPPB8x7gueeey5FRUVkZmYe9XhHG+ayqZKmoRhYtmwZDz/8MG+8
8QZut/uo+e68804+/vjjowYLIUR8VN4jGD58ONOnT+eOO+4AzKeCysrK6NSpEzk5OVxxxRWEQiHm
zZt3zOO99dZb1ZqHm7oWcUUQT3v37mXSpEk8+eST9O/f/5h509LSuPPOO3n00UePGTCEEPFz++23
07VrV1asWMHSpUtZsmQJ/fr1i27/v//7P3Jzc7nllluAQ0HEMAx27tzJn//8Z5YvX86qVaviUv66
kCuCenrhhRcoKCjgtttuq/Yegdvt5qabbjriMdFbb70Vq9Uqj48K0UQc/lvMyspi2rRpjB49mtNO
O43Ro0eTnZ0dnW699VY2bNgQfTx01apVuN1u0tLSGDVqFGVlZXz55Zf07ds3Hl+nTmSoSiGEaKFk
qEohhBC1IoFACCESnAQCIYRIcBIIhBAiwUkgEEKIBCeBQAghEpwEAiGESHASCIQQIsFJIBBCiAQn
gaCeunbtytKlS8nNzUXXdR5//PFq2zt27MiKFSsAmD17Nna7nbS0NNLS0ujduze33HIL+/bti+bP
zc2tsbOqys8Bs2fD8ePH07p1a9LT0+nfv3+NIycJIY6t6jCzFouFpKSkaNr8+fOj+f75z3+i6zqv
vfZatf3fffddcnJyKC4ujqYtXLiQDh06UFpa2mjfo74kEMRQRkYGjz76KOXl5UfNM3HiREpKSjhw
4ABvvfUW+/bt4/TTTyc/Pz+a53j9EE2dOpXOnTuza9cuioqKePnll6OjoQkhaq/qMLOdO3dm0aJF
0bRJkyZF8+Xl5dU4VOXYsWMZPXo0t99+OwDFxcXcdNNN/P3vfyc1NbVRv0t9SCCIoT59+jB06FD+
/Oc/HzevxWKhT58+LFiwgNatW9dqn0pffvkl06dPx+l0ous6AwYMYMyYMfUpuhAJTylFTX2a7dix
gxUrVvDcc8+xePFiCgoKqm1/6qmnWLx4MR988AG/+c1vGDVqFBdeeGFjFTsmJBDEkKZp3H///Tz5
5JPVLhWPRdd1LrnkkhMa1m7o0KHcdNNNLFiwgF27dtW1uEKIWsjLy+OMM85g3Lhx9OnTh1dffbXa
9szMTJ566immTJnCe++9x1NPPRWnktZdixiP4LGVf4vJce46q/4jh/Xv359zzz2XOXPm8PDDD9dq
nxMd1u61115jzpw5PPDAA3z77bf069eP5557jjPOOKOuxRYirrbMf/X4mWqhz6QpMTlOVS+//HJ0
7IHJkyeTl5fHb37zm2p5Bg8eTElJCRMmTDjmyGVNVYsIBLGowGPpT3/6E4MHDz7ij+Voqg5rZ7Va
CQaDR+QJBoPYbDbAHODmoYce4qGHHuLAgQPccccdjBs3Tq4ORLPVEBV4LHz66ads376dCRMmADBp
0iR+97vf8c0331QbiOq6665j+vTpvPnmm6xevZrBgwfHq8h1Ik1DDaBXr15cdtllPPjgg8e98auU
4p133mHEiBEAdOrUiZ07d1bLU1FRQUFBAZ07dz5i/4yMDO6880727NnDwYMHY/clhBDk5uYCcOqp
p5KTk8OQIUPQNC2aDvDiiy+ye/du5s6dy4MPPsivfvUrQqFQvIpcJxIIGsgf//hHXnrppSPuFVTe
jAqHw2zZsoWJEyeSn58fvXoYPHgwTqeTOXPm4Pf7KS8vZ+bMmQwaNIhOnToBMHPmTDZt2kQ4HKa0
tJS5c+fSo0cP0tPTG/dLCtGC+f1+XnvtNZ5//nnWrVvH+vXrWb9+PU8//TSvvvoqhmGwZ88e7r77
bl544QVsNhs33HADWVlZPPDAA/Eu/gmRQFBPRzvj79KlC1OnTj3iUdJ///vfuN1uWrVqxaWXXkrr
1q1Zu3Ytbdu2BcBut7No0SI+/vhjOnToQI8ePdi3bx///ve/o8eoqKhg3LhxpKen06NHD3bt2sV/
/vOfhvuSQiSAw3/Lb7/9NklJSUydOrXaUJVXX3014XCYxYsXc/PNNzN58mSGDRsW3e+5557jqaee
YsuWLY39FepMhqoUQogWSoaqFEIIUSsSCIQQIsFJIBBCiAQngUAIIRKcBAIhhEhwEgiEECLBSSAQ
QogEJ4FACCESnAQCIYRIcBIIYmTevHkMGjSI1NRU2rdvz4UXXsinn37K7NmzmTp16hH5dV3nhx9+
qJZ2tOHwAB566CG6deuG2+2mU6dO1UZPEkLUXZcuXUhKSsLtdpOTk8NVV11Fjx49okNYWq1WXC5X
dAjLRx55hNzcXKxWa7S7mIEDB7Jo0aIjjl1eXk5KSsoRA9Ucb4jMmuqNxx57jJNOOonk5GS6dOnC
vffeSyAQiMm/gQSCGHjiiSeYMWMGv//97ykoKGDnzp3cfPPNvPPOO0DN/RHVlHa04fByc3N59dVX
Wbp0KR6PhzVr1jB69OiG+TJCJBhN01i0aBEej4evvvqKNWvWcMUVV0SHsBw+fDhz586NDmE5c+ZM
AIYNG4bH46G4uJgbb7yRiRMn4vF4qh37jTfewOl08uGHH1Yb2aw2Q2RWrSNuueUWXnjhBV555RVK
S0t5//33+eijj7jiiiti8m8ggaCePB4P9913H3PnzuWSSy7B5XJhsVi44IILeOSRR4663+F9Jx1r
OLw1a9YwZswYunTpAkB2djbXXHNNg3wfIRJR5e8xJyeH888/n40bN9a4/WgqO5jctm1btfTc3Fxu
vPFG+vfvzyuvvHLUzz7W8bdt28bf/vY35s2bx89+9jN0XadPnz688cYbLF68mGXLltXiGx6bBIJ6
+vzzz/H7/Vx66aX1Os6xhsMbMmQIeXl5PP7446xduxbDMOpbbCFEDXbt2sV7773HaaedVut9wuEw
//jHP7Db7dXGDNmxYwfLli1jypQpTJ48udoYBidi6dKldOzYkdNPP71aeocOHRgyZAgffvhhnY5b
VYsYoeyGD8fH5DjPnvv6Ce9TVFREVlYWun70mLpgwQLefffd6LpS6oimoWMNhzdlyhR0Xeell15i
9uzZOJ1O7rrrLu6+++4TLq8QTdH/3bQwJsf5zdxL6rTfpZdeitVqJS0tjbFjx/Lb3/72uPt8/vnn
ZGRkUFZWhs1m45VXXiErKyu6/eWXX2bAgAH07t0bt9vNPffcw/r16xkwYMAJla2wsJCcnJwat+Xk
5FBYWHhCx6tJiwgEdanAYyUzM5PCwkIMwzhqMJgwYcIR7f5V89ZmOLxJkyYxadIkwuEwb7/9NpMn
T2bgwIGce+65DfTNhGg8da3AY2XhwoWMGjXqhPYZOnQoK1asoKKigl/96lesWLGC8eMPnZS+/PLL
XHfddYA5LvmIESPIzc3liSeeOKHPycrKYu/evTVu27t3L926dTuh49VEmobqaejQoTgcDt5+++06
H6M2w+FVslgs/PKXv6R///5HtGMKIeqmPuOdJCUlMXfuXF5++WXWr18PmFcL27Zt4+GHHyYnJ4ec
nBy++OIL5s2bd8JNu+eccw67du1izZo11dJ37drFqlWr+PnPf17nsleSQFBPbreb2bNnc/PNN7Nw
4UK8Xi+hUIjFixdzzz33HHf/Yw2HV/lHk5uby3vvvUdZWRlKKd5//302b97c7AbIFqKlSk9P55pr
rmH27NmA+Sj4eeedx5YtW6K/6Q0bNuD1enn//fdP6Ng9e/bk+uuvZ8qUKaxevRrDMNi0aRPjx4/n
vPPOO+ErmZpIIIiBGTNm8MQTT/DAAw+QnZ1Np06deOaZZxg3btxR96m8R3Cs4fAqA4rb7eahhx6i
c+fOpKenM3PmTJ599tlqw+MJIermaMPN1nZ7pdtvv53333+fjRs38vrrr3PrrbfSunXr6G+6cvja
w6/0a3P8Z555hmuuuYYrr7yS1NRULrjgAs455xxefz02zeIyVKUQQrRQMlSlEEKIWpFAIIQQCU4C
gRBCJDgJBEIIkeAkEAghRIKTQCCEEAlOAoEQQiQ4CQRCCJHgJBAIIUSCk0BQT126dKFNmzZ4vd5o
2osvvlit/4/jDTE3fvz4aC+FlcaNG8ett97a8F9AiARXdajKzMxMLrroIn766ad4F6tRSSCoJ03T
MAyDJ5988oh0qN0Qc8888wxvvfUWy5cvB8zxC9atW8ecOXMa74sIkaCqDlW5d+9esrOzo2ODJAoJ
BDFw11138ec///mI8Uq///77Wg0x16ZNGx5//HGuvfZadu3axW233cZzzz2Hy+WKw7cRIvFU9mVm
t9sZP348mzdvjnOJGpcEghg444wzGDlyJI899li19I8++qjWQ8xNnz6dbt26cdppp3HBBRfIgDNC
xEFFRQULFixg6NCh8S5Ko2oRI5Q98Y9pMTnOjKvzjp/pKGbPns1ZZ53F7bffHk070SHmhg8fzocf
fsiUKVPqXA4hmqN3X3w+JscZ+6tr67Rf5VCVZWVlZGdns2TJkpiUp7loEYGgPhV4rJx88smMHTuW
hx9+mD59+gAnNsTctm3bePzxx7npppuYMWMGX331FRaLpVHKLkS81bUCj5XKoSqVUrz99tuMGDGC
LVu2kJ2dHddyNRZpGoqhWbNm8fzzz0efODjnnHPYuXNnrYaYu/baa5kxYwZ/+ctfSElJ4ZFHHmnU
sguRyCrvEWiaxrhx47BYLKxcuTLOpWo8EghiqHv37kyYMIGnn34aMIeYu+GGG447xNzcuXMpKiri
t7/9LQAvvPACjz32GN99913cvosQiWrhwoUUFxdHr+wTglKqyU9mMZumrl27qo8++ii6vmvXLuVy
udQ555yjlFLKMAz16KOPqh49eqikpCTVqVMnNXPmTOX3+5VSSu3cuVOlp6erL774otpx//SnP6kR
I0Y03hcRIkF16dJFJSUlqdTUVOV2u1W/fv3U/Pnz412smIjUncetY2WoSiGEaKFkqEohhBC1IoFA
CCESnAQCIYRIcBIIhBAiwUkgEEKIBCeBQAghEpwEAiGESHASCIQQIsFJIBBCiAQngaCeqg5z165d
O6666ioqKioA+H//7/+h6zrvvPNOtX1+85vfoOs6eXnx7zVViETXtWtXli5dekT6Qw89RLdu3XC7
3XTq1IlJkyYBcMopp+B2u3G73VitVlwuF6mpqbjd7mqdRS5btgxd16uNU7Jy5cpo3pSUFHRdx+12
R9N2797d8F+4BhII6qnqMHfr1q3j66+/5uGHH45u69WrV7UKPxwO89prr9GjR494FVkIcRy5ubm8
+uqrLF26FI/Hw5o1axg9ejQAGzduxOPx4PF4GD58OHPnzqW0tBSPx8PMmTOjx8jLyyMzM7Pa7/+s
s86K5t20aROaplFSUhJN69ChQ6N/V5BAEBOV/SBlZ2czZswY1q1bF902duxYVq5cSUlJCQCLFy9m
wIABtG3bNi5lFUIc35o1axgzZgxdunQBzN/2NddcU2PemvpBq6io4PXXX+eZZ55h27ZtfPXVV0f9
rKbQj5oEghjavXs377//Pj179oymuVwuLrnkEv71r38B5lnCtGnTmsR/vhCiZkOGDCEvL4/HH3+c
tWvXYhjGCe3/xhtvkJqayuWXX855551Hbm5uA5U0NlrECGVld9wRk+Ok/PnPddrv0ksvNctRVsbo
0aOZNWtWte1Tp07lrrvuYuLEiaxYsYK8vDz++te/1re4QrQYuz+dEZPjdDjziZgcZ8qUKei6zksv
vcTs2bNxOp3cdddd3H333bXaPy8vj4kTJ6JpGpMnT+a2227jiSeeaLKjDraIQFDXCjxWKoe5++ST
T5g8eTKFhYW43e7o9jPPPJP9+/fz4IMPMnbsWBwORxxLK0TTE6sKPJYmTZrEpEmTCIfDvP3220ye
PJmBAwdy7rnnHnO/3bt38/HHH0dvHF988cVcd911LFq0iIsvvrgxin7CpGkoBiqbeYYPH8706dO5
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
CMwe0gAAAABJRU5ErkJggg==
">
</img></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The above coefficient path suggests that 'RM' and 'LSTAT' are the most important features. To get different colors for the different features, we have used the module <code>matplotlib.cm</code>. It is important to choose a colour map where the colours vary noticeably. The colour maps available can be seen <a href="http://matplotlib.org/examples/color/colormaps_reference.html">here</a>. Note that combining color maps (as in the above code) can enhance colour variation.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Above based on code provided by <a href="http://scikit-learn.org/stable/auto_examples/linear_model/plot_lasso_coordinate_descent_path.html">Scikit-learn</a>. For more information on how to set the legend see <a href="http://matplotlib.org/users/legend_guide.html">matplotlib documentation</a>.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 style="text-align: center"><a name="matrix"></a>4. Correlation Matrix</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Lasso and ridge regressions are unreliable when there is a high correlation between different features. We can check for this correlation through use of a correlation matrix. The below examines the strength of the <strong>linear</strong> relationships using Pearson Product-Moment Correlation Coefficients using <a href="http://docs.scipy.org/doc/numpy/reference/generated/numpy.corrcoef.html">NumPy</a>:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [28]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">correlation_matrix</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">corrcoef</span><span class="p">(</span><span class="n">x_train</span><span class="p">,</span> <span class="n">rowvar</span> <span class="o">=</span> <span class="mi">0</span><span class="p">))</span>

<span class="c1">#rowvar = 0 to as rows relate to different records, columns to variables</span>

<span class="c1">#To label the different features:</span>

<span class="n">correlation_matrix</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">boston</span><span class="o">.</span><span class="n">feature_names</span>
<span class="n">correlation_matrix</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">boston</span><span class="o">.</span><span class="n">feature_names</span>

<span class="n">correlation_matrix</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt output_prompt">Out[28]:</div>
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>CRIM</th>
<th>ZN</th>
<th>INDUS</th>
<th>CHAS</th>
<th>NOX</th>
<th>RM</th>
<th>AGE</th>
<th>DIS</th>
<th>RAD</th>
<th>TAX</th>
<th>PTRATIO</th>
<th>B</th>
<th>LSTAT</th>
</tr>
</thead>
<tbody>
<tr>
<th>CRIM</th>
<td>1.000000</td>
<td>-0.199932</td>
<td>0.388912</td>
<td>-0.051498</td>
<td>0.424337</td>
<td>-0.185924</td>
<td>0.338865</td>
<td>-0.365796</td>
<td>0.613971</td>
<td>0.567040</td>
<td>0.270841</td>
<td>-0.300679</td>
<td>0.454672</td>
</tr>
<tr>
<th>ZN</th>
<td>-0.199932</td>
<td>1.000000</td>
<td>-0.528755</td>
<td>-0.052096</td>
<td>-0.524911</td>
<td>0.327201</td>
<td>-0.584627</td>
<td>0.660710</td>
<td>-0.313989</td>
<td>-0.327254</td>
<td>-0.383914</td>
<td>0.168671</td>
<td>-0.428367</td>
</tr>
<tr>
<th>INDUS</th>
<td>0.388912</td>
<td>-0.528755</td>
<td>1.000000</td>
<td>0.046481</td>
<td>0.755708</td>
<td>-0.395119</td>
<td>0.635201</td>
<td>-0.696408</td>
<td>0.578671</td>
<td>0.729234</td>
<td>0.377993</td>
<td>-0.339950</td>
<td>0.616902</td>
</tr>
<tr>
<th>CHAS</th>
<td>-0.051498</td>
<td>-0.052096</td>
<td>0.046481</td>
<td>1.000000</td>
<td>0.059083</td>
<td>0.081925</td>
<td>0.068587</td>
<td>-0.087921</td>
<td>0.007005</td>
<td>-0.027192</td>
<td>-0.092955</td>
<td>0.075155</td>
<td>-0.045924</td>
</tr>
<tr>
<th>NOX</th>
<td>0.424337</td>
<td>-0.524911</td>
<td>0.755708</td>
<td>0.059083</td>
<td>1.000000</td>
<td>-0.287367</td>
<td>0.743524</td>
<td>-0.773083</td>
<td>0.628727</td>
<td>0.686920</td>
<td>0.175481</td>
<td>-0.376619</td>
<td>0.599609</td>
</tr>
<tr>
<th>RM</th>
<td>-0.185924</td>
<td>0.327201</td>
<td>-0.395119</td>
<td>0.081925</td>
<td>-0.287367</td>
<td>1.000000</td>
<td>-0.248617</td>
<td>0.193052</td>
<td>-0.174508</td>
<td>-0.272416</td>
<td>-0.370481</td>
<td>0.131769</td>
<td>-0.612997</td>
</tr>
<tr>
<th>AGE</th>
<td>0.338865</td>
<td>-0.584627</td>
<td>0.635201</td>
<td>0.068587</td>
<td>0.743524</td>
<td>-0.248617</td>
<td>1.000000</td>
<td>-0.760456</td>
<td>0.444960</td>
<td>0.508152</td>
<td>0.237848</td>
<td>-0.255566</td>
<td>0.615801</td>
</tr>
<tr>
<th>DIS</th>
<td>-0.365796</td>
<td>0.660710</td>
<td>-0.696408</td>
<td>-0.087921</td>
<td>-0.773083</td>
<td>0.193052</td>
<td>-0.760456</td>
<td>1.000000</td>
<td>-0.474487</td>
<td>-0.532434</td>
<td>-0.174499</td>
<td>0.262156</td>
<td>-0.516540</td>
</tr>
<tr>
<th>RAD</th>
<td>0.613971</td>
<td>-0.313989</td>
<td>0.578671</td>
<td>0.007005</td>
<td>0.628727</td>
<td>-0.174508</td>
<td>0.444960</td>
<td>-0.474487</td>
<td>1.000000</td>
<td>0.902384</td>
<td>0.443599</td>
<td>-0.436661</td>
<td>0.468507</td>
</tr>
<tr>
<th>TAX</th>
<td>0.567040</td>
<td>-0.327254</td>
<td>0.729234</td>
<td>-0.027192</td>
<td>0.686920</td>
<td>-0.272416</td>
<td>0.508152</td>
<td>-0.532434</td>
<td>0.902384</td>
<td>1.000000</td>
<td>0.449566</td>
<td>-0.427663</td>
<td>0.540966</td>
</tr>
<tr>
<th>PTRATIO</th>
<td>0.270841</td>
<td>-0.383914</td>
<td>0.377993</td>
<td>-0.092955</td>
<td>0.175481</td>
<td>-0.370481</td>
<td>0.237848</td>
<td>-0.174499</td>
<td>0.443599</td>
<td>0.449566</td>
<td>1.000000</td>
<td>-0.157012</td>
<td>0.383061</td>
</tr>
<tr>
<th>B</th>
<td>-0.300679</td>
<td>0.168671</td>
<td>-0.339950</td>
<td>0.075155</td>
<td>-0.376619</td>
<td>0.131769</td>
<td>-0.255566</td>
<td>0.262156</td>
<td>-0.436661</td>
<td>-0.427663</td>
<td>-0.157012</td>
<td>1.000000</td>
<td>-0.388120</td>
</tr>
<tr>
<th>LSTAT</th>
<td>0.454672</td>
<td>-0.428367</td>
<td>0.616902</td>
<td>-0.045924</td>
<td>0.599609</td>
<td>-0.612997</td>
<td>0.615801</td>
<td>-0.516540</td>
<td>0.468507</td>
<td>0.540966</td>
<td>0.383061</td>
<td>-0.388120</td>
<td>1.000000</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can observe a high correlation between some of the features - such as RAD and TAX (0.90). This weakens the reliability of the lasso and ridge regression approaches, and provides support for using an elastic net approach instead:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 style="text-align: center"><a name="elastic"></a>4. Elastic Net</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The <strong>Elastic Net</strong> acts as a hybrid between the lasso and the ridge approaches (Hastie et al, 2013), and so includes both an L<sub>1</sub> penaly (as in lasso regression) and L<sub>2</sub> penalty (as in ridge regression).</p>
<p>To implement this in Scikit-learn, we use <code>sklearn.linear_model.ElasticNet</code>, specifying:</p>
<ul>
<li><p><code>alpha</code>: if <code>alpha = 0</code>, elastic net becomes an Ordinary Least Squares regression. Otherwise, the higher <code>alpha</code>, the more high coefficient values will be penalised.</p>
</li>
<li><p><code>l1_ratio</code>: controls how the L<sub>1</sub> and L<sub>2</sub> penalties are combined. At its lowest possible value, <code>l1_ratio = 0</code> and the penalty is an L<sub>2</sub> penalty - i.e. ridge regression is performed. At its highest possible value, <code>l1_ratio = 1</code>, and the penalty is an L<sub>1</sub> penalty - i.e. lasso regression is performed.</p>
</li>
</ul>
<p>See the <a href="http://scikit-learn.org/stable/modules/generated/sklearn.linear_model.ElasticNet.html">documentation</a> for the precise objective function minimised.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [58]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">reg_elastic_net</span> <span class="o">=</span> <span class="n">linear_model</span><span class="o">.</span><span class="n">ElasticNet</span><span class="p">(</span><span class="n">alpha</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">l1_ratio</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">)</span>
<span class="n">reg_elastic_net</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x_train_scale</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt output_prompt">Out[58]:</div>
<div class="output_text output_subarea output_execute_result">
<pre>ElasticNet(alpha=1.0, copy_X=True, fit_intercept=True, l1_ratio=0.5,
      max_iter=1000, normalize=False, positive=False, precompute=False,
      random_state=None, selection='cyclic', tol=0.0001, warm_start=False)</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Coefficients, the intercept and predictions can all be found in the same way as with Ordinary Least Squares:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [62]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="k">print</span> <span class="s2">"Coefficients are: {0}"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">reg_elastic_net</span><span class="o">.</span><span class="n">coef_</span><span class="p">)</span>

<span class="k">print</span> <span class="s2">"Intercept is: {0}"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">reg_elastic_net</span><span class="o">.</span><span class="n">intercept_</span><span class="p">)</span>

<span class="n">prediction</span> <span class="o">=</span> <span class="n">reg_elastic_net</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x_test_scale</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">])</span>

<span class="k">print</span> <span class="s2">"Prediction for first house in test dataset: {0}"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">prediction</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Coefficients are: [-0.40039363  0.13791891 -0.39430864  0.31253356 -0.23519326  2.27681384
 -0.         -0.         -0.         -0.48459952 -1.49933556  0.46145089
 -2.29187489]
Intercept is: 22.4731392613
Prediction for first house in test dataset: [ 26.10506411]
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 style="text-align: center">Cross-Validation</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Just as with ridge and lasso regression, there is a version of the elastic net with built-in CV (<a href="http://scikit-learn.org/stable/modules/generated/sklearn.linear_model.ElasticNetCV.html#sklearn.linear_model.ElasticNetCV"><code>sklearn.linear_model.ElasticNetCV</code></a>).</p>
<p>We can specify a NumPy array of <code>l1_ratio</code> (and allow <code>alphas</code> to be automatically set), or we can specify a NumPy array of <code>alphas</code> (and allow <code>l1_ratio</code> to be set at its default value of 0.5), or we can specify both:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [63]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">reg_elastic_net_CV</span> <span class="o">=</span> <span class="n">linear_model</span><span class="o">.</span><span class="n">ElasticNetCV</span><span class="p">(</span><span class="n">eps</span> <span class="o">=</span> <span class="bp">None</span><span class="p">,</span> <span class="n">n_alphas</span> <span class="o">=</span> <span class="bp">None</span><span class="p">,</span> 
                                               <span class="n">alphas</span><span class="o">=</span><span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">],</span> 
                                               <span class="n">l1_ratio</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">,</span> <span class="mf">0.99</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span>
                                               <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">reg_elastic_net_CV</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x_train_scale</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt output_prompt">Out[63]:</div>
<div class="output_text output_subarea output_execute_result">
<pre>ElasticNetCV(alphas=[0.1, 1.0, 10.0], copy_X=True, cv=5, eps=None,
       fit_intercept=True, l1_ratio=[0.1, 0.5, 0.7, 0.9, 0.95, 0.99, 1.0],
       max_iter=1000, n_alphas=None, n_jobs=1, normalize=False,
       positive=False, precompute='auto', random_state=None,
       selection='cyclic', tol=0.0001, verbose=0)</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The <a href="http://scikit-learn.org/stable/modules/generated/sklearn.linear_model.ElasticNetCV.html#sklearn.linear_model.ElasticNetCV">documentation</a> recommends choosing an array of <code>l1_ratio</code> that puts more values close to 1 than 0. If <code>cv=</code> is not specified, the default cross-validation technique is three-fold cross-validation.</p>
<p>Just as with the lasso regression, we can instead specify how the elastic net iteratively fits along a regularisation path. This path determines the alpha values tested for each <code>l1_ratio</code>. As with lasso regression, the length of the path is determined by <code>eps=</code> (default sets <code>alpha_min/alpha_max = 0.001</code>) and the number of alphas along the path <code>n_alphas=</code>.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Finding values is a similar process to lasso and ridge regression, only we now have both <code>alpha</code> and <code>l1_ratio</code> parameters. We can also find the grid of alphas used for fitting using <code>alphas_</code>:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [65]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="k">print</span> <span class="s2">"Alpha is: {0}"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">reg_elastic_net_CV</span><span class="o">.</span><span class="n">alpha_</span><span class="p">)</span>

<span class="k">print</span> <span class="s2">"Grid of alphas used is: {0}"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">reg_elastic_net_CV</span><span class="o">.</span><span class="n">alphas_</span><span class="p">)</span>

<span class="k">print</span> <span class="s2">"L1 ratio is: {0}"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">reg_elastic_net_CV</span><span class="o">.</span><span class="n">l1_ratio_</span><span class="p">)</span>

<span class="k">print</span> <span class="s2">"Coefficients are: {0}"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">reg_elastic_net_CV</span><span class="o">.</span><span class="n">coef_</span><span class="p">)</span>

<span class="k">print</span> <span class="s2">"Intercept is: {0}"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">reg_elastic_net_CV</span><span class="o">.</span><span class="n">intercept_</span><span class="p">)</span>

<span class="n">prediction</span> <span class="o">=</span> <span class="n">reg_elastic_net_CV</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x_test_scale</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">])</span>

<span class="k">print</span> <span class="s2">"Prediction for first house in test dataset: {0}"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">prediction</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Alpha is: 0.1
Grid of alphas used is: [ 10.    1.    0.1]
L1 ratio is: 0.1
Coefficients are: [-0.79998478  0.67859154 -0.40773142  0.65473081 -1.0791141   2.77291011
 -0.26201786 -2.08447899  0.78923916 -0.86499312 -1.95562088  0.75664765
 -3.1627039 ]
Intercept is: 22.4239690443
Prediction for first house in test dataset: [ 26.15907005]
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Just as with lasso regression, we can create a coefficient path by simply replacing <code>lasso_path</code> with <code>enet_path</code>. Unlike with <code>lasso_path</code>, we need to specify a value for <code>l1_ratio</code>. A full comparison can be found in the <a href="http://scikit-learn.org/stable/auto_examples/linear_model/plot_lasso_coordinate_descent_path.html#example-linear-model-plot-lasso-coordinate-descent-path-py">documentation</a>.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 style="text-align: center">Further Reading</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The above was written using:</p>
<ul>
<li><a href="http://scikit-learn.org/stable/modules/linear_model.html">Scikit-learn guidance on Generalized Linear Models</a></li>
<li>Cassella, G., Fienberg, S. and Olkin, I., 2015. "An Introduction to Statistical Learning: with Applications in R". New York: Springer. Available online as a <a href="http://www-bcf.usc.edu/~gareth/ISL/index.html">pdf</a></li>
<li>Hastie, T., Tibshirani, R., Friedman, J., 2013. "The Elements of Statistical Learning: Data Mining, Inference, and Prediction". New York: Springer. Available online as a <a href="http://statweb.stanford.edu/~tibs/ElemStatLearn/">pdf</a></li>
</ul>
</div>
</div>
</div>
<script type="text/javascript">if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = '//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML';
    mathjaxscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: 'center'," +
        "    displayIndent: '0em'," +
        "    showMathMenu: true," +
        "    tex2jax: { " +
        "        inlineMath: [ ['$','$'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }" +
        "    } " +
        "}); ";
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
</script>

    </div>
  </div>
  <hr class="separator">
  <div class="col-md-8 col-md-offset-2">
  </div>
  </div>
<footer class="footer">
  <div class="container">
    <p class="text-center">
      Andrew Burnie, <a href="" target="_blank"></a> unless otherwise noted.
    </p>
    <div class="text-center">
      Generated by <a href="http://getpelican.com" target="_blank">Pelican</a> with the <a href="http://github.com/nairobilug/pelican-alchemy">alchemy</a> theme.
    </div>
  </div>
</footer> <!-- /.footer -->
  <script src="/theme/js/jquery.min.js"></script>
  <script src="/theme/js/bootstrap.min.js"></script>
</body> <!-- 42 -->

</html>