<!DOCTYPE html>
<html lang="en">

<head>
      <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="canonical" href="http://Andrew47.github.io/scikitlearn-linear-reg.html" />

    <title>  Andrew Burnie: Data Science Blog &mdash; Scikit-Learn Linear Regression
</title>




    <link rel="stylesheet" href="/theme/css/style.css">

    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->


    <meta name="author" content="Andrew Burnie">
    <meta name="description" content="The below is a guide to implementing linear regression machine learning tools using scikit-learn, a Python package specifically designed for the implementation of machine learning. First, how to implement Ordinary Least Squares is examined, then how the problem of overfitting can be reduced using ridge regression, lasso regression and elastic net.">
  <meta name="tags" contents="python, scikit-learn, regression, linear regression, lasso, ridge, elastic net, ">
</head>

<body>
<header class="header">
  <div class="container">
    <div class="header-inner">
      <h1 class="header-name">
        <a class="nodec" href="http://Andrew47.github.io">Andrew Burnie: Data Science Blog</a>
      </h1>
      <h3 class="header-text"></h3>
      <ul class="header-menu list-inline">
              <li class="muted">|</li>
            <li><a class="nodec" href="http://Andrew47.github.io/pages/author.html">Author</a></li>
              <li class="muted">|</li>
          <li><a class="nodec" href="http://Andrew47.github.io/categories.html">Categories</a></li>
          <li class="muted">|</li>
          <li><a class="nodec" href="http://Andrew47.github.io/tags.html">Tags</a></li>
          <li class="muted">|</li>
          <li><a class="nodec icon-mail-alt" href="mailto:apburnie@hotmail.co.uk"></a></li>
          <li><a class="nodec icon-github" href="https://github.com/Andrew47"></a></li>
      </ul>
    </div>
  </div>
</header> <!-- /.header -->  <div class="container">
  <div class="post full-post">
    <h1 class="post-title">
      <a href="/scikitlearn-linear-reg.html" title="Permalink to Scikit-Learn Linear Regression">Scikit-Learn Linear Regression</a>
    </h1>
    <ul class="list-inline">
      <li class="post-date">
        <a class="text-muted" href="/scikitlearn-linear-reg.html" title="2016-08-20T15:30:00+01:00">Sat 20 August 2016</a>
      </li>
      <li class="muted">&middot;</li>
      <li class="post-category">
        <a href="/category/scikit-learn.html">scikit-learn</a>
      </li>
        <li class="muted">&middot;</li>
        <li>
            <a href="/tag/python.html">python</a>,             <a href="/tag/scikit-learn.html">scikit-learn</a>,             <a href="/tag/regression.html">regression</a>,             <a href="/tag/linear-regression.html">linear regression</a>,             <a href="/tag/lasso.html">lasso</a>,             <a href="/tag/ridge.html">ridge</a>,             <a href="/tag/elastic-net.html">elastic net</a>        </li>
    </ul>
    <div class="post-content">
      <style type="text/css">/*!
*
* IPython notebook
*
*/
/* CSS font colors for translated ANSI colors. */
.ansibold {
  font-weight: bold;
}
/* use dark versions for foreground, to improve visibility */
.ansiblack {
  color: black;
}
.ansired {
  color: darkred;
}
.ansigreen {
  color: darkgreen;
}
.ansiyellow {
  color: #c4a000;
}
.ansiblue {
  color: darkblue;
}
.ansipurple {
  color: darkviolet;
}
.ansicyan {
  color: steelblue;
}
.ansigray {
  color: gray;
}
/* and light for background, for the same reason */
.ansibgblack {
  background-color: black;
}
.ansibgred {
  background-color: red;
}
.ansibggreen {
  background-color: green;
}
.ansibgyellow {
  background-color: yellow;
}
.ansibgblue {
  background-color: blue;
}
.ansibgpurple {
  background-color: magenta;
}
.ansibgcyan {
  background-color: cyan;
}
.ansibggray {
  background-color: gray;
}
div.cell {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  border-radius: 2px;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
  border-width: 1px;
  border-style: solid;
  border-color: transparent;
  width: 100%;
  padding: 5px;
  /* This acts as a spacer between cells, that is outside the border */
  margin: 0px;
  outline: none;
  border-left-width: 1px;
  padding-left: 5px;
  background: linear-gradient(to right, transparent -40px, transparent 1px, transparent 1px, transparent 100%);
}
div.cell.jupyter-soft-selected {
  border-left-color: #90CAF9;
  border-left-color: #E3F2FD;
  border-left-width: 1px;
  padding-left: 5px;
  border-right-color: #E3F2FD;
  border-right-width: 1px;
  background: #E3F2FD;
}
@media print {
  div.cell.jupyter-soft-selected {
    border-color: transparent;
  }
}
div.cell.selected {
  border-color: #ababab;
  border-left-width: 0px;
  padding-left: 6px;
  background: linear-gradient(to right, #42A5F5 -40px, #42A5F5 5px, transparent 5px, transparent 100%);
}
@media print {
  div.cell.selected {
    border-color: transparent;
  }
}
div.cell.selected.jupyter-soft-selected {
  border-left-width: 0;
  padding-left: 6px;
  background: linear-gradient(to right, #42A5F5 -40px, #42A5F5 7px, #E3F2FD 7px, #E3F2FD 100%);
}
.edit_mode div.cell.selected {
  border-color: #66BB6A;
  border-left-width: 0px;
  padding-left: 6px;
  background: linear-gradient(to right, #66BB6A -40px, #66BB6A 5px, transparent 5px, transparent 100%);
}
@media print {
  .edit_mode div.cell.selected {
    border-color: transparent;
  }
}
.prompt {
  /* This needs to be wide enough for 3 digit prompt numbers: In[100]: */
  min-width: 14ex;
  /* This padding is tuned to match the padding on the CodeMirror editor. */
  padding: 0.4em;
  margin: 0px;
  font-family: monospace;
  text-align: right;
  /* This has to match that of the the CodeMirror class line-height below */
  line-height: 1.21429em;
  /* Don't highlight prompt number selection */
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  -khtml-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
  /* Use default cursor */
  cursor: default;
}
@media (max-width: 540px) {
  .prompt {
    text-align: left;
  }
}
div.inner_cell {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  /* Old browsers */
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  box-flex: 1;
  /* Modern browsers */
  flex: 1;
}
@-moz-document url-prefix() {
  div.inner_cell {
    overflow-x: hidden;
  }
}
/* input_area and input_prompt must match in top border and margin for alignment */
div.input_area {
  border: 1px solid #cfcfcf;
  border-radius: 2px;
  background: #f7f7f7;
  line-height: 1.21429em;
}
/* This is needed so that empty prompt areas can collapse to zero height when there
   is no content in the output_subarea and the prompt. The main purpose of this is
   to make sure that empty JavaScript output_subareas have no height. */
div.prompt:empty {
  padding-top: 0;
  padding-bottom: 0;
}
div.unrecognized_cell {
  padding: 5px 5px 5px 0px;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
div.unrecognized_cell .inner_cell {
  border-radius: 2px;
  padding: 5px;
  font-weight: bold;
  color: red;
  border: 1px solid #cfcfcf;
  background: #eaeaea;
}
div.unrecognized_cell .inner_cell a {
  color: inherit;
  text-decoration: none;
}
div.unrecognized_cell .inner_cell a:hover {
  color: inherit;
  text-decoration: none;
}
@media (max-width: 540px) {
  div.unrecognized_cell > div.prompt {
    display: none;
  }
}
div.code_cell {
  /* avoid page breaking on code cells when printing */
}
@media print {
  div.code_cell {
    page-break-inside: avoid;
  }
}
/* any special styling for code cells that are currently running goes here */
div.input {
  page-break-inside: avoid;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.input {
    /* Old browsers */
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-box-align: stretch;
    display: -moz-box;
    -moz-box-orient: vertical;
    -moz-box-align: stretch;
    display: box;
    box-orient: vertical;
    box-align: stretch;
    /* Modern browsers */
    display: flex;
    flex-direction: column;
    align-items: stretch;
  }
}
/* input_area and input_prompt must match in top border and margin for alignment */
div.input_prompt {
  color: #303F9F;
  border-top: 1px solid transparent;
}
div.input_area > div.highlight {
  margin: 0.4em;
  border: none;
  padding: 0px;
  background-color: transparent;
}
div.input_area > div.highlight > pre {
  margin: 0px;
  border: none;
  padding: 0px;
  background-color: transparent;
}
/* The following gets added to the <head> if it is detected that the user has a
 * monospace font with inconsistent normal/bold/italic height.  See
 * notebookmain.js.  Such fonts will have keywords vertically offset with
 * respect to the rest of the text.  The user should select a better font.
 * See: https://github.com/ipython/ipython/issues/1503
 *
 * .CodeMirror span {
 *      vertical-align: bottom;
 * }
 */
.CodeMirror {
  line-height: 1.21429em;
  /* Changed from 1em to our global default */
  font-size: 14px;
  height: auto;
  /* Changed to auto to autogrow */
  background: none;
  /* Changed from white to allow our bg to show through */
}
.CodeMirror-scroll {
  /*  The CodeMirror docs are a bit fuzzy on if overflow-y should be hidden or visible.*/
  /*  We have found that if it is visible, vertical scrollbars appear with font size changes.*/
  overflow-y: hidden;
  overflow-x: auto;
}
.CodeMirror-lines {
  /* In CM2, this used to be 0.4em, but in CM3 it went to 4px. We need the em value because */
  /* we have set a different line-height and want this to scale with that. */
  padding: 0.4em;
}
.CodeMirror-linenumber {
  padding: 0 8px 0 4px;
}
.CodeMirror-gutters {
  border-bottom-left-radius: 2px;
  border-top-left-radius: 2px;
}
.CodeMirror pre {
  /* In CM3 this went to 4px from 0 in CM2. We need the 0 value because of how we size */
  /* .CodeMirror-lines */
  padding: 0;
  border: 0;
  border-radius: 0;
}
/*

Original style from softwaremaniacs.org (c) Ivan Sagalaev <Maniac@SoftwareManiacs.Org>
Adapted from GitHub theme

*/
.highlight-base {
  color: #000;
}
.highlight-variable {
  color: #000;
}
.highlight-variable-2 {
  color: #1a1a1a;
}
.highlight-variable-3 {
  color: #333333;
}
.highlight-string {
  color: #BA2121;
}
.highlight-comment {
  color: #408080;
  font-style: italic;
}
.highlight-number {
  color: #080;
}
.highlight-atom {
  color: #88F;
}
.highlight-keyword {
  color: #008000;
  font-weight: bold;
}
.highlight-builtin {
  color: #008000;
}
.highlight-error {
  color: #f00;
}
.highlight-operator {
  color: #AA22FF;
  font-weight: bold;
}
.highlight-meta {
  color: #AA22FF;
}
/* previously not defined, copying from default codemirror */
.highlight-def {
  color: #00f;
}
.highlight-string-2 {
  color: #f50;
}
.highlight-qualifier {
  color: #555;
}
.highlight-bracket {
  color: #997;
}
.highlight-tag {
  color: #170;
}
.highlight-attribute {
  color: #00c;
}
.highlight-header {
  color: blue;
}
.highlight-quote {
  color: #090;
}
.highlight-link {
  color: #00c;
}
/* apply the same style to codemirror */
.cm-s-ipython span.cm-keyword {
  color: #008000;
  font-weight: bold;
}
.cm-s-ipython span.cm-atom {
  color: #88F;
}
.cm-s-ipython span.cm-number {
  color: #080;
}
.cm-s-ipython span.cm-def {
  color: #00f;
}
.cm-s-ipython span.cm-variable {
  color: #000;
}
.cm-s-ipython span.cm-operator {
  color: #AA22FF;
  font-weight: bold;
}
.cm-s-ipython span.cm-variable-2 {
  color: #1a1a1a;
}
.cm-s-ipython span.cm-variable-3 {
  color: #333333;
}
.cm-s-ipython span.cm-comment {
  color: #408080;
  font-style: italic;
}
.cm-s-ipython span.cm-string {
  color: #BA2121;
}
.cm-s-ipython span.cm-string-2 {
  color: #f50;
}
.cm-s-ipython span.cm-meta {
  color: #AA22FF;
}
.cm-s-ipython span.cm-qualifier {
  color: #555;
}
.cm-s-ipython span.cm-builtin {
  color: #008000;
}
.cm-s-ipython span.cm-bracket {
  color: #997;
}
.cm-s-ipython span.cm-tag {
  color: #170;
}
.cm-s-ipython span.cm-attribute {
  color: #00c;
}
.cm-s-ipython span.cm-header {
  color: blue;
}
.cm-s-ipython span.cm-quote {
  color: #090;
}
.cm-s-ipython span.cm-link {
  color: #00c;
}
.cm-s-ipython span.cm-error {
  color: #f00;
}
.cm-s-ipython span.cm-tab {
  background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAMCAYAAAAkuj5RAAAAAXNSR0IArs4c6QAAAGFJREFUSMft1LsRQFAQheHPowAKoACx3IgEKtaEHujDjORSgWTH/ZOdnZOcM/sgk/kFFWY0qV8foQwS4MKBCS3qR6ixBJvElOobYAtivseIE120FaowJPN75GMu8j/LfMwNjh4HUpwg4LUAAAAASUVORK5CYII=);
  background-position: right;
  background-repeat: no-repeat;
}
div.output_wrapper {
  /* this position must be relative to enable descendents to be absolute within it */
  position: relative;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  z-index: 1;
}
/* class for the output area when it should be height-limited */
div.output_scroll {
  /* ideally, this would be max-height, but FF barfs all over that */
  height: 24em;
  /* FF needs this *and the wrapper* to specify full width, or it will shrinkwrap */
  width: 100%;
  overflow: auto;
  border-radius: 2px;
  -webkit-box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8);
  box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8);
  display: block;
}
/* output div while it is collapsed */
div.output_collapsed {
  margin: 0px;
  padding: 0px;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
}
div.out_prompt_overlay {
  height: 100%;
  padding: 0px 0.4em;
  position: absolute;
  border-radius: 2px;
}
div.out_prompt_overlay:hover {
  /* use inner shadow to get border that is computed the same on WebKit/FF */
  -webkit-box-shadow: inset 0 0 1px #000;
  box-shadow: inset 0 0 1px #000;
  background: rgba(240, 240, 240, 0.5);
}
div.output_prompt {
  color: #D84315;
}
/* This class is the outer container of all output sections. */
div.output_area {
  padding: 0px;
  page-break-inside: avoid;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
div.output_area .MathJax_Display {
  text-align: left !important;
}
div.output_area 
div.output_area 
div.output_area img,
div.output_area svg {
  max-width: 100%;
  height: auto;
}
div.output_area img.unconfined,
div.output_area svg.unconfined {
  max-width: none;
}
/* This is needed to protect the pre formating from global settings such
   as that of bootstrap */
.output {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.output_area {
    /* Old browsers */
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-box-align: stretch;
    display: -moz-box;
    -moz-box-orient: vertical;
    -moz-box-align: stretch;
    display: box;
    box-orient: vertical;
    box-align: stretch;
    /* Modern browsers */
    display: flex;
    flex-direction: column;
    align-items: stretch;
  }
}
div.output_area pre {
  margin: 0;
  padding: 0;
  border: 0;
  vertical-align: baseline;
  color: black;
  background-color: transparent;
  border-radius: 0;
}
/* This class is for the output subarea inside the output_area and after
   the prompt div. */
div.output_subarea {
  overflow-x: auto;
  padding: 0.4em;
  /* Old browsers */
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  box-flex: 1;
  /* Modern browsers */
  flex: 1;
  max-width: calc(100% - 14ex);
}
div.output_scroll div.output_subarea {
  overflow-x: visible;
}
/* The rest of the output_* classes are for special styling of the different
   output types */
/* all text output has this class: */
div.output_text {
  text-align: left;
  color: #000;
  /* This has to match that of the the CodeMirror class line-height below */
  line-height: 1.21429em;
}
/* stdout/stderr are 'text' as well as 'stream', but execute_result/error are *not* streams */
div.output_stderr {
  background: #fdd;
  /* very light red background for stderr */
}
div.output_latex {
  text-align: left;
}
/* Empty output_javascript divs should have no height */
div.output_javascript:empty {
  padding: 0;
}
.js-error {
  color: darkred;
}
/* raw_input styles */
div.raw_input_container {
  line-height: 1.21429em;
  padding-top: 5px;
}
pre.raw_input_prompt {
  /* nothing needed here. */
}
input.raw_input {
  font-family: monospace;
  font-size: inherit;
  color: inherit;
  width: auto;
  /* make sure input baseline aligns with prompt */
  vertical-align: baseline;
  /* padding + margin = 0.5em between prompt and cursor */
  padding: 0em 0.25em;
  margin: 0em 0.25em;
}
input.raw_input:focus {
  box-shadow: none;
}
p.p-space {
  margin-bottom: 10px;
}
div.output_unrecognized {
  padding: 5px;
  font-weight: bold;
  color: red;
}
div.output_unrecognized a {
  color: inherit;
  text-decoration: none;
}
div.output_unrecognized a:hover {
  color: inherit;
  text-decoration: none;
}
.rendered_html {
  color: #000;
  /* any extras will just be numbers: */
}



.rendered_html :link {
  text-decoration: underline;
}
.rendered_html :visited {
  text-decoration: underline;
}






.rendered_html h1:first-child {
  margin-top: 0.538em;
}
.rendered_html h2:first-child {
  margin-top: 0.636em;
}
.rendered_html h3:first-child {
  margin-top: 0.777em;
}
.rendered_html h4:first-child {
  margin-top: 1em;
}
.rendered_html h5:first-child {
  margin-top: 1em;
}
.rendered_html h6:first-child {
  margin-top: 1em;
}








.rendered_html * + ul {
  margin-top: 1em;
}
.rendered_html * + ol {
  margin-top: 1em;
}


.rendered_html pre,



.rendered_html tr,
.rendered_html th,

.rendered_html td,


.rendered_html * + table {
  margin-top: 1em;
}

.rendered_html * + p {
  margin-top: 1em;
}

.rendered_html * + img {
  margin-top: 1em;
}
.rendered_html img,

.rendered_html img.unconfined,

div.text_cell {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.text_cell > div.prompt {
    display: none;
  }
}
div.text_cell_render {
  /*font-family: "Helvetica Neue", Arial, Helvetica, Geneva, sans-serif;*/
  outline: none;
  resize: none;
  width: inherit;
  border-style: none;
  padding: 0.5em 0.5em 0.5em 0.4em;
  color: #000;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
}
a.anchor-link:link {
  text-decoration: none;
  padding: 0px 20px;
  visibility: hidden;
}
h1:hover .anchor-link,
h2:hover .anchor-link,
h3:hover .anchor-link,
h4:hover .anchor-link,
h5:hover .anchor-link,
h6:hover .anchor-link {
  visibility: visible;
}
.text_cell.rendered .input_area {
  display: none;
}
.text_cell.rendered 
.text_cell.unrendered .text_cell_render {
  display: none;
}
.cm-header-1,
.cm-header-2,
.cm-header-3,
.cm-header-4,
.cm-header-5,
.cm-header-6 {
  font-weight: bold;
  font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
}
.cm-header-1 {
  font-size: 185.7%;
}
.cm-header-2 {
  font-size: 157.1%;
}
.cm-header-3 {
  font-size: 128.6%;
}
.cm-header-4 {
  font-size: 110%;
}
.cm-header-5 {
  font-size: 100%;
  font-style: italic;
}
.cm-header-6 {
  font-size: 100%;
  font-style: italic;
}
</style>
<style type="text/css">.highlight .hll { background-color: #ffffcc }
.highlight  { background: #f8f8f8; }
.highlight .c { color: #408080; font-style: italic } /* Comment */
.highlight .err { border: 1px solid #FF0000 } /* Error */
.highlight .k { color: #008000; font-weight: bold } /* Keyword */
.highlight .o { color: #666666 } /* Operator */
.highlight .ch { color: #408080; font-style: italic } /* Comment.Hashbang */
.highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */
.highlight .cp { color: #BC7A00 } /* Comment.Preproc */
.highlight .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */
.highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */
.highlight .cs { color: #408080; font-style: italic } /* Comment.Special */
.highlight .gd { color: #A00000 } /* Generic.Deleted */
.highlight .ge { font-style: italic } /* Generic.Emph */
.highlight .gr { color: #FF0000 } /* Generic.Error */
.highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.highlight .gi { color: #00A000 } /* Generic.Inserted */
.highlight .go { color: #888888 } /* Generic.Output */
.highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.highlight .gs { font-weight: bold } /* Generic.Strong */
.highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.highlight .gt { color: #0044DD } /* Generic.Traceback */
.highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: #008000 } /* Keyword.Pseudo */
.highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.highlight .kt { color: #B00040 } /* Keyword.Type */
.highlight .m { color: #666666 } /* Literal.Number */
.highlight .s { color: #BA2121 } /* Literal.String */
.highlight .na { color: #7D9029 } /* Name.Attribute */
.highlight .nb { color: #008000 } /* Name.Builtin */
.highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.highlight .no { color: #880000 } /* Name.Constant */
.highlight .nd { color: #AA22FF } /* Name.Decorator */
.highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */
.highlight .ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.highlight .nf { color: #0000FF } /* Name.Function */
.highlight .nl { color: #A0A000 } /* Name.Label */
.highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */
.highlight .nv { color: #19177C } /* Name.Variable */
.highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.highlight .w { color: #bbbbbb } /* Text.Whitespace */
.highlight .mb { color: #666666 } /* Literal.Number.Bin */
.highlight .mf { color: #666666 } /* Literal.Number.Float */
.highlight .mh { color: #666666 } /* Literal.Number.Hex */
.highlight .mi { color: #666666 } /* Literal.Number.Integer */
.highlight .mo { color: #666666 } /* Literal.Number.Oct */
.highlight .sb { color: #BA2121 } /* Literal.String.Backtick */
.highlight .sc { color: #BA2121 } /* Literal.String.Char */
.highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.highlight .s2 { color: #BA2121 } /* Literal.String.Double */
.highlight .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */
.highlight .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.highlight .sx { color: #008000 } /* Literal.String.Other */
.highlight .sr { color: #BB6688 } /* Literal.String.Regex */
.highlight .s1 { color: #BA2121 } /* Literal.String.Single */
.highlight .ss { color: #19177C } /* Literal.String.Symbol */
.highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */
.highlight .vc { color: #19177C } /* Name.Variable.Class */
.highlight .vg { color: #19177C } /* Name.Variable.Global */
.highlight .vi { color: #19177C } /* Name.Variable.Instance */
.highlight .il { color: #666666 } /* Literal.Number.Integer.Long */</style>
<style type="text/css">
/* Temporary definitions which will become obsolete with Notebook release 5.0 */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-bold { font-weight: bold; }
</style>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The below is a guide to implementing linear regression machine learning tools using <a href="http://scikit-learn.org/stable/index.html">scikit-learn</a>, a Python package specifically designed for the implementation of machine learning. First, how to implement Ordinary Least Squares is examined, then how the problem of overfitting can be reduced using ridge regression, lasso regression and elastic net.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><h2 style="text-align: center">Index</h2>
Click on the links below to skip to that section:</p>
<ol>
<li><a href="#OLS">Ordinary Least Squares</a></li>
<li><a href="#QM">Quality Metrics</a></li>
<li><a href="#regularised">Regularised Regression:</a>
<ol>
<li><a href="#ridge">Ridge Regression</a></li>
<li><a href="#tuning">Optimising the Tuning Parameter</a></li>
<li><a href="#lasso">Lasso Regression</a></li>
<li><a href="#coefficient">Coefficient Path</a></li>
</ol>
</li>
<li><a href="#matrix">Correlation Matrix</a></li>
<li><a href="#elastic">Elastic Net</a></li>
</ol>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 style="text-align: center">The Data Used</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The below uses the Boston house prices dataset, which is one of the <a href="http://scikit-learn.org/stable/datasets/index.html#toy-datasets">'toy datasets'</a> that comes with the scikit-learn package.</p>
<p>This requires importing the <code>datasets</code> module:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [1]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">datasets</span>

<span class="n">boston</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">load_boston</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 style="text-align: center">Preparing the Data</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The dataset provided consists of the following information:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [2]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="k">print</span> <span class="p">[</span><span class="n">s</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">boston</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>['data', 'feature_names', 'DESCR', 'target']
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Full details as to what this dataset contains can be found by running <code>print datasets.load_boston()['DESCR']</code>. There are no missing attribute values, and so focus can be on the data analysis.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>First we randomly split the dataset into a training and test dataset. Here we allocate 25% of the data to the test set:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [3]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.cross_validation</span> <span class="kn">import</span> <span class="n">train_test_split</span>

<span class="n">x_train</span><span class="p">,</span> <span class="n">x_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">boston</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">boston</span><span class="o">.</span><span class="n">target</span><span class="p">,</span> 
                                                    <span class="n">test_size</span> <span class="o">=</span> <span class="mf">0.25</span><span class="p">,</span> <span class="n">random_state</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Note that pandas DataFrames are an <a href="http://scikit-learn.org/stable/modules/generated/sklearn.cross_validation.train_test_split.html">acceptable input</a>, and that output type matches input type (as of version 0.16)</p>
<p>If another user also sets argument <code>random_state = 0</code>, they should get the same split in the data.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 style="text-align: center"><a name="OLS"></a>1. Ordinary Least Squares</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We need to import the <code>linear_model</code> module:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [4]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">linear_model</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>As pandas and NumPy provide us with useful (but non-essential) tools:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [5]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="kn">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>To train our model, we run the following:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [6]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">reg_1</span> <span class="o">=</span> <span class="n">linear_model</span><span class="o">.</span><span class="n">LinearRegression</span><span class="p">()</span>
<span class="n">reg_1</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt output_prompt">Out[6]:</div>
<div class="output_text output_subarea output_execute_result">
<pre>LinearRegression(copy_X=True, fit_intercept=True, n_jobs=1, normalize=False)</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Note: <code>reg_1.fit()</code> accepts <a href="http://scikit-learn.org/stable/modules/generated/sklearn.linear_model.LinearRegression.html#sklearn.linear_model.LinearRegression.fit">NumPy arrays as inputs</a>. Hence, if our data is in pandas DataFrame or Series form, then we must apply the <a href="http://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.as_matrix.html"><code>pandas.DataFrame.as_matrix()</code></a> function to convert it into a NumPy array first.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can then find the coefficients for each feature (excluding the intercept):</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [7]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">reg_1</span><span class="o">.</span><span class="n">coef_</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt output_prompt">Out[7]:</div>
<div class="output_text output_subarea output_execute_result">
<pre>array([ -1.16869578e-01,   4.39939421e-02,  -5.34808462e-03,
         2.39455391e+00,  -1.56298371e+01,   3.76145473e+00,
        -6.95007160e-03,  -1.43520477e+00,   2.39755946e-01,
        -1.12937318e-02,  -9.86626289e-01,   8.55687565e-03,
        -5.00029440e-01])</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can find the intercept as follows:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [8]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">reg_1</span><span class="o">.</span><span class="n">intercept_</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt output_prompt">Out[8]:</div>
<div class="output_text output_subarea output_execute_result">
<pre>36.980455337621024</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can use pandas to match the coefficients with <code>feature_names</code>:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [9]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">labelled_coeffs_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">'labels'</span> <span class="p">:</span> <span class="n">boston</span><span class="o">.</span><span class="n">feature_names</span><span class="p">,</span>
                    <span class="s1">'coefficient'</span><span class="p">:</span> <span class="n">reg_1</span><span class="o">.</span><span class="n">coef_</span><span class="p">}</span>

<span class="n">labelled_coeffs_frame</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">labelled_coeffs_dict</span><span class="p">)</span>

<span class="n">labelled_coeffs_frame</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt output_prompt">Out[9]:</div>
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>coefficient</th>
<th>labels</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>-0.116870</td>
<td>CRIM</td>
</tr>
<tr>
<th>1</th>
<td>0.043994</td>
<td>ZN</td>
</tr>
<tr>
<th>2</th>
<td>-0.005348</td>
<td>INDUS</td>
</tr>
<tr>
<th>3</th>
<td>2.394554</td>
<td>CHAS</td>
</tr>
<tr>
<th>4</th>
<td>-15.629837</td>
<td>NOX</td>
</tr>
<tr>
<th>5</th>
<td>3.761455</td>
<td>RM</td>
</tr>
<tr>
<th>6</th>
<td>-0.006950</td>
<td>AGE</td>
</tr>
<tr>
<th>7</th>
<td>-1.435205</td>
<td>DIS</td>
</tr>
<tr>
<th>8</th>
<td>0.239756</td>
<td>RAD</td>
</tr>
<tr>
<th>9</th>
<td>-0.011294</td>
<td>TAX</td>
</tr>
<tr>
<th>10</th>
<td>-0.986626</td>
<td>PTRATIO</td>
</tr>
<tr>
<th>11</th>
<td>0.008557</td>
<td>B</td>
</tr>
<tr>
<th>12</th>
<td>-0.500029</td>
<td>LSTAT</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can interpret the above. A unit increase in a given feature increases the expected value of the target variable by the value of the coefficient, <strong>holding all of the other features fixed</strong>. By running <code>boston['DESCR']</code>, we can see that the target variable is the Median value of owner-occupied homes in \$1000's, whilst RM is the average number of rooms per dwelling. Hence, the above model suggests that, for every additional room on average per dwelling (unit increase in RM), there is an expected \$3761.46 increase in the median value of owner-occupied homes.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can then formulate predictions using <code>reg_1.predict(data)</code>:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [10]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">reg_1</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x_test</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt output_prompt">Out[10]:</div>
<div class="output_text output_subarea output_execute_result">
<pre>array([ 24.95242095])</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Note that we use <code>[0:1]</code> even though the prediction is for one value, as inputting 1D arrays will raise <code>ValueError</code> in 0.19</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 style="text-align: center">Significance Testing</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Scikit-learn does not provide an easy way to perform significance tests on individual coefficients. If this is required, a more suitable Python package is <a href="https://pypi.python.org/pypi/statsmodels/0.6.0">statsmodels</a></p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 style="text-align: center"><a name="QM"></a>2. Quality Metrics</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Quality Metrics can be found as follows:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [11]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">metrics</span>

<span class="c1">#Mean Squared Error</span>

<span class="n">mean_squared_error</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">reg_1</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x_test</span><span class="p">),</span> <span class="n">y_test</span><span class="p">)</span>
<span class="c1">#gives same result as: np.mean((reg_1.predict(x_test) - y_test) ** 2)</span>

<span class="k">print</span> <span class="s2">"Mean Squared Error (MSE): {0}"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">mean_squared_error</span><span class="p">)</span>


<span class="c1">#Coefficient of Determination</span>

<span class="n">coefficient_of_determination</span> <span class="o">=</span> <span class="n">reg_1</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">x_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>
<span class="c1">#gives same result as metrics.r2_score(y_true = y_test, y_pred = reg_1.predict(x_test))</span>

<span class="k">print</span> <span class="s2">"R Squared: {0}"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">coefficient_of_determination</span><span class="p">)</span>


<span class="c1">#Residual Sum of Squares (RSS)</span>

<span class="n">RSS</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">reg_1</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x_test</span><span class="p">)</span> <span class="o">-</span> <span class="n">y_test</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>

<span class="k">print</span> <span class="s2">"RSS: {0}"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">RSS</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Mean Squared Error (MSE): 29.7905591642
R Squared: 0.635362078667
RSS: 3783.40101386
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>A full list of metrics is available <a href="http://scikit-learn.org/stable/modules/model_evaluation.html">here</a></p>
<p>Note that all of the above metrics - including <code>score()</code> - apply to all of the Generalized Linear Models in Scikit-learn.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 style="text-align: center"><a name="regularised"></a>3. Regularised Regression</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>When the number of observations is much larger than the number of variables, the Ordinary Least Squares' approach will tend to exhibit a low variance - estimates will change little given minor pertubations in the data. Hence, the predictive performance will be strong (Cassella et al, 2015).</p>
<p>However, when the number of observations and variables is similar, there is a risk of overfitting - the model fits the training dataset well but cannot be generalised reliably. When the number of observations is less than the number of variables, Ordinary Least Squares cannot be used at all. In these scenarios, regularisation is required.</p>
<p>Two commonly used approaches are: the <strong>ridge regression</strong> (L<sub>2</sub> regularised regression) and the <strong>lasso regression</strong> (L<sub>1</sub> regularised regression). Both modify the model optimisation process to penalise higher coefficient values, as high values are an indicator of overfitting.</p>
<p>The higher the tuning parameter value (denoted <code>alpha</code> in Scikit-learn), the more higher coefficient values will be penalised. Hence, for both regularised regression approaches, the higher <code>alpha</code>, the lower the coefficient values the optimisation process will generate - with a limit of zero. If <code>alpha</code> is zero, then an Ordinary Least Squares regression will be run.</p>
<p>Under <strong>ridge regression</strong>, all of the features will be kept in the model as we increase <code>alpha</code>. This means a slower, less interpretable model. However, its performance is better when most of the included features drive the target value (Cassella et al, 2015).</p>
<p>Under <strong>lasso regression</strong>, some of the features' values will become exactly zero, as we increase <code>alpha</code>. Hence, a sparser, faster, more interpretable model results. Its performance is better when only a few of the included features are thought to truly drive the dependent variable's value (Cassella et al, 2015). The value of lasso in aiding model interpretation means that it may be performed, even if Ordinary Least Squares is generating reliable predictions.</p>
<p>Both ridge and lasso regression are unreliable when there is a high correlation between different features' values. Ridge leads coefficient values to converge, whilst lasso arbitrarily removes features. Here Elastic Net may provide a more suitable approach (Hastie et al, 2013). This provides a hybrid between lasso and ridge.</p>
<p>The below will discuss how the lasso and ridge regression approaches can be implemented in scikit-learn:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 style="text-align: center"><a name="ridge"></a>A. Ridge Regression</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The below uses a tuning parameter value of 0.5, and requires <code>linear_model</code> module:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [12]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">reg_ridge</span> <span class="o">=</span> <span class="n">linear_model</span><span class="o">.</span><span class="n">Ridge</span><span class="p">(</span><span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">)</span>
<span class="n">reg_ridge</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt output_prompt">Out[12]:</div>
<div class="output_text output_subarea output_execute_result">
<pre>Ridge(alpha=0.5, copy_X=True, fit_intercept=True, max_iter=None,
   normalize=False, random_state=None, solver='auto', tol=0.001)</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Coefficients, the intercept and predictions can all be found in the same way as with Ordinary Least Squares:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [13]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="k">print</span> <span class="s2">"Coefficients are: {0}"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">reg_ridge</span><span class="o">.</span><span class="n">coef_</span><span class="p">)</span>

<span class="k">print</span> <span class="s2">"Intercept is: {0}"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">reg_ridge</span><span class="o">.</span><span class="n">intercept_</span><span class="p">)</span>

<span class="k">print</span> <span class="s2">"Prediction for first house in test dataset: {0}"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">reg_ridge</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x_test</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">]))</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Coefficients are: [ -1.14800388e-01   4.48854707e-02  -2.49113266e-02   2.35025027e+00
  -1.07096752e+01   3.79227215e+00  -1.17800878e-02  -1.37038928e+00
   2.24039660e-01  -1.15836405e-02  -9.32419484e-01   8.79786724e-03
  -5.05077028e-01]
Intercept is: 33.5779570383
Prediction for first house in test dataset: [ 24.98197093]
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 style="text-align: center"><a name="tuning"></a>B. Optimising the Tuning Parameter</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The problem with the above approach is that it arbitrarily chose 0.5 for the value of the tuning parameter value <code>alpha</code>. The following are widely used approaches to choosing <code>alpha</code>:</p>
<ul>
<li><strong>Hold-Out Validation</strong>: One approach to finding the optimal value for <code>alpha</code> would be to split the train data further into a train and validation dataset. The validation dataset could then be used to compare the performance of different models with different values of <code>alpha</code>. Scikit-learn <a href="http://scikit-learn.org/stable/modules/cross_validation.html#cross-validation">discourages</a> Hold-Out Validation, arguing that it reduces the data available for learning the model and that results become dependent on the train/validation split.</li>
</ul>
<ul>
<li><strong>Cross-validation (CV)</strong>: under k-fold CV, we split the train dataset randomly into k subsets - 'folds'. With each fold, we train the model using the rest of the data, and then calculate a validation error using that fold. The final CV error is the mean of these validation errors. Setting k = size of train dataset leads to Leave One Out CV (LOO), this is computationally the slowest technique and leads to the higest variation in estimates of the true error. However, LOO also leads to the least biased estimates of performance. <a href="http://scikit-learn.org/stable/modules/cross_validation.html#leave-one-out-loo">Scikit-learn recommends 5-fold or 10-fold CV</a>.</li>
</ul>
<p>The above approaches can be extended to lasso regression and to the elastic net approach.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 style="text-align: center">Cross-Validation</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>CV is particularly simple to implement in Scikit-learn. There is a version of ridge regression with built-in CV (<a href="http://scikit-learn.org/stable/modules/generated/sklearn.linear_model.RidgeCV.html#sklearn.linear_model.RidgeCV"><code>sklearn.linear_model.RidgeCV</code></a>):</p>
<ul>
<li>The user has to specify which <code>alpha</code> values are to be tested (<code>alphas=</code>). </li>
<li>By default, Generalised Cross-Validation is performed (an efficient form of LOO), although k-fold CV is possible through specifying <code>cv=</code> to k.</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The below example is of 5-fold CV:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [14]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">reg_CV</span> <span class="o">=</span> <span class="n">linear_model</span><span class="o">.</span><span class="n">RidgeCV</span><span class="p">(</span><span class="n">alphas</span><span class="o">=</span><span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">],</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">reg_CV</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt output_prompt">Out[14]:</div>
<div class="output_text output_subarea output_execute_result">
<pre>RidgeCV(alphas=[0.1, 1.0, 10.0], cv=5, fit_intercept=True, gcv_mode=None,
    normalize=False, scoring=None, store_cv_values=False)</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can specify a range of <code>alpha</code> values to be tested using <a href="http://docs.scipy.org/doc/numpy/reference/generated/numpy.linspace.html"><code>numpy.linspace</code></a>. If we want <code>alpha</code> values to be evenly spaced across a log scale, the we can use <a href="http://docs.scipy.org/doc/numpy/reference/generated/numpy.logspace.html"><code>numpy.logspace</code></a> instead.</p>
<p>Below provides an example:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [15]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">reg_CV_2</span> <span class="o">=</span> <span class="n">linear_model</span><span class="o">.</span><span class="n">RidgeCV</span><span class="p">(</span><span class="n">alphas</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">stop</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="mi">100</span><span class="p">),</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">reg_CV_2</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt output_prompt">Out[15]:</div>
<div class="output_text output_subarea output_execute_result">
<pre>RidgeCV(alphas=array([  0.1,   0.2, ...,   9.9,  10. ]), cv=5,
    fit_intercept=True, gcv_mode=None, normalize=False, scoring=None,
    store_cv_values=False)</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>To find which of the alphas values is optimal:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [16]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">reg_CV</span><span class="o">.</span><span class="n">alpha_</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt output_prompt">Out[16]:</div>
<div class="output_text output_subarea output_execute_result">
<pre>0.1</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Coefficients, the intercept and predictions can all be found in the same way as with Ordinary Least Squares:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [17]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="k">print</span> <span class="s2">"Coefficients are: {0}"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">reg_CV</span><span class="o">.</span><span class="n">coef_</span><span class="p">)</span>

<span class="k">print</span> <span class="s2">"Intercept is: {0}"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">reg_CV</span><span class="o">.</span><span class="n">intercept_</span><span class="p">)</span>

<span class="k">print</span> <span class="s2">"Prediction for first house in test dataset: {0}"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">reg_CV</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x_test</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">]))</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Coefficients are: [ -1.16312779e-01   4.42262853e-02  -1.05869052e-02   2.38600155e+00
  -1.43141090e+01   3.77098515e+00  -8.25299886e-03  -1.41784612e+00
   2.35494165e-01  -1.13687149e-02  -9.72048173e-01   8.62134022e-03
  -5.01282582e-01]
Intercept is: 36.059824542
Prediction for first house in test dataset: [ 24.960623]
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 style="text-align: center">Hold-Out Validation</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>To perform Hold-Out Validation, we first need a validation and a training set:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [18]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">x_train_2</span><span class="p">,</span> <span class="n">x_valid</span><span class="p">,</span> <span class="n">y_train_2</span><span class="p">,</span> <span class="n">y_valid</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">x_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> 
                                                          <span class="n">test_size</span> <span class="o">=</span> <span class="mf">0.25</span><span class="p">,</span> <span class="n">random_state</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We train the model on the training data, using several different specific values of <code>alpha</code>:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [19]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">reg_ridge_01</span> <span class="o">=</span> <span class="n">linear_model</span><span class="o">.</span><span class="n">Ridge</span><span class="p">(</span><span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">)</span>
<span class="n">reg_ridge_01</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x_train_2</span><span class="p">,</span> <span class="n">y_train_2</span><span class="p">)</span>

<span class="n">reg_ridge_1</span> <span class="o">=</span> <span class="n">linear_model</span><span class="o">.</span><span class="n">Ridge</span><span class="p">(</span><span class="n">alpha</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">)</span>
<span class="n">reg_ridge_1</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x_train_2</span><span class="p">,</span> <span class="n">y_train_2</span><span class="p">)</span>

<span class="n">reg_ridge_10</span> <span class="o">=</span> <span class="n">linear_model</span><span class="o">.</span><span class="n">Ridge</span><span class="p">(</span><span class="n">alpha</span> <span class="o">=</span> <span class="mf">10.0</span><span class="p">)</span>
<span class="n">reg_ridge_10</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x_train_2</span><span class="p">,</span> <span class="n">y_train_2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt output_prompt">Out[19]:</div>
<div class="output_text output_subarea output_execute_result">
<pre>Ridge(alpha=10.0, copy_X=True, fit_intercept=True, max_iter=None,
   normalize=False, random_state=None, solver='auto', tol=0.001)</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can then compare the models on the validation set, e.g. using Mean Squared Error:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [20]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">MSE_ridge_01</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">reg_ridge_01</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x_valid</span><span class="p">),</span> <span class="n">y_valid</span><span class="p">)</span>
<span class="n">MSE_ridge_1</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">reg_ridge_1</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x_valid</span><span class="p">),</span> <span class="n">y_valid</span><span class="p">)</span>
<span class="n">MSE_ridge_10</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">reg_ridge_10</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x_valid</span><span class="p">),</span> <span class="n">y_valid</span><span class="p">)</span>

<span class="n">alphas</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mi">10</span><span class="p">]</span>
<span class="n">mses</span> <span class="o">=</span> <span class="p">[</span><span class="n">MSE_ridge_01</span><span class="p">,</span> <span class="n">MSE_ridge_1</span><span class="p">,</span> <span class="n">MSE_ridge_10</span><span class="p">]</span>

<span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
    <span class="k">print</span> <span class="s2">"MSE for alpha = {0} is: {1}"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">alphas</span><span class="p">[</span><span class="n">index</span><span class="p">],</span> <span class="n">mses</span><span class="p">[</span><span class="n">index</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>MSE for alpha = 0.1 is: 21.7981625853
MSE for alpha = 1.0 is: 21.316986281
MSE for alpha = 10 is: 21.5791901245
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The above suggests an <code>alpha</code> of 1.0 is optimal.</p>
<p>The below shows how the Validation Error can be visualised for a range of different values of <code>alpha</code> examined:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [21]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="o">%</span><span class="k">matplotlib</span> inline

<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">"Validation Error for different alpha"</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">"alpha"</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">"MSE"</span><span class="p">)</span>

<span class="n">alphas</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">stop</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>

<span class="n">mses</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">alpha</span> <span class="ow">in</span> <span class="n">alphas</span><span class="p">:</span>
    <span class="n">reg_model</span> <span class="o">=</span> <span class="n">linear_model</span><span class="o">.</span><span class="n">Ridge</span><span class="p">(</span><span class="n">alpha</span> <span class="o">=</span> <span class="n">alpha</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x_train_2</span><span class="p">,</span> <span class="n">y_train_2</span><span class="p">)</span>
    <span class="n">mse</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">reg_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x_valid</span><span class="p">),</span> <span class="n">y_valid</span><span class="p">)</span>
    <span class="n">mses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mse</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">alphas</span><span class="p">,</span> <span class="n">mses</span><span class="p">,</span> <span class="s1">'b-'</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
">
</img></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 style="text-align: center"><a name="lasso"></a>C. Lasso Regression</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Similar to Ridge Regression, the below uses a tuning parameter value of 0.2, and requires linear_model module:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [33]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">reg_lasso</span> <span class="o">=</span> <span class="n">linear_model</span><span class="o">.</span><span class="n">Lasso</span><span class="p">(</span><span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.2</span><span class="p">,</span> <span class="n">normalize</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
<span class="n">reg_lasso</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt output_prompt">Out[33]:</div>
<div class="output_text output_subarea output_execute_result">
<pre>Lasso(alpha=0.2, copy_X=True, fit_intercept=True, max_iter=1000,
   normalize=True, positive=False, precompute=False, random_state=None,
   selection='cyclic', tol=0.0001, warm_start=False)</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Note that it is best to normalise the features. This prevents features from being dropped simply because they are relatively small in magnitude.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Coefficients, the intercept and predictions can all be found in the same way as with Ordinary Least Squares:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [34]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="k">print</span> <span class="s2">"Coefficients are: {0}"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">reg_lasso</span><span class="o">.</span><span class="n">coef_</span><span class="p">)</span>

<span class="k">print</span> <span class="s2">"Intercept is: {0}"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">reg_lasso</span><span class="o">.</span><span class="n">intercept_</span><span class="p">)</span>

<span class="k">print</span> <span class="s2">"Prediction for first house in test dataset: {0}"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">reg_lasso</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x_test</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">]))</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Coefficients are: [-0.          0.         -0.          0.         -0.          1.53213551
 -0.          0.         -0.         -0.         -0.          0.
 -0.33893368]
Intercept is: 17.1891775593
Prediction for first house in test dataset: [ 24.4044185]
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 style="text-align: center">Cross-Validation</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Just as with ridge regression, there is a version of lasso regression with built-in CV (<a href="http://scikit-learn.org/stable/modules/generated/sklearn.linear_model.LassoCV.html#sklearn.linear_model.LassoCV"><code>sklearn.linear_model.LassoCV</code></a>). We specify a lasso regression to be run on specific <code>alpha</code>:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [24]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">reg_lasso_CV</span> <span class="o">=</span> <span class="n">linear_model</span><span class="o">.</span><span class="n">LassoCV</span><span class="p">(</span><span class="n">eps</span> <span class="o">=</span> <span class="bp">None</span><span class="p">,</span> 
                                    <span class="n">n_alphas</span> <span class="o">=</span> <span class="bp">None</span><span class="p">,</span> 
                                    <span class="n">alphas</span><span class="o">=</span><span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">],</span> 
                                    <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
                                    <span class="n">normalize</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
<span class="n">reg_lasso_CV</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt output_prompt">Out[24]:</div>
<div class="output_text output_subarea output_execute_result">
<pre>LassoCV(alphas=[0.1, 1.0, 10.0], copy_X=True, cv=5, eps=None,
    fit_intercept=True, max_iter=1000, n_alphas=None, n_jobs=1,
    normalize=True, positive=False, precompute='auto', random_state=None,
    selection='cyclic', tol=0.0001, verbose=False)</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Note that the default cross-validation technique (<code>cv=</code>) is three-fold cross-validation.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Unlike with ridge regression, we can specify parameters that determine how the lasso regression iteratively fits along a regularisation path - specifically the length of the path <code>eps=</code> (default sets <code>alpha_min/alpha_max = 0.001</code>) and the number of alphas along the path <code>n_alphas=</code> (default 100):</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [25]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">reg_lasso_CV_2</span> <span class="o">=</span> <span class="n">linear_model</span><span class="o">.</span><span class="n">LassoCV</span><span class="p">(</span><span class="n">eps</span> <span class="o">=</span> <span class="mf">0.001</span><span class="p">,</span> 
                                      <span class="n">n_alphas</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> 
                                      <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
                                      <span class="n">normalize</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
<span class="n">reg_lasso_CV_2</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt output_prompt">Out[25]:</div>
<div class="output_text output_subarea output_execute_result">
<pre>LassoCV(alphas=None, copy_X=True, cv=5, eps=0.001, fit_intercept=True,
    max_iter=1000, n_alphas=100, n_jobs=1, normalize=True, positive=False,
    precompute='auto', random_state=None, selection='cyclic', tol=0.0001,
    verbose=False)</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Finding values is similar to ridge regression:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [26]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="k">print</span> <span class="s2">"Alpha is: {0}"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">reg_lasso_CV_2</span><span class="o">.</span><span class="n">alpha_</span><span class="p">)</span>

<span class="k">print</span> <span class="s2">"Coefficients are: {0}"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">reg_lasso_CV_2</span><span class="o">.</span><span class="n">coef_</span><span class="p">)</span>

<span class="k">print</span> <span class="s2">"Intercept is: {0}"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">reg_lasso_CV_2</span><span class="o">.</span><span class="n">intercept_</span><span class="p">)</span>

<span class="k">print</span> <span class="s2">"Prediction for first house in test dataset: {0}"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">reg_lasso_CV_2</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x_test</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">]))</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Alpha is: 0.00155246977949
Coefficients are: [ -1.05429067e-01   3.93895798e-02  -1.26214698e-02   2.37258929e+00
  -1.44113650e+01   3.81861929e+00  -4.90918272e-03  -1.32150049e+00
   1.89080983e-01  -9.15478355e-03  -9.72396612e-01   8.12809910e-03
  -5.02861886e-01]
Intercept is: 35.0102948622
Prediction for first house in test dataset: [ 25.28586798]
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Note that the lasso regression introduces a bias in the coefficient values. Hence, if our aim is a model that we can interpret, then we should rerun an Ordinary Least Squares regression including only those features with non-zero coefficients. The above approach also seeks to optimise the model for predictions <strong>not</strong> for interpretation. The best model for interpretation purposes tends to have <a href="http://scikit-learn.org/stable/modules/feature_selection.html#l1-based-feature-selection">fewer features</a> than that provided by <code>LassoCV</code></p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 style="text-align: center"><a name="coefficient"></a>D. Coefficient Path</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This shows how coefficient values fall to zero as we increase alpha. This can be used to indicate those most important features that are most robust to increasing the tuning parameter. Coefficient paths can also be drawn for the elastic net approach:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [27]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.cm</span> <span class="kn">as</span> <span class="nn">cm</span>

<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">normalize</span>

<span class="n">x_normalized</span> <span class="o">=</span> <span class="n">normalize</span><span class="p">(</span><span class="n">x_train</span><span class="p">)</span>

<span class="n">alphas_lasso</span><span class="p">,</span> <span class="n">coeffs_lasso</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">linear_model</span><span class="o">.</span><span class="n">lasso_path</span><span class="p">(</span><span class="n">x_normalized</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> 
                                                        <span class="n">eps</span> <span class="o">=</span> <span class="mf">0.001</span><span class="p">,</span> <span class="n">n_alphas</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">"-Log(alpha)"</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">"coefficients"</span><span class="p">)</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_color_cycle</span><span class="p">([</span><span class="n">cm</span><span class="o">.</span><span class="n">Paired</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">140</span><span class="p">,</span> <span class="mi">20</span><span class="p">)]</span> <span class="o">+</span> 
                   <span class="p">[</span><span class="n">cm</span><span class="o">.</span><span class="n">Paired</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">140</span><span class="p">,</span> <span class="mi">280</span><span class="p">,</span> <span class="mi">20</span><span class="p">)])</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">alphas_lasso</span><span class="p">),</span> <span class="n">coeffs_lasso</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">labels</span> <span class="o">=</span> <span class="n">boston</span><span class="o">.</span><span class="n">feature_names</span><span class="p">,</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">1.02</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="o">.</span><span class="mi">102</span><span class="p">),</span> <span class="n">loc</span><span class="o">=</span><span class="s2">"best"</span><span class="p">,</span>
           <span class="n">ncol</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">"expand"</span><span class="p">,</span> <span class="n">borderaxespad</span><span class="o">=</span><span class="mf">0.</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre>/Users/andrewburnie/anaconda/envs/ml/lib/python2.7/site-packages/matplotlib/cbook.py:137: MatplotlibDeprecationWarning: The set_color_cycle attribute was deprecated in version 1.5. Use set_prop_cycle instead.
  warnings.warn(message, mplDeprecation, stacklevel=1)
</pre>
</div>
</div>
<div class="output_area"><div class="prompt"></div>
<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
Q4awdOnSvfoMkQ7nppzEbOfaihavOnbsWAAqKioYPXp09GyhqqqKRx99lAcffBC/38/48eMpKSlh
3Lhxe9zerqadTVadNnHs7QE/EW655RaWLl3KO++8s8vl3bp143/+53/43//9Xy655JI2jk4kie3F
AT9RnnrqKUaNGsW//vUvJk2axIYNGwgEAjz++OOkpqZywgknAOE+zeOOO46NGzfStWvX3W5vd9PO
JiM1VXmktLSUm2++mccee4xAILDbeldeeSWvvvrqbpOLiHijoY/j6KOP5pxzzuEXv/gFEL5qqqKi
gn79+lFYWMgZZ5xBMBhkzpw5e9zeE0880ai5Opl12jMOL61Zs4aJEydy5513Mnz48D3WzcvL48or
r+TWW2/dY4IREe9cccUVDBw4kAULFvDKK6/wwgsv8O1vfzu6/Pe//z3FxcVcdtllwPakEwqFWLFi
BbfffjuvvfYab775pifxx0tnHB647777WL9+PT/72c8a3ccRCASYOnXqTpfdXn755fj9fl2OK5Ik
dvwuduvWjbPPPpvRo0dzyCGHMHr0aHr06BF9XH755Xz44YfRy23ffPNNAoEAeXl5jBo1ioqKChYu
XMgBBxzgxe7ETVPHiohIlKaOFRGRhFPiEBGRuChxiIhIXJQ4REQkLkocIiISFyUOERGJixKHiIjE
RYlDRETiosQhIiJxUeLwwMCBA3nllVcoLi7G5/Nx2223NVq+zz77sGDBAgBmzpxJWloaeXl55OXl
sf/++3PZZZexdu3aaP3i4uJdDo7W8DkQHnlz/PjxdO/enfz8fIYPH77LmclEZPdip3xOSUkhKysr
Wvbwww9H6/3tb3/D5/Px6KOPNlr/mWeeobCwkC1btkTLnnrqKfr27cvWrVvbbD/2lhKHxwoKCrj1
1lvZtm3bbutMmDCBsrIyNm3axBNPPMHatWs59NBDWbduXbROU+NYTZkyhf79+7Ny5Uo2btzIAw88
EJ1tUESaJ3bK5/79+/Pss89GyyZOnBitV1JSsstpY08++WRGjx7NFVdcAcCWLVuYOnUqf/7zn8nN
zW3TfdkbShweGzZsGCNHjuT2229vsm5KSgrDhg1j7ty5dO/evVnrNFi4cCHnnHMOGRkZ+Hw+Djro
IMaMGbM3oYt0as45djUe3vLly1mwYAH33nsv8+fPZ/369Y2W33XXXcyfP58XX3yRn//854waNYqT
TjqprcJOCCUOj5kZN9xwA3feeWej09c98fl8nHrqqXFNMzly5EimTp3K3LlzWblyZUvDFZEmlJSU
8N3vfpdx48YxbNgwHnrooUbLu3btyl133cXkyZN57rnnuOuuuzyKtOU67Xwcv3v9jwnZzlVH7f3M
fMOHD+e4445j1qxZ3Hzzzc1aJ95pJh999FFmzZrFjTfeyCeffMK3v/1t7r33Xr773e+2NGwRzyx9
+KGmKzXDsImTE7KdWA888EB03o1JkyZRUlLCz3/+80Z1RowYQVlZGWeeeeYeZwVMVp02cSTigJ9I
v/nNbxgxYsROv2C7EzvNpN/vp66ubqc6dXV1pKamAuEJoW666SZuuukmNm3axC9+8QvGjRunsw9p
l1rjgJ8I//73v/nyyy8588wzAZg4cSLXXXcdH3zwQaNJ2376059yzjnn8Pjjj/PWW28xYsQIr0Ju
ETVVJYn99tuP0047jd/+9rdNdnQ755g3bx7HHHMMAP369WPFihWN6lRWVrJ+/Xr69++/0/oFBQVc
eeWVrF69ms2bNyduJ0Q6ueLiYgC+853vUFhYyBFHHIGZRcsB7r//flatWsXs2bP57W9/y/nnn08w
GPQq5BZR4kgiv/71r/nrX/+6U19HQwdcfX09S5cuZcKECaxbty56djJixAgyMjKYNWsWNTU1bNu2
jenTp3PYYYfRr18/AKZPn87HH39MfX09W7duZfbs2QwePJj8/Py23UmRDqqmpoZHH32Uv/zlLyxe
vJj333+f999/n7vvvpuHHnqIUCjE6tWr+eUvf8l9991HamoqF198Md26dePGG2/0Ovy4KHF4YHdn
FAMGDGDKlCk7XZr7yCOPEAgE6NKlC2PHjqV79+6888479OrVC4C0tDSeffZZXn31Vfr27cvgwYNZ
u3YtjzzySHQblZWVjBs3jvz8fAYPHszKlSt5+umnW28nRTq4Hb/HTz75JFlZWUyZMqXRtLHnnXce
9fX1zJ8/n0svvZRJkyZx5JFHRte79957ueuuu1i6dGlb70KLaepYERGJ0tSxIiKScEocIiISFyUO
ERGJixKHiIjERYlDRETiosQhIiJxUeIQEZG4KHGIiEhclDhERCQuShwemjNnDocddhi5ubn06dOH
k046iX//+9/MnDmTKVOm7FTf5/PxxRdfNCrb3RSVADfddBODBg0iEAjQr1+/RjOUiUjLDRgwgKys
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
">
</img></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The above coefficient path suggests that 'B' is the most important feature. 'ZN'and 'TAX' are also important. To get different colors for the different features, we have used the module <code>matplotlib.cm</code>. It is important to choose a colour map where the colours vary noticeably. The colour maps available can be seen <a href="http://matplotlib.org/examples/color/colormaps_reference.html">here</a>. Note that combining color maps (as in the above code) can enhance colour variation.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Above based on code provided by <a href="http://scikit-learn.org/stable/auto_examples/linear_model/plot_lasso_coordinate_descent_path.html">Scikit-learn</a>. For more information on how to set the legend see <a href="http://matplotlib.org/users/legend_guide.html">matplotlib documentation</a>.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 style="text-align: center"><a name="matrix"></a>4. Correlation Matrix</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Lasso and ridge regressions are unreliable when there is a high correlation between different features. We can check for this correlation through use of a correlation matrix. The below examines the strength of the <strong>linear</strong> relationships using Pearson Product-Moment Correlation Coefficients using <a href="http://docs.scipy.org/doc/numpy/reference/generated/numpy.corrcoef.html">NumPy</a>:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [28]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">correlation_matrix</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">corrcoef</span><span class="p">(</span><span class="n">x_train</span><span class="p">,</span> <span class="n">rowvar</span> <span class="o">=</span> <span class="mi">0</span><span class="p">))</span>

<span class="c1">#rowvar = 0 to as rows relate to different records, columns to variables</span>

<span class="c1">#To label the different features:</span>

<span class="n">correlation_matrix</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">boston</span><span class="o">.</span><span class="n">feature_names</span>
<span class="n">correlation_matrix</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">boston</span><span class="o">.</span><span class="n">feature_names</span>

<span class="n">correlation_matrix</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt output_prompt">Out[28]:</div>
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>CRIM</th>
<th>ZN</th>
<th>INDUS</th>
<th>CHAS</th>
<th>NOX</th>
<th>RM</th>
<th>AGE</th>
<th>DIS</th>
<th>RAD</th>
<th>TAX</th>
<th>PTRATIO</th>
<th>B</th>
<th>LSTAT</th>
</tr>
</thead>
<tbody>
<tr>
<th>CRIM</th>
<td>1.000000</td>
<td>-0.199932</td>
<td>0.388912</td>
<td>-0.051498</td>
<td>0.424337</td>
<td>-0.185924</td>
<td>0.338865</td>
<td>-0.365796</td>
<td>0.613971</td>
<td>0.567040</td>
<td>0.270841</td>
<td>-0.300679</td>
<td>0.454672</td>
</tr>
<tr>
<th>ZN</th>
<td>-0.199932</td>
<td>1.000000</td>
<td>-0.528755</td>
<td>-0.052096</td>
<td>-0.524911</td>
<td>0.327201</td>
<td>-0.584627</td>
<td>0.660710</td>
<td>-0.313989</td>
<td>-0.327254</td>
<td>-0.383914</td>
<td>0.168671</td>
<td>-0.428367</td>
</tr>
<tr>
<th>INDUS</th>
<td>0.388912</td>
<td>-0.528755</td>
<td>1.000000</td>
<td>0.046481</td>
<td>0.755708</td>
<td>-0.395119</td>
<td>0.635201</td>
<td>-0.696408</td>
<td>0.578671</td>
<td>0.729234</td>
<td>0.377993</td>
<td>-0.339950</td>
<td>0.616902</td>
</tr>
<tr>
<th>CHAS</th>
<td>-0.051498</td>
<td>-0.052096</td>
<td>0.046481</td>
<td>1.000000</td>
<td>0.059083</td>
<td>0.081925</td>
<td>0.068587</td>
<td>-0.087921</td>
<td>0.007005</td>
<td>-0.027192</td>
<td>-0.092955</td>
<td>0.075155</td>
<td>-0.045924</td>
</tr>
<tr>
<th>NOX</th>
<td>0.424337</td>
<td>-0.524911</td>
<td>0.755708</td>
<td>0.059083</td>
<td>1.000000</td>
<td>-0.287367</td>
<td>0.743524</td>
<td>-0.773083</td>
<td>0.628727</td>
<td>0.686920</td>
<td>0.175481</td>
<td>-0.376619</td>
<td>0.599609</td>
</tr>
<tr>
<th>RM</th>
<td>-0.185924</td>
<td>0.327201</td>
<td>-0.395119</td>
<td>0.081925</td>
<td>-0.287367</td>
<td>1.000000</td>
<td>-0.248617</td>
<td>0.193052</td>
<td>-0.174508</td>
<td>-0.272416</td>
<td>-0.370481</td>
<td>0.131769</td>
<td>-0.612997</td>
</tr>
<tr>
<th>AGE</th>
<td>0.338865</td>
<td>-0.584627</td>
<td>0.635201</td>
<td>0.068587</td>
<td>0.743524</td>
<td>-0.248617</td>
<td>1.000000</td>
<td>-0.760456</td>
<td>0.444960</td>
<td>0.508152</td>
<td>0.237848</td>
<td>-0.255566</td>
<td>0.615801</td>
</tr>
<tr>
<th>DIS</th>
<td>-0.365796</td>
<td>0.660710</td>
<td>-0.696408</td>
<td>-0.087921</td>
<td>-0.773083</td>
<td>0.193052</td>
<td>-0.760456</td>
<td>1.000000</td>
<td>-0.474487</td>
<td>-0.532434</td>
<td>-0.174499</td>
<td>0.262156</td>
<td>-0.516540</td>
</tr>
<tr>
<th>RAD</th>
<td>0.613971</td>
<td>-0.313989</td>
<td>0.578671</td>
<td>0.007005</td>
<td>0.628727</td>
<td>-0.174508</td>
<td>0.444960</td>
<td>-0.474487</td>
<td>1.000000</td>
<td>0.902384</td>
<td>0.443599</td>
<td>-0.436661</td>
<td>0.468507</td>
</tr>
<tr>
<th>TAX</th>
<td>0.567040</td>
<td>-0.327254</td>
<td>0.729234</td>
<td>-0.027192</td>
<td>0.686920</td>
<td>-0.272416</td>
<td>0.508152</td>
<td>-0.532434</td>
<td>0.902384</td>
<td>1.000000</td>
<td>0.449566</td>
<td>-0.427663</td>
<td>0.540966</td>
</tr>
<tr>
<th>PTRATIO</th>
<td>0.270841</td>
<td>-0.383914</td>
<td>0.377993</td>
<td>-0.092955</td>
<td>0.175481</td>
<td>-0.370481</td>
<td>0.237848</td>
<td>-0.174499</td>
<td>0.443599</td>
<td>0.449566</td>
<td>1.000000</td>
<td>-0.157012</td>
<td>0.383061</td>
</tr>
<tr>
<th>B</th>
<td>-0.300679</td>
<td>0.168671</td>
<td>-0.339950</td>
<td>0.075155</td>
<td>-0.376619</td>
<td>0.131769</td>
<td>-0.255566</td>
<td>0.262156</td>
<td>-0.436661</td>
<td>-0.427663</td>
<td>-0.157012</td>
<td>1.000000</td>
<td>-0.388120</td>
</tr>
<tr>
<th>LSTAT</th>
<td>0.454672</td>
<td>-0.428367</td>
<td>0.616902</td>
<td>-0.045924</td>
<td>0.599609</td>
<td>-0.612997</td>
<td>0.615801</td>
<td>-0.516540</td>
<td>0.468507</td>
<td>0.540966</td>
<td>0.383061</td>
<td>-0.388120</td>
<td>1.000000</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can observe a high correlation between some of the features - such as RAD and TAX (0.90). This weakens the reliability of the lasso and ridge regression approaches, and provides support for using an elastic net approach instead:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 style="text-align: center"><a name="elastic"></a>4. Elastic Net</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The <strong>Elastic Net</strong> acts as a hybrid between the lasso and the ridge approaches (Hastie et al, 2013), and so includes both an L<sub>1</sub> penaly (as in lasso regression) and L<sub>2</sub> penalty (as in ridge regression).</p>
<p>To implement this in Scikit-learn, we use <code>sklearn.linear_model.ElasticNet</code>, specifying:</p>
<ul>
<li><p><code>alpha</code>: if <code>alpha = 0</code>, elastic net becomes an Ordinary Least Squares regression. Otherwise, the higher <code>alpha</code>, the more high coefficient values will be penalised.</p>
</li>
<li><p><code>l1_ratio</code>: controls how the L<sub>1</sub> and L<sub>2</sub> penalties are combined. At its lowest possible value, <code>l1_ratio = 0</code> and the penalty is an L<sub>2</sub> penalty - i.e. ridge regression is performed. At its highest possible value, <code>l1_ratio = 1</code>, and the penalty is an L<sub>1</sub> penalty - i.e. lasso regression is performed.</p>
</li>
</ul>
<p>See the <a href="http://scikit-learn.org/stable/modules/generated/sklearn.linear_model.ElasticNet.html">documentation</a> for the precise objective function minimised.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [29]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">reg_elastic_net</span> <span class="o">=</span> <span class="n">linear_model</span><span class="o">.</span><span class="n">ElasticNet</span><span class="p">(</span><span class="n">alpha</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">l1_ratio</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">)</span>
<span class="n">reg_elastic_net</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt output_prompt">Out[29]:</div>
<div class="output_text output_subarea output_execute_result">
<pre>ElasticNet(alpha=1.0, copy_X=True, fit_intercept=True, l1_ratio=0.5,
      max_iter=1000, normalize=False, positive=False, precompute=False,
      random_state=None, selection='cyclic', tol=0.0001, warm_start=False)</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Coefficients, the intercept and predictions can all be found in the same way as with Ordinary Least Squares:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [30]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="k">print</span> <span class="s2">"Coefficients are: {0}"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">reg_elastic_net</span><span class="o">.</span><span class="n">coef_</span><span class="p">)</span>

<span class="k">print</span> <span class="s2">"Intercept is: {0}"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">reg_elastic_net</span><span class="o">.</span><span class="n">intercept_</span><span class="p">)</span>

<span class="k">print</span> <span class="s2">"Prediction for first house in test dataset: {0}"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">reg_elastic_net</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x_test</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">]))</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Coefficients are: [-0.07852654  0.05269712 -0.03077338  0.         -0.          0.86719889
  0.0125003  -0.80505201  0.225549   -0.01468779 -0.81006507  0.00746296
 -0.72784018]
Intercept is: 44.5332337382
Prediction for first house in test dataset: [ 24.2913771]
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 style="text-align: center">Cross-Validation</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Just as with ridge and lasso regression, there is a version of the elastic net with built-in CV (<a href="http://scikit-learn.org/stable/modules/generated/sklearn.linear_model.ElasticNetCV.html#sklearn.linear_model.ElasticNetCV"><code>sklearn.linear_model.ElasticNetCV</code></a>).</p>
<p>We can specify a NumPy array of <code>l1_ratio</code> (and allow <code>alphas</code> to be automatically set), or we can specify a NumPy array of <code>alphas</code> (and allow <code>l1_ratio</code> to be set at its default value of 0.5), or we can specify both:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [31]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">reg_elastic_net_CV</span> <span class="o">=</span> <span class="n">linear_model</span><span class="o">.</span><span class="n">ElasticNetCV</span><span class="p">(</span><span class="n">eps</span> <span class="o">=</span> <span class="bp">None</span><span class="p">,</span> <span class="n">n_alphas</span> <span class="o">=</span> <span class="bp">None</span><span class="p">,</span> 
                                               <span class="n">alphas</span><span class="o">=</span><span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">],</span> 
                                               <span class="n">l1_ratio</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">,</span> <span class="mf">0.99</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span>
                                               <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">reg_elastic_net_CV</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt output_prompt">Out[31]:</div>
<div class="output_text output_subarea output_execute_result">
<pre>ElasticNetCV(alphas=[0.1, 1.0, 10.0], copy_X=True, cv=5, eps=None,
       fit_intercept=True, l1_ratio=[0.1, 0.5, 0.7, 0.9, 0.95, 0.99, 1.0],
       max_iter=1000, n_alphas=None, n_jobs=1, normalize=False,
       positive=False, precompute='auto', random_state=None,
       selection='cyclic', tol=0.0001, verbose=0)</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The <a href="http://scikit-learn.org/stable/modules/generated/sklearn.linear_model.ElasticNetCV.html#sklearn.linear_model.ElasticNetCV">documentation</a> recommends choosing an array of <code>l1_ratio</code> that puts more values close to 1 than 0. If <code>cv=</code> is not specified, the default cross-validation technique is three-fold cross-validation.</p>
<p>Just as with the lasso regression, we can instead specify how the elastic net iteratively fits along a regularisation path. This path determines the alpha values tested for each <code>l1_ratio</code>. As with lasso regression, the length of the path is determined by <code>eps=</code> (default sets <code>alpha_min/alpha_max = 0.001</code>) and the number of alphas along the path <code>n_alphas=</code>.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Finding values is a similar process to lasso and ridge regression, only we now have both <code>alpha</code> and <code>l1_ratio</code> parameters. We can also find the grid of alphas used for fitting using <code>alphas_</code>:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [32]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="k">print</span> <span class="s2">"Alpha is: {0}"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">reg_elastic_net_CV</span><span class="o">.</span><span class="n">alpha_</span><span class="p">)</span>

<span class="k">print</span> <span class="s2">"Grid of alphas used is: {0}"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">reg_elastic_net_CV</span><span class="o">.</span><span class="n">alphas_</span><span class="p">)</span>

<span class="k">print</span> <span class="s2">"L1 ratio is: {0}"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">reg_elastic_net_CV</span><span class="o">.</span><span class="n">l1_ratio_</span><span class="p">)</span>

<span class="k">print</span> <span class="s2">"Coefficients are: {0}"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">reg_elastic_net_CV</span><span class="o">.</span><span class="n">coef_</span><span class="p">)</span>

<span class="k">print</span> <span class="s2">"Intercept is: {0}"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">reg_elastic_net_CV</span><span class="o">.</span><span class="n">intercept_</span><span class="p">)</span>

<span class="k">print</span> <span class="s2">"Prediction for first house in test dataset: {0}"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">reg_elastic_net_CV</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x_test</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">]))</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Alpha is: 0.1
Grid of alphas used is: [ 10.    1.    0.1]
L1 ratio is: 0.1
Coefficients are: [-0.10947316  0.0508356  -0.06540964  0.9277502  -0.37825384  2.8989429
 -0.01342516 -1.22314724  0.22274296 -0.01350569 -0.86103603  0.00898216
 -0.58464969]
Intercept is: 33.8812121016
Prediction for first house in test dataset: [ 24.84867817]
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Just as with lasso regression, we can create a coefficient path by simply replacing <code>lasso_path</code> with <code>enet_path</code>. Unlike with <code>lasso_path</code>, we need to specify a value for <code>l1_ratio</code>. A full comparison can be found in the <a href="http://scikit-learn.org/stable/auto_examples/linear_model/plot_lasso_coordinate_descent_path.html#example-linear-model-plot-lasso-coordinate-descent-path-py">documentation</a>.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 style="text-align: center">Further Reading</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The above was written using:</p>
<ul>
<li><a href="http://scikit-learn.org/stable/modules/linear_model.html">Scikit-learn guidance on Generalized Linear Models</a></li>
<li>Cassella, G., Fienberg, S. and Olkin, I., 2015. "An Introduction to Statistical Learning: with Applications in R". New York: Springer. Available online as a <a href="http://www-bcf.usc.edu/~gareth/ISL/index.html">pdf</a></li>
<li>Hastie, T., Tibshirani, R., Friedman, J., 2013. "The Elements of Statistical Learning: Data Mining, Inference, and Prediction". New York: Springer. Available online as a <a href="http://statweb.stanford.edu/~tibs/ElemStatLearn/">pdf</a></li>
</ul>
</div>
</div>
</div>
<script type="text/javascript">if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = '//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML';
    mathjaxscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: 'center'," +
        "    displayIndent: '0em'," +
        "    showMathMenu: true," +
        "    tex2jax: { " +
        "        inlineMath: [ ['$','$'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }" +
        "    } " +
        "}); ";
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
</script>

    </div>
  </div>
  <hr class="separator">
  <div class="col-md-8 col-md-offset-2">
  </div>
  </div>
<footer class="footer">
  <div class="container">
    <p class="text-center">
      Andrew Burnie, <a href="" target="_blank"></a> unless otherwise noted.
    </p>
    <div class="text-center">
      Generated by <a href="http://getpelican.com" target="_blank">Pelican</a> with the <a href="http://github.com/nairobilug/pelican-alchemy">alchemy</a> theme.
    </div>
  </div>
</footer> <!-- /.footer -->
  <script src="/theme/js/jquery.min.js"></script>
  <script src="/theme/js/bootstrap.min.js"></script>
</body> <!-- 42 -->

</html>