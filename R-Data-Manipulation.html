<!DOCTYPE html>
<html lang="en">

<head>
      <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="canonical" href="http://Andrew47.github.io/R-Data-Manipulation.html" />

    <title>  Andrew Burnie: Data Science Blog &mdash; Data Manipulation with R
</title>




    <link rel="stylesheet" href="/theme/css/style.css">

    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->


    <meta name="author" content="Andrew Burnie">
    <meta name="description" content="The following provides a guide to data manipulation in R using the packages data.table and dplyr, with base R being examined for comparison. The layout is based on the page 'Pandas Basics' to enable further comparison between R and Python. Index data.table or dplyr? Data Frames Procedures with Data Tables One Table Operations comparing dplyr with data.table and base R">
  <meta name="tags" contents="R, dplyr, data table, data frame, SQL, joins, data manipulation, ">
</head>

<body>
<header class="header">
  <div class="container">
    <div class="header-inner">
      <h1 class="header-name">
        <a class="nodec" href="http://Andrew47.github.io">Andrew Burnie: Data Science Blog</a>
      </h1>
      <h3 class="header-text"></h3>
      <ul class="header-menu list-inline">
              <li class="muted">|</li>
            <li><a class="nodec" href="http://Andrew47.github.io/pages/author.html">Author</a></li>
              <li class="muted">|</li>
          <li><a class="nodec" href="http://Andrew47.github.io/categories.html">Categories</a></li>
          <li class="muted">|</li>
          <li><a class="nodec" href="http://Andrew47.github.io/tags.html">Tags</a></li>
          <li class="muted">|</li>
          <li><a class="nodec icon-mail-alt" href="mailto:apburnie@hotmail.co.uk"></a></li>
          <li><a class="nodec icon-github" href="https://github.com/Andrew47"></a></li>
      </ul>
    </div>
  </div>
</header> <!-- /.header -->  <div class="container">
  <div class="post full-post">
    <h1 class="post-title">
      <a href="/R-Data-Manipulation.html" title="Permalink to Data Manipulation with R">Data Manipulation with R</a>
    </h1>
    <ul class="list-inline">
      <li class="post-date">
        <a class="text-muted" href="/R-Data-Manipulation.html" title="2016-08-27T15:30:00+01:00">Sat 27 August 2016</a>
      </li>
      <li class="muted">&middot;</li>
      <li class="post-category">
        <a href="/category/r.html">R</a>
      </li>
        <li class="muted">&middot;</li>
        <li>
            <a href="/tag/r.html">R</a>,             <a href="/tag/dplyr.html">dplyr</a>,             <a href="/tag/data-table.html">data table</a>,             <a href="/tag/data-frame.html">data frame</a>,             <a href="/tag/sql.html">SQL</a>,             <a href="/tag/joins.html">joins</a>,             <a href="/tag/data-manipulation.html">data manipulation</a>        </li>
    </ul>
    <div class="post-content">
      <style type="text/css">/*!
*
* IPython notebook
*
*/
/* CSS font colors for translated ANSI colors. */
.ansibold {
  font-weight: bold;
}
/* use dark versions for foreground, to improve visibility */
.ansiblack {
  color: black;
}
.ansired {
  color: darkred;
}
.ansigreen {
  color: darkgreen;
}
.ansiyellow {
  color: #c4a000;
}
.ansiblue {
  color: darkblue;
}
.ansipurple {
  color: darkviolet;
}
.ansicyan {
  color: steelblue;
}
.ansigray {
  color: gray;
}
/* and light for background, for the same reason */
.ansibgblack {
  background-color: black;
}
.ansibgred {
  background-color: red;
}
.ansibggreen {
  background-color: green;
}
.ansibgyellow {
  background-color: yellow;
}
.ansibgblue {
  background-color: blue;
}
.ansibgpurple {
  background-color: magenta;
}
.ansibgcyan {
  background-color: cyan;
}
.ansibggray {
  background-color: gray;
}
div.cell {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  border-radius: 2px;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
  border-width: 1px;
  border-style: solid;
  border-color: transparent;
  width: 100%;
  padding: 5px;
  /* This acts as a spacer between cells, that is outside the border */
  margin: 0px;
  outline: none;
  border-left-width: 1px;
  padding-left: 5px;
  background: linear-gradient(to right, transparent -40px, transparent 1px, transparent 1px, transparent 100%);
}
div.cell.jupyter-soft-selected {
  border-left-color: #90CAF9;
  border-left-color: #E3F2FD;
  border-left-width: 1px;
  padding-left: 5px;
  border-right-color: #E3F2FD;
  border-right-width: 1px;
  background: #E3F2FD;
}
@media print {
  div.cell.jupyter-soft-selected {
    border-color: transparent;
  }
}
div.cell.selected {
  border-color: #ababab;
  border-left-width: 0px;
  padding-left: 6px;
  background: linear-gradient(to right, #42A5F5 -40px, #42A5F5 5px, transparent 5px, transparent 100%);
}
@media print {
  div.cell.selected {
    border-color: transparent;
  }
}
div.cell.selected.jupyter-soft-selected {
  border-left-width: 0;
  padding-left: 6px;
  background: linear-gradient(to right, #42A5F5 -40px, #42A5F5 7px, #E3F2FD 7px, #E3F2FD 100%);
}
.edit_mode div.cell.selected {
  border-color: #66BB6A;
  border-left-width: 0px;
  padding-left: 6px;
  background: linear-gradient(to right, #66BB6A -40px, #66BB6A 5px, transparent 5px, transparent 100%);
}
@media print {
  .edit_mode div.cell.selected {
    border-color: transparent;
  }
}
.prompt {
  /* This needs to be wide enough for 3 digit prompt numbers: In[100]: */
  min-width: 14ex;
  /* This padding is tuned to match the padding on the CodeMirror editor. */
  padding: 0.4em;
  margin: 0px;
  font-family: monospace;
  text-align: right;
  /* This has to match that of the the CodeMirror class line-height below */
  line-height: 1.21429em;
  /* Don't highlight prompt number selection */
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  -khtml-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
  /* Use default cursor */
  cursor: default;
}
@media (max-width: 540px) {
  .prompt {
    text-align: left;
  }
}
div.inner_cell {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  /* Old browsers */
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  box-flex: 1;
  /* Modern browsers */
  flex: 1;
}
@-moz-document url-prefix() {
  div.inner_cell {
    overflow-x: hidden;
  }
}
/* input_area and input_prompt must match in top border and margin for alignment */
div.input_area {
  border: 1px solid #cfcfcf;
  border-radius: 2px;
  background: #f7f7f7;
  line-height: 1.21429em;
}
/* This is needed so that empty prompt areas can collapse to zero height when there
   is no content in the output_subarea and the prompt. The main purpose of this is
   to make sure that empty JavaScript output_subareas have no height. */
div.prompt:empty {
  padding-top: 0;
  padding-bottom: 0;
}
div.unrecognized_cell {
  padding: 5px 5px 5px 0px;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
div.unrecognized_cell .inner_cell {
  border-radius: 2px;
  padding: 5px;
  font-weight: bold;
  color: red;
  border: 1px solid #cfcfcf;
  background: #eaeaea;
}
div.unrecognized_cell .inner_cell a {
  color: inherit;
  text-decoration: none;
}
div.unrecognized_cell .inner_cell a:hover {
  color: inherit;
  text-decoration: none;
}
@media (max-width: 540px) {
  div.unrecognized_cell > div.prompt {
    display: none;
  }
}
div.code_cell {
  /* avoid page breaking on code cells when printing */
}
@media print {
  div.code_cell {
    page-break-inside: avoid;
  }
}
/* any special styling for code cells that are currently running goes here */
div.input {
  page-break-inside: avoid;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.input {
    /* Old browsers */
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-box-align: stretch;
    display: -moz-box;
    -moz-box-orient: vertical;
    -moz-box-align: stretch;
    display: box;
    box-orient: vertical;
    box-align: stretch;
    /* Modern browsers */
    display: flex;
    flex-direction: column;
    align-items: stretch;
  }
}
/* input_area and input_prompt must match in top border and margin for alignment */
div.input_prompt {
  color: #303F9F;
  border-top: 1px solid transparent;
}
div.input_area > div.highlight {
  margin: 0.4em;
  border: none;
  padding: 0px;
  background-color: transparent;
}
div.input_area > div.highlight > pre {
  margin: 0px;
  border: none;
  padding: 0px;
  background-color: transparent;
}
/* The following gets added to the <head> if it is detected that the user has a
 * monospace font with inconsistent normal/bold/italic height.  See
 * notebookmain.js.  Such fonts will have keywords vertically offset with
 * respect to the rest of the text.  The user should select a better font.
 * See: https://github.com/ipython/ipython/issues/1503
 *
 * .CodeMirror span {
 *      vertical-align: bottom;
 * }
 */
.CodeMirror {
  line-height: 1.21429em;
  /* Changed from 1em to our global default */
  font-size: 14px;
  height: auto;
  /* Changed to auto to autogrow */
  background: none;
  /* Changed from white to allow our bg to show through */
}
.CodeMirror-scroll {
  /*  The CodeMirror docs are a bit fuzzy on if overflow-y should be hidden or visible.*/
  /*  We have found that if it is visible, vertical scrollbars appear with font size changes.*/
  overflow-y: hidden;
  overflow-x: auto;
}
.CodeMirror-lines {
  /* In CM2, this used to be 0.4em, but in CM3 it went to 4px. We need the em value because */
  /* we have set a different line-height and want this to scale with that. */
  padding: 0.4em;
}
.CodeMirror-linenumber {
  padding: 0 8px 0 4px;
}
.CodeMirror-gutters {
  border-bottom-left-radius: 2px;
  border-top-left-radius: 2px;
}
.CodeMirror pre {
  /* In CM3 this went to 4px from 0 in CM2. We need the 0 value because of how we size */
  /* .CodeMirror-lines */
  padding: 0;
  border: 0;
  border-radius: 0;
}
/*

Original style from softwaremaniacs.org (c) Ivan Sagalaev <Maniac@SoftwareManiacs.Org>
Adapted from GitHub theme

*/
.highlight-base {
  color: #000;
}
.highlight-variable {
  color: #000;
}
.highlight-variable-2 {
  color: #1a1a1a;
}
.highlight-variable-3 {
  color: #333333;
}
.highlight-string {
  color: #BA2121;
}
.highlight-comment {
  color: #408080;
  font-style: italic;
}
.highlight-number {
  color: #080;
}
.highlight-atom {
  color: #88F;
}
.highlight-keyword {
  color: #008000;
  font-weight: bold;
}
.highlight-builtin {
  color: #008000;
}
.highlight-error {
  color: #f00;
}
.highlight-operator {
  color: #AA22FF;
  font-weight: bold;
}
.highlight-meta {
  color: #AA22FF;
}
/* previously not defined, copying from default codemirror */
.highlight-def {
  color: #00f;
}
.highlight-string-2 {
  color: #f50;
}
.highlight-qualifier {
  color: #555;
}
.highlight-bracket {
  color: #997;
}
.highlight-tag {
  color: #170;
}
.highlight-attribute {
  color: #00c;
}
.highlight-header {
  color: blue;
}
.highlight-quote {
  color: #090;
}
.highlight-link {
  color: #00c;
}
/* apply the same style to codemirror */
.cm-s-ipython span.cm-keyword {
  color: #008000;
  font-weight: bold;
}
.cm-s-ipython span.cm-atom {
  color: #88F;
}
.cm-s-ipython span.cm-number {
  color: #080;
}
.cm-s-ipython span.cm-def {
  color: #00f;
}
.cm-s-ipython span.cm-variable {
  color: #000;
}
.cm-s-ipython span.cm-operator {
  color: #AA22FF;
  font-weight: bold;
}
.cm-s-ipython span.cm-variable-2 {
  color: #1a1a1a;
}
.cm-s-ipython span.cm-variable-3 {
  color: #333333;
}
.cm-s-ipython span.cm-comment {
  color: #408080;
  font-style: italic;
}
.cm-s-ipython span.cm-string {
  color: #BA2121;
}
.cm-s-ipython span.cm-string-2 {
  color: #f50;
}
.cm-s-ipython span.cm-meta {
  color: #AA22FF;
}
.cm-s-ipython span.cm-qualifier {
  color: #555;
}
.cm-s-ipython span.cm-builtin {
  color: #008000;
}
.cm-s-ipython span.cm-bracket {
  color: #997;
}
.cm-s-ipython span.cm-tag {
  color: #170;
}
.cm-s-ipython span.cm-attribute {
  color: #00c;
}
.cm-s-ipython span.cm-header {
  color: blue;
}
.cm-s-ipython span.cm-quote {
  color: #090;
}
.cm-s-ipython span.cm-link {
  color: #00c;
}
.cm-s-ipython span.cm-error {
  color: #f00;
}
.cm-s-ipython span.cm-tab {
  background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAMCAYAAAAkuj5RAAAAAXNSR0IArs4c6QAAAGFJREFUSMft1LsRQFAQheHPowAKoACx3IgEKtaEHujDjORSgWTH/ZOdnZOcM/sgk/kFFWY0qV8foQwS4MKBCS3qR6ixBJvElOobYAtivseIE120FaowJPN75GMu8j/LfMwNjh4HUpwg4LUAAAAASUVORK5CYII=);
  background-position: right;
  background-repeat: no-repeat;
}
div.output_wrapper {
  /* this position must be relative to enable descendents to be absolute within it */
  position: relative;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  z-index: 1;
}
/* class for the output area when it should be height-limited */
div.output_scroll {
  /* ideally, this would be max-height, but FF barfs all over that */
  height: 24em;
  /* FF needs this *and the wrapper* to specify full width, or it will shrinkwrap */
  width: 100%;
  overflow: auto;
  border-radius: 2px;
  -webkit-box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8);
  box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8);
  display: block;
}
/* output div while it is collapsed */
div.output_collapsed {
  margin: 0px;
  padding: 0px;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
}
div.out_prompt_overlay {
  height: 100%;
  padding: 0px 0.4em;
  position: absolute;
  border-radius: 2px;
}
div.out_prompt_overlay:hover {
  /* use inner shadow to get border that is computed the same on WebKit/FF */
  -webkit-box-shadow: inset 0 0 1px #000;
  box-shadow: inset 0 0 1px #000;
  background: rgba(240, 240, 240, 0.5);
}
div.output_prompt {
  color: #D84315;
}
/* This class is the outer container of all output sections. */
div.output_area {
  padding: 0px;
  page-break-inside: avoid;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
div.output_area .MathJax_Display {
  text-align: left !important;
}
div.output_area 
div.output_area 
div.output_area img,
div.output_area svg {
  max-width: 100%;
  height: auto;
}
div.output_area img.unconfined,
div.output_area svg.unconfined {
  max-width: none;
}
/* This is needed to protect the pre formating from global settings such
   as that of bootstrap */
.output {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.output_area {
    /* Old browsers */
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-box-align: stretch;
    display: -moz-box;
    -moz-box-orient: vertical;
    -moz-box-align: stretch;
    display: box;
    box-orient: vertical;
    box-align: stretch;
    /* Modern browsers */
    display: flex;
    flex-direction: column;
    align-items: stretch;
  }
}
div.output_area pre {
  margin: 0;
  padding: 0;
  border: 0;
  vertical-align: baseline;
  color: black;
  background-color: transparent;
  border-radius: 0;
}
/* This class is for the output subarea inside the output_area and after
   the prompt div. */
div.output_subarea {
  overflow-x: auto;
  padding: 0.4em;
  /* Old browsers */
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  box-flex: 1;
  /* Modern browsers */
  flex: 1;
  max-width: calc(100% - 14ex);
}
div.output_scroll div.output_subarea {
  overflow-x: visible;
}
/* The rest of the output_* classes are for special styling of the different
   output types */
/* all text output has this class: */
div.output_text {
  text-align: left;
  color: #000;
  /* This has to match that of the the CodeMirror class line-height below */
  line-height: 1.21429em;
}
/* stdout/stderr are 'text' as well as 'stream', but execute_result/error are *not* streams */
div.output_stderr {
  background: #fdd;
  /* very light red background for stderr */
}
div.output_latex {
  text-align: left;
}
/* Empty output_javascript divs should have no height */
div.output_javascript:empty {
  padding: 0;
}
.js-error {
  color: darkred;
}
/* raw_input styles */
div.raw_input_container {
  line-height: 1.21429em;
  padding-top: 5px;
}
pre.raw_input_prompt {
  /* nothing needed here. */
}
input.raw_input {
  font-family: monospace;
  font-size: inherit;
  color: inherit;
  width: auto;
  /* make sure input baseline aligns with prompt */
  vertical-align: baseline;
  /* padding + margin = 0.5em between prompt and cursor */
  padding: 0em 0.25em;
  margin: 0em 0.25em;
}
input.raw_input:focus {
  box-shadow: none;
}
p.p-space {
  margin-bottom: 10px;
}
div.output_unrecognized {
  padding: 5px;
  font-weight: bold;
  color: red;
}
div.output_unrecognized a {
  color: inherit;
  text-decoration: none;
}
div.output_unrecognized a:hover {
  color: inherit;
  text-decoration: none;
}
.rendered_html {
  color: #000;
  /* any extras will just be numbers: */
}



.rendered_html :link {
  text-decoration: underline;
}
.rendered_html :visited {
  text-decoration: underline;
}






.rendered_html h1:first-child {
  margin-top: 0.538em;
}
.rendered_html h2:first-child {
  margin-top: 0.636em;
}
.rendered_html h3:first-child {
  margin-top: 0.777em;
}
.rendered_html h4:first-child {
  margin-top: 1em;
}
.rendered_html h5:first-child {
  margin-top: 1em;
}
.rendered_html h6:first-child {
  margin-top: 1em;
}








.rendered_html * + ul {
  margin-top: 1em;
}
.rendered_html * + ol {
  margin-top: 1em;
}


.rendered_html pre,



.rendered_html tr,
.rendered_html th,

.rendered_html td,


.rendered_html * + table {
  margin-top: 1em;
}

.rendered_html * + p {
  margin-top: 1em;
}

.rendered_html * + img {
  margin-top: 1em;
}
.rendered_html img,

.rendered_html img.unconfined,

div.text_cell {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.text_cell > div.prompt {
    display: none;
  }
}
div.text_cell_render {
  /*font-family: "Helvetica Neue", Arial, Helvetica, Geneva, sans-serif;*/
  outline: none;
  resize: none;
  width: inherit;
  border-style: none;
  padding: 0.5em 0.5em 0.5em 0.4em;
  color: #000;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
}
a.anchor-link:link {
  text-decoration: none;
  padding: 0px 20px;
  visibility: hidden;
}
h1:hover .anchor-link,
h2:hover .anchor-link,
h3:hover .anchor-link,
h4:hover .anchor-link,
h5:hover .anchor-link,
h6:hover .anchor-link {
  visibility: visible;
}
.text_cell.rendered .input_area {
  display: none;
}
.text_cell.rendered 
.text_cell.unrendered .text_cell_render {
  display: none;
}
.cm-header-1,
.cm-header-2,
.cm-header-3,
.cm-header-4,
.cm-header-5,
.cm-header-6 {
  font-weight: bold;
  font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
}
.cm-header-1 {
  font-size: 185.7%;
}
.cm-header-2 {
  font-size: 157.1%;
}
.cm-header-3 {
  font-size: 128.6%;
}
.cm-header-4 {
  font-size: 110%;
}
.cm-header-5 {
  font-size: 100%;
  font-style: italic;
}
.cm-header-6 {
  font-size: 100%;
  font-style: italic;
}
</style>
<style type="text/css">.highlight .hll { background-color: #ffffcc }
.highlight  { background: #f8f8f8; }
.highlight .c { color: #408080; font-style: italic } /* Comment */
.highlight .err { border: 1px solid #FF0000 } /* Error */
.highlight .k { color: #008000; font-weight: bold } /* Keyword */
.highlight .o { color: #666666 } /* Operator */
.highlight .ch { color: #408080; font-style: italic } /* Comment.Hashbang */
.highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */
.highlight .cp { color: #BC7A00 } /* Comment.Preproc */
.highlight .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */
.highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */
.highlight .cs { color: #408080; font-style: italic } /* Comment.Special */
.highlight .gd { color: #A00000 } /* Generic.Deleted */
.highlight .ge { font-style: italic } /* Generic.Emph */
.highlight .gr { color: #FF0000 } /* Generic.Error */
.highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.highlight .gi { color: #00A000 } /* Generic.Inserted */
.highlight .go { color: #888888 } /* Generic.Output */
.highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.highlight .gs { font-weight: bold } /* Generic.Strong */
.highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.highlight .gt { color: #0044DD } /* Generic.Traceback */
.highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: #008000 } /* Keyword.Pseudo */
.highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.highlight .kt { color: #B00040 } /* Keyword.Type */
.highlight .m { color: #666666 } /* Literal.Number */
.highlight .s { color: #BA2121 } /* Literal.String */
.highlight .na { color: #7D9029 } /* Name.Attribute */
.highlight .nb { color: #008000 } /* Name.Builtin */
.highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.highlight .no { color: #880000 } /* Name.Constant */
.highlight .nd { color: #AA22FF } /* Name.Decorator */
.highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */
.highlight .ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.highlight .nf { color: #0000FF } /* Name.Function */
.highlight .nl { color: #A0A000 } /* Name.Label */
.highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */
.highlight .nv { color: #19177C } /* Name.Variable */
.highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.highlight .w { color: #bbbbbb } /* Text.Whitespace */
.highlight .mb { color: #666666 } /* Literal.Number.Bin */
.highlight .mf { color: #666666 } /* Literal.Number.Float */
.highlight .mh { color: #666666 } /* Literal.Number.Hex */
.highlight .mi { color: #666666 } /* Literal.Number.Integer */
.highlight .mo { color: #666666 } /* Literal.Number.Oct */
.highlight .sb { color: #BA2121 } /* Literal.String.Backtick */
.highlight .sc { color: #BA2121 } /* Literal.String.Char */
.highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.highlight .s2 { color: #BA2121 } /* Literal.String.Double */
.highlight .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */
.highlight .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.highlight .sx { color: #008000 } /* Literal.String.Other */
.highlight .sr { color: #BB6688 } /* Literal.String.Regex */
.highlight .s1 { color: #BA2121 } /* Literal.String.Single */
.highlight .ss { color: #19177C } /* Literal.String.Symbol */
.highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */
.highlight .vc { color: #19177C } /* Name.Variable.Class */
.highlight .vg { color: #19177C } /* Name.Variable.Global */
.highlight .vi { color: #19177C } /* Name.Variable.Instance */
.highlight .il { color: #666666 } /* Literal.Number.Integer.Long */</style>
<style type="text/css">
/* Temporary definitions which will become obsolete with Notebook release 5.0 */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-bold { font-weight: bold; }
</style>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The following provides a guide to data manipulation in R using the packages <code>data.table</code> and <code>dplyr</code>, with base R being examined for comparison. The layout is based on the page <a href="https://andrew47.github.io/pages/pandas-dm.html">'Pandas Basics'</a> to enable further comparison between R and Python.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 style="text-align: center">Index</h2><ul>
<li><a href="#Comparison">data.table or dplyr?</a></li>
<li><a href="#DFvsDT">Data Frames Procedures with Data Tables</a></li>
<li><a href="#OneTableOper">One Table Operations comparing dplyr with data.table and base R</a></li>
<li><a href="#Joins">Joins: base R vs dplyr vs data tables</a></li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 style="text-align: center">Requiring the dplyr and data.table packages</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>First, we require both the <code>dplyr</code> and <code>data.table</code> libraries:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [5]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-r"><pre><span></span><span class="kn">library</span><span class="p">(</span><span class="s">"dplyr"</span><span class="p">)</span>
<span class="kn">library</span><span class="p">(</span><span class="s">"data.table"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 style="text-align: center"><a href="Comparison"></a>data.table or dplyr?</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li><code>dplyr</code> uses simpler syntax, insulates against accidental modification (as dataset has to be overwritten to make changes permanent), and can be applied to a <a href="https://www.quora.com/Which-is-better-to-use-for-data-manipulation-dplyr-package-or-data-table-library">variety of data objects</a> - including data frames, data tables and different remote database management systems.</li>
</ul>
<ul>
<li><code>data.table</code> uses <a href="http://stackoverflow.com/questions/21435339/data-table-vs-dplyr-can-one-do-something-well-the-other-cant-or-does-poorly">very concise syntax</a>, and is even <a href="https://www.r-statistics.com/2013/09/a-speed-test-comparison-of-plyr-data-table-and-dplyr/">faster</a> than <code>dplyr</code>, but is less flexible and arguably less readable. Some claim <code>data.table</code> to be the <a href="https://www.quora.com/Which-is-better-to-use-for-data-manipulation-dplyr-package-or-data-table-library">fastest data open source manipulation tool for data fit in memory</a>.</li>
</ul>
<ul>
<li>Both the <code>dplyr</code> and <code>data.table</code> functions are seen as <a href="https://www.quora.com/Which-is-better-to-use-for-data-manipulation-dplyr-package-or-data-table-library">faster</a> than their base R equivalents. <code>dplyr</code> also tends to have a simpler, more readable syntax.</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 style="text-align: center">Comparing Speed of data.table with dplyr</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>First, some base R, <code>data.table</code> and <code>dplyr</code> code is provided to give the reader an initial idea as to how the syntax differs. We also run a test to illustrate how the differences in speed become significant as the datasets increase in size.</p>
<p>In the below we perform an inner join followed by creating a new column as a function of two others. We do this using  base R, <code>dplyr</code> and <code>data.table</code>, so as to compare the packages. We examine how varying the number of rows (from 100 to 10000) in the dataset alters the gap in speed:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [6]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-r"><pre><span></span><span class="c1">#Code behind the subsequent graph:</span>

<span class="c1">#All the syntax used is explained in the subsequent sections</span>
<span class="c1">#See website's section on ggplot2 for data visualisation guidance</span>

row.numbers <span class="o">=</span> <span class="kc">NULL</span>
base.times <span class="o">=</span> <span class="kc">NULL</span>
dplyr.times <span class="o">=</span> <span class="kc">NULL</span>
data.table.times <span class="o">=</span> <span class="kc">NULL</span>
i <span class="o">=</span> <span class="m">1</span>

<span class="kr">for</span> <span class="p">(</span>rows <span class="kr">in</span> <span class="kp">seq</span><span class="p">(</span><span class="m">100</span><span class="p">,</span> <span class="m">10000</span><span class="p">,</span> by<span class="o">=</span><span class="m">100</span><span class="p">))</span> <span class="p">{</span>

  row.numbers<span class="p">[</span>i<span class="p">]</span> <span class="o"><-</span> rows

  DF_1 <span class="o"><-</span> <span class="kt">data.frame</span><span class="p">(</span>V0 <span class="o">=</span> <span class="m">1</span><span class="o">:</span>rows<span class="p">,</span> V1 <span class="o">=</span> <span class="kp">rep</span><span class="p">(</span><span class="m">5</span><span class="p">,</span> rows<span class="p">),</span> V2 <span class="o">=</span> <span class="kp">rep</span><span class="p">(</span><span class="m">6</span><span class="p">,</span>rows<span class="p">))</span>
  DF_2 <span class="o"><-</span> <span class="kt">data.frame</span><span class="p">(</span>V0 <span class="o">=</span> <span class="m">1</span><span class="o">:</span>rows<span class="p">,</span> V3 <span class="o">=</span> <span class="kp">rep</span><span class="p">(</span><span class="m">7</span><span class="p">,</span> rows<span class="p">),</span> V4 <span class="o">=</span> <span class="kp">rep</span><span class="p">(</span><span class="m">8</span><span class="p">,</span>rows<span class="p">))</span>
    
  DF_1a <span class="o"><-</span> DF_1
  DF_2a <span class="o"><-</span> DF_2

  DT_1 <span class="o"><-</span> data.table<span class="p">(</span>V0 <span class="o">=</span> <span class="m">1</span><span class="o">:</span>rows<span class="p">,</span> V1 <span class="o">=</span> <span class="kp">rep</span><span class="p">(</span><span class="m">5</span><span class="p">,</span> rows<span class="p">),</span> V2 <span class="o">=</span> <span class="kp">rep</span><span class="p">(</span><span class="m">6</span><span class="p">,</span>rows<span class="p">))</span>
  DT_2 <span class="o"><-</span> data.table<span class="p">(</span>V0 <span class="o">=</span> <span class="m">1</span><span class="o">:</span>rows<span class="p">,</span> V3 <span class="o">=</span> <span class="kp">rep</span><span class="p">(</span><span class="m">7</span><span class="p">,</span> rows<span class="p">),</span> V4 <span class="o">=</span> <span class="kp">rep</span><span class="p">(</span><span class="m">8</span><span class="p">,</span>rows<span class="p">))</span>

<span class="c1">#base R</span>
  start <span class="o"><-</span> <span class="kp">Sys.time</span><span class="p">()</span>
    
  DF_1a <span class="o"><-</span> <span class="kp">merge</span><span class="p">(</span>DF_1a<span class="p">,</span> DF_2a<span class="p">,</span> by <span class="o">=</span> <span class="s">"V0"</span><span class="p">,</span> all<span class="o">=</span><span class="kc">FALSE</span><span class="p">)</span>
  
  <span class="kp">transform</span><span class="p">(</span>DF_1a<span class="p">,</span> sum <span class="o">=</span> V1<span class="o">+</span>V2<span class="p">)</span>
  
  base.times<span class="p">[</span>i<span class="p">]</span> <span class="o"><-</span> <span class="p">(</span><span class="kp">Sys.time</span><span class="p">()</span> <span class="o">-</span> start<span class="p">)</span>

<span class="c1">#dplyr way</span>
  start <span class="o">=</span> <span class="kp">Sys.time</span><span class="p">()</span>

  DF_1 <span class="o">=</span> DF_1 <span class="o">%>%</span> inner_join<span class="p">(</span>DF_2<span class="p">,</span> by<span class="o">=</span><span class="s">"V0"</span><span class="p">)</span> <span class="o">%>%</span> mutate<span class="p">(</span>sum <span class="o">=</span> V1<span class="o">+</span>V2<span class="p">)</span>

  dplyr.times<span class="p">[</span>i<span class="p">]</span> <span class="o"><-</span> <span class="p">(</span><span class="kp">Sys.time</span><span class="p">()</span> <span class="o">-</span> start<span class="p">)</span>

<span class="c1">#data table way</span>
  start <span class="o">=</span> <span class="kp">Sys.time</span><span class="p">()</span>

  setkey<span class="p">(</span>DT_1<span class="p">,</span> <span class="s">"V0"</span><span class="p">)</span>
  setkey<span class="p">(</span>DT_2<span class="p">,</span> <span class="s">"V0"</span><span class="p">)</span>

  DT_1<span class="p">[</span>DT_2<span class="p">,</span> nomatch <span class="o">=</span> <span class="m">0</span><span class="p">][,</span>sum <span class="o">:=</span> V1 <span class="o">+</span> V2<span class="p">]</span>

  data.table.times<span class="p">[</span>i<span class="p">]</span> <span class="o"><-</span> <span class="kp">Sys.time</span><span class="p">()</span> <span class="o">-</span> start

<span class="c1">#Update index    </span>
  i <span class="o">=</span> i <span class="o">+</span> <span class="m">1</span>
    
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The graph comparing relative speed:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [64]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-r"><pre><span></span><span class="kn">library</span><span class="p">(</span>ggplot2<span class="p">)</span>

plot <span class="o"><-</span> ggplot<span class="p">()</span> <span class="o">+</span> geom_line<span class="p">(</span>aes<span class="p">(</span>x <span class="o">=</span> row.numbers<span class="p">,</span> y <span class="o">=</span> dplyr.times<span class="p">,</span> color <span class="o">=</span> <span class="s">"dplyr"</span><span class="p">))</span> <span class="o">+</span>  
                   geom_line<span class="p">(</span>aes<span class="p">(</span>x <span class="o">=</span> row.numbers<span class="p">,</span> y <span class="o">=</span> data.table.times<span class="p">,</span> color <span class="o">=</span> <span class="s">"data.table"</span><span class="p">))</span> <span class="o">+</span>
                   geom_line<span class="p">(</span>aes<span class="p">(</span>x <span class="o">=</span> row.numbers<span class="p">,</span> y <span class="o">=</span> base.times<span class="p">,</span> color <span class="o">=</span> <span class="s">"base R"</span><span class="p">))</span> <span class="o">+</span>
        labs <span class="p">(</span>x <span class="o">=</span> <span class="s">"Number of Rows in Dataset"</span><span class="p">,</span>
              y <span class="o">=</span> <span class="s">"Time in Seconds"</span><span class="p">,</span>
              color <span class="o">=</span> <span class="s">""</span><span class="p">)</span>


plot
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
AABJRU5ErkJggg==">
</img></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This simplistic test illustrates how the speed advantage of <code>data.table</code> and <code>dplyr</code> becomes significant mainly for larger datasets. There is also some support for <code>data.table</code> being slightly faster than <code>dplyr</code>  - particularly observed as the number of rows exceeds 5000. However, <code>dplyr</code> also seems to have a more consistent performance; there are spikes of very slow speeds for <code>data.table</code>.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 style="text-align: center"><a name="DFvsDT"></a>Data Frames Procedures with Data Tables</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>dplyr</code> can work directly with data frames. The functions in library <code>data.table</code> work with data tables.</p>
<p>We can create a data frame through using the <code>data.frame()</code> function, which is similar to the <code>DataFrame</code> used in pandas. Note that we need to use <code>c()</code> to form a list:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [8]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-r"><pre><span></span>data <span class="o"><-</span> <span class="kt">data.frame</span><span class="p">(</span>color <span class="o">=</span> <span class="kt">c</span><span class="p">(</span><span class="s">"blue"</span><span class="p">,</span> <span class="s">"green"</span><span class="p">,</span> <span class="s">"yellow"</span><span class="p">,</span> <span class="s">"red"</span><span class="p">,</span> <span class="s">"white"</span><span class="p">),</span>
                  object <span class="o">=</span> <span class="kt">c</span><span class="p">(</span><span class="s">"ball"</span><span class="p">,</span> <span class="s">"pen"</span><span class="p">,</span> <span class="s">"pencil"</span><span class="p">,</span> <span class="s">"paper"</span><span class="p">,</span> <span class="s">"mug"</span><span class="p">),</span>
                  price <span class="o">=</span> <span class="kt">c</span><span class="p">(</span><span class="m">1.2</span><span class="p">,</span> <span class="m">1.0</span><span class="p">,</span> <span class="m">0.6</span><span class="p">,</span> <span class="m">0.9</span><span class="p">,</span> <span class="m">1.7</span><span class="p">))</span>
data
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_html rendered_html output_subarea ">
<table>
<thead><tr><th></th><th scope="col">color</th><th scope="col">object</th><th scope="col">price</th></tr></thead>
<tbody>
<tr><th scope="row">1</th><td>blue</td><td>ball</td><td>1.2 </td></tr>
<tr><th scope="row">2</th><td>green</td><td>pen  </td><td>1    </td></tr>
<tr><th scope="row">3</th><td>yellow</td><td>pencil</td><td>0.6   </td></tr>
<tr><th scope="row">4</th><td>red  </td><td>paper</td><td>0.9  </td></tr>
<tr><th scope="row">5</th><td>white</td><td>mug  </td><td>1.7  </td></tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Note that, unlike with Python, lists in R start at 1 not 0.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can create data tables directly or through converting a data frame:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [9]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-r"><pre><span></span><span class="c1">#Converting a data frame:</span>
  data.table.1 <span class="o"><-</span> data.table<span class="p">(</span>data<span class="p">)</span>

<span class="c1">#Directly:</span>
  data.table.1 <span class="o"><-</span> data.table<span class="p">(</span>color <span class="o">=</span> <span class="kt">c</span><span class="p">(</span><span class="s">"blue"</span><span class="p">,</span> <span class="s">"green"</span><span class="p">,</span> <span class="s">"yellow"</span><span class="p">,</span> <span class="s">"red"</span><span class="p">,</span> <span class="s">"white"</span><span class="p">),</span>
                  object <span class="o">=</span> <span class="kt">c</span><span class="p">(</span><span class="s">"ball"</span><span class="p">,</span> <span class="s">"pen"</span><span class="p">,</span> <span class="s">"pencil"</span><span class="p">,</span> <span class="s">"paper"</span><span class="p">,</span> <span class="s">"mug"</span><span class="p">),</span>
                  price <span class="o">=</span> <span class="kt">c</span><span class="p">(</span><span class="m">1.2</span><span class="p">,</span> <span class="m">1.0</span><span class="p">,</span> <span class="m">0.6</span><span class="p">,</span> <span class="m">0.9</span><span class="p">,</span> <span class="m">1.7</span><span class="p">))</span>

data.table.1
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_html rendered_html output_subarea ">
<table>
<thead><tr><th></th><th scope="col">color</th><th scope="col">object</th><th scope="col">price</th></tr></thead>
<tbody>
<tr><th scope="row">1</th><td>blue</td><td>ball</td><td>1.2 </td></tr>
<tr><th scope="row">2</th><td>green</td><td>pen  </td><td>1    </td></tr>
<tr><th scope="row">3</th><td>yellow</td><td>pencil</td><td>0.6   </td></tr>
<tr><th scope="row">4</th><td>red  </td><td>paper</td><td>0.9  </td></tr>
<tr><th scope="row">5</th><td>white</td><td>mug  </td><td>1.7  </td></tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can also convert the data table back into a data frame using <code>data.frame(data.table)</code></p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can also label the rows of our <strong>data frame</strong>:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [10]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-r"><pre><span></span>data <span class="o"><-</span> <span class="kt">data.frame</span><span class="p">(</span>data<span class="p">,</span> row.names <span class="o">=</span> <span class="kc">letters</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">5</span><span class="p">])</span>
data
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_html rendered_html output_subarea ">
<table>
<thead><tr><th></th><th scope="col">color</th><th scope="col">object</th><th scope="col">price</th></tr></thead>
<tbody>
<tr><th scope="row">a</th><td>blue</td><td>ball</td><td>1.2 </td></tr>
<tr><th scope="row">b</th><td>green</td><td>pen  </td><td>1    </td></tr>
<tr><th scope="row">c</th><td>yellow</td><td>pencil</td><td>0.6   </td></tr>
<tr><th scope="row">d</th><td>red  </td><td>paper</td><td>0.9  </td></tr>
<tr><th scope="row">e</th><td>white</td><td>mug  </td><td>1.7  </td></tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This cannot be so easily done with data tables.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 style="text-align: center"><a name="DataFrame"></a>Data Frames: Selecting Values</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>If we want a specific column outputted as a list, then we use <code>data.frame$column.name</code>. The same applies for data tables:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [11]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-r"><pre><span></span>data.table.1<span class="o">$</span>price
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_html rendered_html output_subarea ">
<ol class="list-inline">
<li>1.2</li>
<li>1</li>
<li>0.6</li>
<li>0.9</li>
<li>1.7</li>
</ol>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>If we want a column of the <strong>data frame</strong> outputted as another data frame. This syntax cannot be used for <strong>data tables</strong>:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [12]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-r"><pre><span></span>data<span class="p">[</span><span class="s">"price"</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_html rendered_html output_subarea ">
<table>
<thead><tr><th></th><th scope="col">price</th></tr></thead>
<tbody>
<tr><th scope="row">a</th><td>1.2</td></tr>
<tr><th scope="row">b</th><td>1</td></tr>
<tr><th scope="row">c</th><td>0.6</td></tr>
<tr><th scope="row">d</th><td>0.9</td></tr>
<tr><th scope="row">e</th><td>1.7</td></tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>With <strong>data frames</strong>, using number indices will, by default return <strong>columns</strong> not rows:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [13]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-r"><pre><span></span>data<span class="p">[</span><span class="m">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_html rendered_html output_subarea ">
<table>
<thead><tr><th></th><th scope="col">color</th></tr></thead>
<tbody>
<tr><th scope="row">a</th><td>blue</td></tr>
<tr><th scope="row">b</th><td>green</td></tr>
<tr><th scope="row">c</th><td>yellow</td></tr>
<tr><th scope="row">d</th><td>red</td></tr>
<tr><th scope="row">e</th><td>white</td></tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>To extract specific subsets of a <strong>data frame</strong>, we use <code>[number1,number2]</code>, where <code>number1</code> refers to rows, and <code>number2</code> to columns. Suppose we wanted the price for the first and second rows. The following are equivalent:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [14]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-r"><pre><span></span><span class="c1">#Using indexes:</span>
 data<span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">2</span><span class="p">,</span><span class="m">3</span><span class="p">]</span>

<span class="c1">#Using labels:</span>
 data<span class="p">[</span><span class="kt">c</span><span class="p">(</span><span class="s">"a"</span><span class="p">,</span><span class="s">"b"</span><span class="p">),</span> <span class="s">"price"</span><span class="p">]</span>

<span class="c1">#Using some mix:</span>
 data<span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">2</span><span class="p">,</span> <span class="s">"price"</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_html rendered_html output_subarea ">
<ol class="list-inline">
<li>1.2</li>
<li>1</li>
</ol>
</div>
</div>
<div class="output_area"><div class="prompt"></div>
<div class="output_html rendered_html output_subarea ">
<ol class="list-inline">
<li>1.2</li>
<li>1</li>
</ol>
</div>
</div>
<div class="output_area"><div class="prompt"></div>
<div class="output_html rendered_html output_subarea ">
<ol class="list-inline">
<li>1.2</li>
<li>1</li>
</ol>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>To extract specific rows, we must insert <code>,</code>. Otherwise, the associated column will be returned:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [15]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-r"><pre><span></span>data<span class="p">[</span><span class="m">1</span><span class="p">,]</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_html rendered_html output_subarea ">
<table>
<thead><tr><th></th><th scope="col">color</th><th scope="col">object</th><th scope="col">price</th></tr></thead>
<tbody>
<tr><th scope="row">a</th><td>blue</td><td>ball</td><td>1.2 </td></tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 style="text-align: center"><a name="DataTable"></a>Data Tables: Selecting Values</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>With <strong>data tables</strong>, using number indices will, by default, return <strong>rows</strong>:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [16]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-r"><pre><span></span>data.table.1<span class="p">[</span><span class="m">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_html rendered_html output_subarea ">
<table>
<thead><tr><th></th><th scope="col">color</th><th scope="col">object</th><th scope="col">price</th></tr></thead>
<tbody>
<tr><th scope="row">1</th><td>blue</td><td>ball</td><td>1.2 </td></tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>To return <strong>columns</strong>, we include <code>with = FALSE</code>:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [17]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-r"><pre><span></span>data.table.1<span class="p">[,</span><span class="s">"color"</span><span class="p">,</span> with <span class="o">=</span> <span class="kc">FALSE</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_html rendered_html output_subarea ">
<table>
<thead><tr><th></th><th scope="col">color</th></tr></thead>
<tbody>
<tr><th scope="row">1</th><td>blue</td></tr>
<tr><th scope="row">2</th><td>green</td></tr>
<tr><th scope="row">3</th><td>yellow</td></tr>
<tr><th scope="row">4</th><td>red</td></tr>
<tr><th scope="row">5</th><td>white</td></tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Note that we can use column labels rather than indices.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>To retrieve a specific subset of the data table:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [18]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-r"><pre><span></span>data.table.1<span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">3</span><span class="p">,</span> <span class="s">"color"</span><span class="p">,</span> with <span class="o">=</span> <span class="kc">FALSE</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_html rendered_html output_subarea ">
<table>
<thead><tr><th></th><th scope="col">color</th></tr></thead>
<tbody>
<tr><th scope="row">1</th><td>blue</td></tr>
<tr><th scope="row">2</th><td>green</td></tr>
<tr><th scope="row">3</th><td>yellow</td></tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 style="text-align: center">Data Frames: Creating/Updating/Deleting Data</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can add/update a column as follows:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [19]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-r"><pre><span></span>data<span class="o">$</span>location <span class="o"><-</span> <span class="kt">c</span><span class="p">(</span><span class="s">"London"</span><span class="p">,</span> <span class="s">"New York"</span><span class="p">,</span> <span class="s">"Hong Kong"</span><span class="p">,</span> <span class="s">"Singapore"</span><span class="p">,</span> <span class="s">"Paris"</span><span class="p">)</span>

<span class="c1">#could have used data['location'] instead</span>

data
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_html rendered_html output_subarea ">
<table>
<thead><tr><th></th><th scope="col">color</th><th scope="col">object</th><th scope="col">price</th><th scope="col">location</th></tr></thead>
<tbody>
<tr><th scope="row">a</th><td>blue  </td><td>ball  </td><td>1.2   </td><td>London</td></tr>
<tr><th scope="row">b</th><td>green   </td><td>pen     </td><td>1       </td><td>New York</td></tr>
<tr><th scope="row">c</th><td>yellow   </td><td>pencil   </td><td>0.6      </td><td>Hong Kong</td></tr>
<tr><th scope="row">d</th><td>red      </td><td>paper    </td><td>0.9      </td><td>Singapore</td></tr>
<tr><th scope="row">e</th><td>white</td><td>mug  </td><td>1.7  </td><td>Paris</td></tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Alternatively we can add/update a row:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [20]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-r"><pre><span></span>data<span class="p">[</span><span class="s">"f"</span><span class="p">,]</span> <span class="o"><-</span> <span class="kt">c</span><span class="p">(</span><span class="s">"white"</span><span class="p">,</span> <span class="s">"pen"</span><span class="p">,</span> <span class="m">2</span><span class="p">,</span> <span class="s">"Rome"</span><span class="p">)</span>

data
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_html rendered_html output_subarea ">
<table>
<thead><tr><th></th><th scope="col">color</th><th scope="col">object</th><th scope="col">price</th><th scope="col">location</th></tr></thead>
<tbody>
<tr><th scope="row">a</th><td>blue  </td><td>ball  </td><td>1.2   </td><td>London</td></tr>
<tr><th scope="row">b</th><td>green   </td><td>pen     </td><td>1       </td><td>New York</td></tr>
<tr><th scope="row">c</th><td>yellow   </td><td>pencil   </td><td>0.6      </td><td>Hong Kong</td></tr>
<tr><th scope="row">d</th><td>red      </td><td>paper    </td><td>0.9      </td><td>Singapore</td></tr>
<tr><th scope="row">e</th><td>white</td><td>mug  </td><td>1.7  </td><td>Paris</td></tr>
<tr><th scope="row">f</th><td>white</td><td>pen  </td><td>2    </td><td>Rome </td></tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can delete a column using '<code>-</code>' the index. To change the state of <code>data</code>, we must overwrite it:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [21]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-r"><pre><span></span>data <span class="o"><-</span> data<span class="p">[,</span><span class="m">-4</span><span class="p">]</span>

data
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_html rendered_html output_subarea ">
<table>
<thead><tr><th></th><th scope="col">color</th><th scope="col">object</th><th scope="col">price</th></tr></thead>
<tbody>
<tr><th scope="row">a</th><td>blue</td><td>ball</td><td>1.2 </td></tr>
<tr><th scope="row">b</th><td>green</td><td>pen  </td><td>1    </td></tr>
<tr><th scope="row">c</th><td>yellow</td><td>pencil</td><td>0.6   </td></tr>
<tr><th scope="row">d</th><td>red  </td><td>paper</td><td>0.9  </td></tr>
<tr><th scope="row">e</th><td>white</td><td>mug  </td><td>1.7  </td></tr>
<tr><th scope="row">f</th><td>white</td><td>pen  </td><td>2    </td></tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Similarly, with rows:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [22]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-r"><pre><span></span>data <span class="o"><-</span> data<span class="p">[</span><span class="m">-6</span><span class="p">,]</span>

data
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_html rendered_html output_subarea ">
<table>
<thead><tr><th></th><th scope="col">color</th><th scope="col">object</th><th scope="col">price</th></tr></thead>
<tbody>
<tr><th scope="row">a</th><td>blue</td><td>ball</td><td>1.2 </td></tr>
<tr><th scope="row">b</th><td>green</td><td>pen  </td><td>1    </td></tr>
<tr><th scope="row">c</th><td>yellow</td><td>pencil</td><td>0.6   </td></tr>
<tr><th scope="row">d</th><td>red  </td><td>paper</td><td>0.9  </td></tr>
<tr><th scope="row">e</th><td>white</td><td>mug  </td><td>1.7  </td></tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 style="text-align: center">Data Tables: Creating/Updating/Deleting Data</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Adding a column of values is similar to data frames:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [23]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-r"><pre><span></span>data.table.1<span class="o">$</span>location <span class="o"><-</span> <span class="kt">c</span><span class="p">(</span><span class="s">"London"</span><span class="p">,</span> <span class="s">"New York"</span><span class="p">,</span> <span class="s">"Hong Kong"</span><span class="p">,</span> <span class="s">"Singapore"</span><span class="p">,</span> <span class="s">"Paris"</span><span class="p">)</span>

data.table.1
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_html rendered_html output_subarea ">
<table>
<thead><tr><th></th><th scope="col">color</th><th scope="col">object</th><th scope="col">price</th><th scope="col">location</th></tr></thead>
<tbody>
<tr><th scope="row">1</th><td>blue  </td><td>ball  </td><td>1.2   </td><td>London</td></tr>
<tr><th scope="row">2</th><td>green   </td><td>pen     </td><td>1       </td><td>New York</td></tr>
<tr><th scope="row">3</th><td>yellow   </td><td>pencil   </td><td>0.6      </td><td>Hong Kong</td></tr>
<tr><th scope="row">4</th><td>red      </td><td>paper    </td><td>0.9      </td><td>Singapore</td></tr>
<tr><th scope="row">5</th><td>white</td><td>mug  </td><td>1.7  </td><td>Paris</td></tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Adding rows requires use of <code>rbind</code>:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [24]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-r"><pre><span></span>data.table.1 <span class="o"><-</span> <span class="kp">rbind</span><span class="p">(</span>data.table.1<span class="p">,</span> <span class="kt">list</span><span class="p">(</span><span class="s">"white"</span><span class="p">,</span> <span class="s">"pen"</span><span class="p">,</span> <span class="m">2</span><span class="p">,</span> <span class="s">"Rome"</span><span class="p">))</span>

data.table.1
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_html rendered_html output_subarea ">
<table>
<thead><tr><th></th><th scope="col">color</th><th scope="col">object</th><th scope="col">price</th><th scope="col">location</th></tr></thead>
<tbody>
<tr><th scope="row">1</th><td>blue  </td><td>ball  </td><td>1.2   </td><td>London</td></tr>
<tr><th scope="row">2</th><td>green   </td><td>pen     </td><td>1       </td><td>New York</td></tr>
<tr><th scope="row">3</th><td>yellow   </td><td>pencil   </td><td>0.6      </td><td>Hong Kong</td></tr>
<tr><th scope="row">4</th><td>red      </td><td>paper    </td><td>0.9      </td><td>Singapore</td></tr>
<tr><th scope="row">5</th><td>white</td><td>mug  </td><td>1.7  </td><td>Paris</td></tr>
<tr><th scope="row">6</th><td>white</td><td>pen  </td><td>2    </td><td>Rome </td></tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The below code changes the data table to permanently remove a column of the data table by reference:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [25]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-r"><pre><span></span>data.table.1<span class="p">[,</span> location <span class="o">:=</span> <span class="kc">NULL</span><span class="p">]</span>

data.table.1
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_html rendered_html output_subarea ">
<table>
<thead><tr><th></th><th scope="col">color</th><th scope="col">object</th><th scope="col">price</th></tr></thead>
<tbody>
<tr><th scope="row">1</th><td>blue</td><td>ball</td><td>1.2 </td></tr>
<tr><th scope="row">2</th><td>green</td><td>pen  </td><td>1    </td></tr>
<tr><th scope="row">3</th><td>yellow</td><td>pencil</td><td>0.6   </td></tr>
<tr><th scope="row">4</th><td>red  </td><td>paper</td><td>0.9  </td></tr>
<tr><th scope="row">5</th><td>white</td><td>mug  </td><td>1.7  </td></tr>
<tr><th scope="row">6</th><td>white</td><td>pen  </td><td>2    </td></tr>
</tbody>
</table>
</div>
</div>
<div class="output_area"><div class="prompt"></div>
<div class="output_html rendered_html output_subarea ">
<table>
<thead><tr><th></th><th scope="col">color</th><th scope="col">object</th><th scope="col">price</th></tr></thead>
<tbody>
<tr><th scope="row">1</th><td>blue</td><td>ball</td><td>1.2 </td></tr>
<tr><th scope="row">2</th><td>green</td><td>pen  </td><td>1    </td></tr>
<tr><th scope="row">3</th><td>yellow</td><td>pencil</td><td>0.6   </td></tr>
<tr><th scope="row">4</th><td>red  </td><td>paper</td><td>0.9  </td></tr>
<tr><th scope="row">5</th><td>white</td><td>mug  </td><td>1.7  </td></tr>
<tr><th scope="row">6</th><td>white</td><td>pen  </td><td>2    </td></tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>There is <a href="http://stackoverflow.com/questions/10790204/how-to-delete-a-row-by-reference-in-data-table">not</a> a similar code for removing the rows of a data table.</p>
<p>However, through copying the data table, we can delete both rows and columns:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [26]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-r"><pre><span></span>data.table.1<span class="o">$</span>location <span class="o"><-</span> <span class="kt">c</span><span class="p">(</span><span class="s">"London"</span><span class="p">,</span> <span class="s">"New York"</span><span class="p">,</span> <span class="s">"Hong Kong"</span><span class="p">,</span>
                           <span class="s">"Singapore"</span><span class="p">,</span> <span class="s">"Paris"</span><span class="p">,</span> <span class="s">"Rome"</span><span class="p">)</span>

data.table.1 <span class="o"><-</span> data.table.1<span class="p">[</span><span class="m">-6</span><span class="p">,</span> <span class="m">-4</span><span class="p">,</span> with <span class="o">=</span> <span class="kc">FALSE</span><span class="p">]</span>
<span class="c1">#We need with = FALSE for the column removal to work</span>

data.table.1
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_html rendered_html output_subarea ">
<table>
<thead><tr><th></th><th scope="col">color</th><th scope="col">object</th><th scope="col">price</th></tr></thead>
<tbody>
<tr><th scope="row">1</th><td>blue</td><td>ball</td><td>1.2 </td></tr>
<tr><th scope="row">2</th><td>green</td><td>pen  </td><td>1    </td></tr>
<tr><th scope="row">3</th><td>yellow</td><td>pencil</td><td>0.6   </td></tr>
<tr><th scope="row">4</th><td>red  </td><td>paper</td><td>0.9  </td></tr>
<tr><th scope="row">5</th><td>white</td><td>mug  </td><td>1.7  </td></tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 style="text-align: center"><a name="OneTableOper"></a>One Table Operations comparing dplyr with data.table and base R</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Below we are specifically examining the <code>dplyr</code> one-table <a href="https://cran.r-project.org/web/packages/dplyr/vignettes/introduction.html">'verbs'</a>, and then comparing these with the <code>data.table</code> and base R alternatives.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 style="text-align: center">Working with Remote Databases with dplyr</h3><p>The package <code>dplyr</code> is abstracted away from how the data is stored. This means that the same functions can be applied to data frames, data tables, and following four remote databases: sqlite, mysql, postgresql and google's bigquery.</p>
<p>Essentially, to create a data object based on a table in a specific remote database:</p>
<p><code>remote.data <- tbl(src_mysql("Path to database"), "Table Name")</code></p>
<p>We would replace <code>src_mysql</code> depending on the type of remote database. For a guide to working with remote databases, consult <a href="https://cran.r-project.org/web/packages/dplyr/vignettes/databases.html">here</a>.</p>
<p>We can then apply the same <code>dplyr</code> functions to this data object as with data frames and data tables.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 style="text-align: center">Filtering Rows</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>In <code>dplyr</code>, rows can be conditionally filtered using <code>filter()</code>:</strong></p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [27]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-r"><pre><span></span>data <span class="o">%>%</span> filter<span class="p">(</span>price <span class="o">></span> <span class="m">0.5</span> <span class="o">&</span> price <span class="o"><</span> <span class="m">1.2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_html rendered_html output_subarea ">
<table>
<thead><tr><th></th><th scope="col">color</th><th scope="col">object</th><th scope="col">price</th></tr></thead>
<tbody>
<tr><th scope="row">1</th><td>green</td><td>pen  </td><td>1    </td></tr>
<tr><th scope="row">2</th><td>yellow</td><td>pencil</td><td>0.6   </td></tr>
<tr><th scope="row">3</th><td>red  </td><td>paper</td><td>0.9  </td></tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Because <code>dplyr</code> imports the <code>magrittr</code> package, we can use forward-pipe operator. This inserts the left hand side object as the first argument of the function on the right. More details on operators provided by <code>magrittr</code> are available <a href="https://cran.r-project.org/web/packages/magrittr/magrittr.pdf">here</a>.</p>
<p>The below shows the equivalent without <code>%>%</code>:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [28]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-r"><pre><span></span>filter<span class="p">(</span>data<span class="p">,</span> price <span class="o">></span> <span class="m">0.5</span> <span class="o">&</span> price <span class="o"><</span> <span class="m">1.2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_html rendered_html output_subarea ">
<table>
<thead><tr><th></th><th scope="col">color</th><th scope="col">object</th><th scope="col">price</th></tr></thead>
<tbody>
<tr><th scope="row">1</th><td>green</td><td>pen  </td><td>1    </td></tr>
<tr><th scope="row">2</th><td>yellow</td><td>pencil</td><td>0.6   </td></tr>
<tr><th scope="row">3</th><td>red  </td><td>paper</td><td>0.9  </td></tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Comparing with base R:</strong></p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [29]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-r"><pre><span></span><span class="kp">subset</span><span class="p">(</span>data<span class="p">,</span> price <span class="o">></span> <span class="m">0.5</span> <span class="o">&</span> price <span class="o"><</span> <span class="m">1.2</span><span class="p">)</span>

<span class="c1">#Alternatively: data[data$price > 0.5 & data$price < 1.2,]</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_html rendered_html output_subarea ">
<table>
<thead><tr><th></th><th scope="col">color</th><th scope="col">object</th><th scope="col">price</th></tr></thead>
<tbody>
<tr><th scope="row">b</th><td>green</td><td>pen  </td><td>1    </td></tr>
<tr><th scope="row">c</th><td>yellow</td><td>pencil</td><td>0.6   </td></tr>
<tr><th scope="row">d</th><td>red  </td><td>paper</td><td>0.9  </td></tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Comparing with data tables:</strong></p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [30]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-r"><pre><span></span>data.table.1<span class="p">[</span>price <span class="o">></span> <span class="m">0.5</span> <span class="o">&</span> price <span class="o"><</span> <span class="m">1.2</span><span class="p">,]</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_html rendered_html output_subarea ">
<table>
<thead><tr><th></th><th scope="col">color</th><th scope="col">object</th><th scope="col">price</th></tr></thead>
<tbody>
<tr><th scope="row">1</th><td>green</td><td>pen  </td><td>1    </td></tr>
<tr><th scope="row">2</th><td>yellow</td><td>pencil</td><td>0.6   </td></tr>
<tr><th scope="row">3</th><td>red  </td><td>paper</td><td>0.9  </td></tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>We can also select rows by position using <code>slice()</code>:</strong></p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [31]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-r"><pre><span></span>data <span class="o">%>%</span> slice<span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="m">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_html rendered_html output_subarea ">
<table>
<thead><tr><th></th><th scope="col">color</th><th scope="col">object</th><th scope="col">price</th></tr></thead>
<tbody>
<tr><th scope="row">1</th><td>blue</td><td>ball</td><td>1.2 </td></tr>
<tr><th scope="row">2</th><td>green</td><td>pen  </td><td>1    </td></tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 style="text-align: center">Sorting Data</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>dplyr</code> uses <code>arrange()</code> to sort data by specified columns. To help illustrate functionality, we first add an unordered column to both our data frame and table:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [32]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-r"><pre><span></span>data.table.1<span class="o">$</span><span class="kt">category</span> <span class="o">=</span> data<span class="o">$</span><span class="kt">category</span> <span class="o">=</span> <span class="kt">c</span><span class="p">(</span><span class="kp">rep</span><span class="p">(</span><span class="s">"B"</span><span class="p">,</span> <span class="m">2</span><span class="p">),</span> <span class="kp">rep</span><span class="p">(</span><span class="s">"A"</span><span class="p">,</span> <span class="m">2</span><span class="p">),</span> <span class="s">"C"</span><span class="p">)</span>

data

data.table.1
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_html rendered_html output_subarea ">
<table>
<thead><tr><th></th><th scope="col">color</th><th scope="col">object</th><th scope="col">price</th><th scope="col">category</th></tr></thead>
<tbody>
<tr><th scope="row">a</th><td>blue</td><td>ball</td><td>1.2 </td><td>B   </td></tr>
<tr><th scope="row">b</th><td>green</td><td>pen  </td><td>1    </td><td>B    </td></tr>
<tr><th scope="row">c</th><td>yellow</td><td>pencil</td><td>0.6   </td><td>A     </td></tr>
<tr><th scope="row">d</th><td>red  </td><td>paper</td><td>0.9  </td><td>A    </td></tr>
<tr><th scope="row">e</th><td>white</td><td>mug  </td><td>1.7  </td><td>C    </td></tr>
</tbody>
</table>
</div>
</div>
<div class="output_area"><div class="prompt"></div>
<div class="output_html rendered_html output_subarea ">
<table>
<thead><tr><th></th><th scope="col">color</th><th scope="col">object</th><th scope="col">price</th><th scope="col">category</th></tr></thead>
<tbody>
<tr><th scope="row">1</th><td>blue</td><td>ball</td><td>1.2 </td><td>B   </td></tr>
<tr><th scope="row">2</th><td>green</td><td>pen  </td><td>1    </td><td>B    </td></tr>
<tr><th scope="row">3</th><td>yellow</td><td>pencil</td><td>0.6   </td><td>A     </td></tr>
<tr><th scope="row">4</th><td>red  </td><td>paper</td><td>0.9  </td><td>A    </td></tr>
<tr><th scope="row">5</th><td>white</td><td>mug  </td><td>1.7  </td><td>C    </td></tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Then we sort, first by category (in </strong>ascending<strong> order), and then by price (in </strong>descending<strong> order):</strong></p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [33]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-r"><pre><span></span>data <span class="o">%>%</span> arrange<span class="p">(</span><span class="kp">category</span><span class="p">,</span> desc<span class="p">(</span>price<span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_html rendered_html output_subarea ">
<table>
<thead><tr><th></th><th scope="col">color</th><th scope="col">object</th><th scope="col">price</th><th scope="col">category</th></tr></thead>
<tbody>
<tr><th scope="row">1</th><td>red  </td><td>paper</td><td>0.9  </td><td>A    </td></tr>
<tr><th scope="row">2</th><td>yellow</td><td>pencil</td><td>0.6   </td><td>A     </td></tr>
<tr><th scope="row">3</th><td>blue</td><td>ball</td><td>1.2 </td><td>B   </td></tr>
<tr><th scope="row">4</th><td>green</td><td>pen  </td><td>1    </td><td>B    </td></tr>
<tr><th scope="row">5</th><td>white</td><td>mug  </td><td>1.7  </td><td>C    </td></tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Using base R:</strong></p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [34]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-r"><pre><span></span>data<span class="p">[</span><span class="kp">order</span><span class="p">(</span>data<span class="o">$</span><span class="kp">category</span><span class="p">,</span> <span class="o">-</span><span class="kp">rank</span><span class="p">(</span>data<span class="o">$</span>price<span class="p">)),]</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_html rendered_html output_subarea ">
<table>
<thead><tr><th></th><th scope="col">color</th><th scope="col">object</th><th scope="col">price</th><th scope="col">category</th></tr></thead>
<tbody>
<tr><th scope="row">d</th><td>red  </td><td>paper</td><td>0.9  </td><td>A    </td></tr>
<tr><th scope="row">c</th><td>yellow</td><td>pencil</td><td>0.6   </td><td>A     </td></tr>
<tr><th scope="row">a</th><td>blue</td><td>ball</td><td>1.2 </td><td>B   </td></tr>
<tr><th scope="row">b</th><td>green</td><td>pen  </td><td>1    </td><td>B    </td></tr>
<tr><th scope="row">e</th><td>white</td><td>mug  </td><td>1.7  </td><td>C    </td></tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Using data tables:</strong></p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [35]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-r"><pre><span></span>data.table.1<span class="p">[</span><span class="kp">order</span><span class="p">(</span><span class="kp">category</span><span class="p">,</span> <span class="o">-</span>price<span class="p">)]</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_html rendered_html output_subarea ">
<table>
<thead><tr><th></th><th scope="col">color</th><th scope="col">object</th><th scope="col">price</th><th scope="col">category</th></tr></thead>
<tbody>
<tr><th scope="row">1</th><td>red  </td><td>paper</td><td>0.9  </td><td>A    </td></tr>
<tr><th scope="row">2</th><td>yellow</td><td>pencil</td><td>0.6   </td><td>A     </td></tr>
<tr><th scope="row">3</th><td>blue</td><td>ball</td><td>1.2 </td><td>B   </td></tr>
<tr><th scope="row">4</th><td>green</td><td>pen  </td><td>1    </td><td>B    </td></tr>
<tr><th scope="row">5</th><td>white</td><td>mug  </td><td>1.7  </td><td>C    </td></tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 style="text-align: center">Selecting Columns</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We have already examined how to select columns with <a href="#DataFrame">data frames</a> and <a href="#DataTable">data tables</a>.</p>
<p><code>dplyr</code> provides the <code>select()</code> function, which allows us to extend operations that would normally only work with the numerical indices.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [36]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-r"><pre><span></span>data <span class="o">%>%</span> select<span class="p">(</span>color<span class="p">,</span> object<span class="p">,</span> price<span class="p">)</span>

data <span class="o">%>%</span> select<span class="p">(</span>color<span class="o">:</span>price<span class="p">)</span>

<span class="c1">#We can also use original numerical indexes:</span>
  data<span class="o">%>%</span> select<span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="m">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_html rendered_html output_subarea ">
<table>
<thead><tr><th></th><th scope="col">color</th><th scope="col">object</th><th scope="col">price</th></tr></thead>
<tbody>
<tr><th scope="row">a</th><td>blue</td><td>ball</td><td>1.2 </td></tr>
<tr><th scope="row">b</th><td>green</td><td>pen  </td><td>1    </td></tr>
<tr><th scope="row">c</th><td>yellow</td><td>pencil</td><td>0.6   </td></tr>
<tr><th scope="row">d</th><td>red  </td><td>paper</td><td>0.9  </td></tr>
<tr><th scope="row">e</th><td>white</td><td>mug  </td><td>1.7  </td></tr>
</tbody>
</table>
</div>
</div>
<div class="output_area"><div class="prompt"></div>
<div class="output_html rendered_html output_subarea ">
<table>
<thead><tr><th></th><th scope="col">color</th><th scope="col">object</th><th scope="col">price</th></tr></thead>
<tbody>
<tr><th scope="row">a</th><td>blue</td><td>ball</td><td>1.2 </td></tr>
<tr><th scope="row">b</th><td>green</td><td>pen  </td><td>1    </td></tr>
<tr><th scope="row">c</th><td>yellow</td><td>pencil</td><td>0.6   </td></tr>
<tr><th scope="row">d</th><td>red  </td><td>paper</td><td>0.9  </td></tr>
<tr><th scope="row">e</th><td>white</td><td>mug  </td><td>1.7  </td></tr>
</tbody>
</table>
</div>
</div>
<div class="output_area"><div class="prompt"></div>
<div class="output_html rendered_html output_subarea ">
<table>
<thead><tr><th></th><th scope="col">color</th><th scope="col">object</th><th scope="col">price</th></tr></thead>
<tbody>
<tr><th scope="row">a</th><td>blue</td><td>ball</td><td>1.2 </td></tr>
<tr><th scope="row">b</th><td>green</td><td>pen  </td><td>1    </td></tr>
<tr><th scope="row">c</th><td>yellow</td><td>pencil</td><td>0.6   </td></tr>
<tr><th scope="row">d</th><td>red  </td><td>paper</td><td>0.9  </td></tr>
<tr><th scope="row">e</th><td>white</td><td>mug  </td><td>1.7  </td></tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>select()</code> also has helper functions that enable the selection of variables whose names meet certain criteria, for example:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [37]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-r"><pre><span></span>data <span class="o">%>%</span> select<span class="p">(</span>starts_with<span class="p">(</span><span class="s">"c"</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_html rendered_html output_subarea ">
<table>
<thead><tr><th></th><th scope="col">color</th><th scope="col">category</th></tr></thead>
<tbody>
<tr><th scope="row">a</th><td>blue</td><td>B   </td></tr>
<tr><th scope="row">b</th><td>green</td><td>B    </td></tr>
<tr><th scope="row">c</th><td>yellow</td><td>A     </td></tr>
<tr><th scope="row">d</th><td>red</td><td>A  </td></tr>
<tr><th scope="row">e</th><td>white</td><td>C    </td></tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Consult the documentation (through running <code>?select</code>) to find more on other helper functions.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>As with data frames and data tables, we use '<code>-</code>' to exclude:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [38]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-r"><pre><span></span>data <span class="o">%>%</span> select<span class="p">(</span><span class="o">-</span><span class="p">(</span>color<span class="o">:</span>price<span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_html rendered_html output_subarea ">
<table>
<thead><tr><th></th><th scope="col">category</th></tr></thead>
<tbody>
<tr><th scope="row">a</th><td>B</td></tr>
<tr><th scope="row">b</th><td>B</td></tr>
<tr><th scope="row">c</th><td>A</td></tr>
<tr><th scope="row">d</th><td>A</td></tr>
<tr><th scope="row">e</th><td>C</td></tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 style="text-align: center">Renaming Columns</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>dplyr</code> also has a function <code>rename()</code> that enables simple renaming of columns:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [39]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-r"><pre><span></span>rename<span class="p">(</span>data<span class="p">,</span> group <span class="o">=</span> <span class="kp">category</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_html rendered_html output_subarea ">
<table>
<thead><tr><th></th><th scope="col">color</th><th scope="col">object</th><th scope="col">price</th><th scope="col">group</th></tr></thead>
<tbody>
<tr><th scope="row">a</th><td>blue</td><td>ball</td><td>1.2 </td><td>B   </td></tr>
<tr><th scope="row">b</th><td>green</td><td>pen  </td><td>1    </td><td>B    </td></tr>
<tr><th scope="row">c</th><td>yellow</td><td>pencil</td><td>0.6   </td><td>A     </td></tr>
<tr><th scope="row">d</th><td>red  </td><td>paper</td><td>0.9  </td><td>A    </td></tr>
<tr><th scope="row">e</th><td>white</td><td>mug  </td><td>1.7  </td><td>C    </td></tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Note that we have to overwrite <code>data</code> with the above, if we wish to store these changes.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This is simpler than in base R:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [40]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-r"><pre><span></span><span class="kp">names</span><span class="p">(</span>data<span class="p">)[</span><span class="kp">names</span><span class="p">(</span>data<span class="p">)</span><span class="o">==</span><span class="s">"category"</span><span class="p">]</span> <span class="o"><-</span> <span class="s">"group"</span>
data
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_html rendered_html output_subarea ">
<table>
<thead><tr><th></th><th scope="col">color</th><th scope="col">object</th><th scope="col">price</th><th scope="col">group</th></tr></thead>
<tbody>
<tr><th scope="row">a</th><td>blue</td><td>ball</td><td>1.2 </td><td>B   </td></tr>
<tr><th scope="row">b</th><td>green</td><td>pen  </td><td>1    </td><td>B    </td></tr>
<tr><th scope="row">c</th><td>yellow</td><td>pencil</td><td>0.6   </td><td>A     </td></tr>
<tr><th scope="row">d</th><td>red  </td><td>paper</td><td>0.9  </td><td>A    </td></tr>
<tr><th scope="row">e</th><td>white</td><td>mug  </td><td>1.7  </td><td>C    </td></tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The equivalent in data tables:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [41]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-r"><pre><span></span>setnames<span class="p">(</span>data.table.1<span class="p">,</span> <span class="s">"category"</span><span class="p">,</span> <span class="s">"group"</span><span class="p">)</span>

data.table.1
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_html rendered_html output_subarea ">
<table>
<thead><tr><th></th><th scope="col">color</th><th scope="col">object</th><th scope="col">price</th><th scope="col">group</th></tr></thead>
<tbody>
<tr><th scope="row">1</th><td>blue</td><td>ball</td><td>1.2 </td><td>B   </td></tr>
<tr><th scope="row">2</th><td>green</td><td>pen  </td><td>1    </td><td>B    </td></tr>
<tr><th scope="row">3</th><td>yellow</td><td>pencil</td><td>0.6   </td><td>A     </td></tr>
<tr><th scope="row">4</th><td>red  </td><td>paper</td><td>0.9  </td><td>A    </td></tr>
<tr><th scope="row">5</th><td>white</td><td>mug  </td><td>1.7  </td><td>C    </td></tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Note that the data table is passed by reference - hence it should be faster to permanently change column names.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 style="text-align: center">Finding the Unique Values in a Table</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>dplyr</code> has a function <code>distinct()</code>, which provides a simple syntax for <strong>finding rows with unique column values</strong> (here examining the group column):</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [42]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-r"><pre><span></span>distinct<span class="p">(</span>data<span class="p">,</span> group<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_html rendered_html output_subarea ">
<table>
<thead><tr><th></th><th scope="col">color</th><th scope="col">object</th><th scope="col">price</th><th scope="col">group</th></tr></thead>
<tbody>
<tr><th scope="row">1</th><td>blue</td><td>ball</td><td>1.2 </td><td>B   </td></tr>
<tr><th scope="row">2</th><td>yellow</td><td>pencil</td><td>0.6   </td><td>A     </td></tr>
<tr><th scope="row">3</th><td>white</td><td>mug  </td><td>1.7  </td><td>C    </td></tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Implementing with base R:</strong></p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [43]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-r"><pre><span></span>data<span class="p">[</span><span class="o">!</span><span class="kp">duplicated</span><span class="p">(</span>data<span class="o">$</span>group<span class="p">),]</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_html rendered_html output_subarea ">
<table>
<thead><tr><th></th><th scope="col">color</th><th scope="col">object</th><th scope="col">price</th><th scope="col">group</th></tr></thead>
<tbody>
<tr><th scope="row">a</th><td>blue</td><td>ball</td><td>1.2 </td><td>B   </td></tr>
<tr><th scope="row">c</th><td>yellow</td><td>pencil</td><td>0.6   </td><td>A     </td></tr>
<tr><th scope="row">e</th><td>white</td><td>mug  </td><td>1.7  </td><td>C    </td></tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Implementing with data tables:</strong></p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The <code>data.table</code> package is <a href="https://www.r-bloggers.com/two-of-my-favorite-data-table-features/">particularly strong</a> in finding unique values, because we can set the keys (<code>setkey()</code>), which acts as an identifier for different rows. Then, when we run <code>unique()</code>, R knows to look for uniqueness in the group values:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [44]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-r"><pre><span></span>setkey<span class="p">(</span>data.table.1<span class="p">,</span> <span class="s">'group'</span><span class="p">)</span>

<span class="kp">unique</span><span class="p">(</span>data.table.1<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_html rendered_html output_subarea ">
<table>
<thead><tr><th></th><th scope="col">color</th><th scope="col">object</th><th scope="col">price</th><th scope="col">group</th></tr></thead>
<tbody>
<tr><th scope="row">1</th><td>yellow</td><td>pencil</td><td>0.6   </td><td>A     </td></tr>
<tr><th scope="row">2</th><td>blue</td><td>ball</td><td>1.2 </td><td>B   </td></tr>
<tr><th scope="row">3</th><td>white</td><td>mug  </td><td>1.7  </td><td>C    </td></tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 style="text-align: center">Applying a function to a column of data</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>dplyr</code> provides the function <code>mutate()</code> that enables the addition of new columns that are functions of other columns. This change is not permanent, unless the original data frame is overwritten.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [45]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-r"><pre><span></span>data <span class="o">%>%</span> mutate<span class="p">(</span>description <span class="o">=</span> <span class="kp">paste</span><span class="p">(</span>color<span class="p">,</span> object<span class="p">),</span>
                label <span class="o">=</span> <span class="kp">paste</span><span class="p">(</span>description<span class="p">,</span> <span class="s">"at $"</span><span class="p">,</span> price<span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_html rendered_html output_subarea ">
<table>
<thead><tr><th></th><th scope="col">color</th><th scope="col">object</th><th scope="col">price</th><th scope="col">group</th><th scope="col">description</th><th scope="col">label</th></tr></thead>
<tbody>
<tr><th scope="row">1</th><td>blue              </td><td>ball              </td><td>1.2               </td><td>B                 </td><td>blue ball         </td><td>blue ball at $ 1.2</td></tr>
<tr><th scope="row">2</th><td>green           </td><td>pen             </td><td>1               </td><td>B               </td><td>green pen       </td><td>green pen at $ 1</td></tr>
<tr><th scope="row">3</th><td>yellow                </td><td>pencil                </td><td>0.6                   </td><td>A                     </td><td>yellow pencil         </td><td>yellow pencil at $ 0.6</td></tr>
<tr><th scope="row">4</th><td>red               </td><td>paper             </td><td>0.9               </td><td>A                 </td><td>red paper         </td><td>red paper at $ 0.9</td></tr>
<tr><th scope="row">5</th><td>white             </td><td>mug               </td><td>1.7               </td><td>C                 </td><td>white mug         </td><td>white mug at $ 1.7</td></tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This is more flexible than base R's <code>transform()</code>, which does not allow you to refer to columns that you have just created:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [46]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-r"><pre><span></span><span class="kp">transform</span><span class="p">(</span>data<span class="p">,</span> description <span class="o">=</span> <span class="kp">paste</span><span class="p">(</span>color<span class="p">,</span> object<span class="p">),</span>
                label <span class="o">=</span> <span class="kp">paste</span><span class="p">(</span>color<span class="p">,</span> object<span class="p">,</span> <span class="s">"at $"</span><span class="p">,</span> price<span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_html rendered_html output_subarea ">
<table>
<thead><tr><th></th><th scope="col">color</th><th scope="col">object</th><th scope="col">price</th><th scope="col">group</th><th scope="col">description</th><th scope="col">label</th></tr></thead>
<tbody>
<tr><th scope="row">a</th><td>blue              </td><td>ball              </td><td>1.2               </td><td>B                 </td><td>blue ball         </td><td>blue ball at $ 1.2</td></tr>
<tr><th scope="row">b</th><td>green           </td><td>pen             </td><td>1               </td><td>B               </td><td>green pen       </td><td>green pen at $ 1</td></tr>
<tr><th scope="row">c</th><td>yellow                </td><td>pencil                </td><td>0.6                   </td><td>A                     </td><td>yellow pencil         </td><td>yellow pencil at $ 0.6</td></tr>
<tr><th scope="row">d</th><td>red               </td><td>paper             </td><td>0.9               </td><td>A                 </td><td>red paper         </td><td>red paper at $ 0.9</td></tr>
<tr><th scope="row">e</th><td>white             </td><td>mug               </td><td>1.7               </td><td>C                 </td><td>white mug         </td><td>white mug at $ 1.7</td></tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>With data tables, we do not have to overwrite the original dataset, instead changes are made directly. This should make the process faster for large datasets.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [47]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-r"><pre><span></span>data.table.1<span class="p">[,</span>description <span class="o">:=</span> <span class="kp">paste</span><span class="p">(</span>color<span class="p">,</span> object<span class="p">)]</span>
data.table.1<span class="p">[,</span>label <span class="o">:=</span> <span class="kp">paste</span><span class="p">(</span>description<span class="p">,</span> <span class="s">"at $"</span><span class="p">,</span> price<span class="p">)]</span>

data.table.1
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_html rendered_html output_subarea ">
<table>
<thead><tr><th></th><th scope="col">color</th><th scope="col">object</th><th scope="col">price</th><th scope="col">group</th><th scope="col">description</th></tr></thead>
<tbody>
<tr><th scope="row">1</th><td>yellow       </td><td>pencil       </td><td>0.6          </td><td>A            </td><td>yellow pencil</td></tr>
<tr><th scope="row">2</th><td>red      </td><td>paper    </td><td>0.9      </td><td>A        </td><td>red paper</td></tr>
<tr><th scope="row">3</th><td>blue     </td><td>ball     </td><td>1.2      </td><td>B        </td><td>blue ball</td></tr>
<tr><th scope="row">4</th><td>green    </td><td>pen      </td><td>1        </td><td>B        </td><td>green pen</td></tr>
<tr><th scope="row">5</th><td>white    </td><td>mug      </td><td>1.7      </td><td>C        </td><td>white mug</td></tr>
</tbody>
</table>
</div>
</div>
<div class="output_area"><div class="prompt"></div>
<div class="output_html rendered_html output_subarea ">
<table>
<thead><tr><th></th><th scope="col">color</th><th scope="col">object</th><th scope="col">price</th><th scope="col">group</th><th scope="col">description</th><th scope="col">label</th></tr></thead>
<tbody>
<tr><th scope="row">1</th><td>yellow                </td><td>pencil                </td><td>0.6                   </td><td>A                     </td><td>yellow pencil         </td><td>yellow pencil at $ 0.6</td></tr>
<tr><th scope="row">2</th><td>red               </td><td>paper             </td><td>0.9               </td><td>A                 </td><td>red paper         </td><td>red paper at $ 0.9</td></tr>
<tr><th scope="row">3</th><td>blue              </td><td>ball              </td><td>1.2               </td><td>B                 </td><td>blue ball         </td><td>blue ball at $ 1.2</td></tr>
<tr><th scope="row">4</th><td>green           </td><td>pen             </td><td>1               </td><td>B               </td><td>green pen       </td><td>green pen at $ 1</td></tr>
<tr><th scope="row">5</th><td>white             </td><td>mug               </td><td>1.7               </td><td>C                 </td><td>white mug         </td><td>white mug at $ 1.7</td></tr>
</tbody>
</table>
</div>
</div>
<div class="output_area"><div class="prompt"></div>
<div class="output_html rendered_html output_subarea ">
<table>
<thead><tr><th></th><th scope="col">color</th><th scope="col">object</th><th scope="col">price</th><th scope="col">group</th><th scope="col">description</th><th scope="col">label</th></tr></thead>
<tbody>
<tr><th scope="row">1</th><td>yellow                </td><td>pencil                </td><td>0.6                   </td><td>A                     </td><td>yellow pencil         </td><td>yellow pencil at $ 0.6</td></tr>
<tr><th scope="row">2</th><td>red               </td><td>paper             </td><td>0.9               </td><td>A                 </td><td>red paper         </td><td>red paper at $ 0.9</td></tr>
<tr><th scope="row">3</th><td>blue              </td><td>ball              </td><td>1.2               </td><td>B                 </td><td>blue ball         </td><td>blue ball at $ 1.2</td></tr>
<tr><th scope="row">4</th><td>green           </td><td>pen             </td><td>1               </td><td>B               </td><td>green pen       </td><td>green pen at $ 1</td></tr>
<tr><th scope="row">5</th><td>white             </td><td>mug               </td><td>1.7               </td><td>C                 </td><td>white mug         </td><td>white mug at $ 1.7</td></tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The below code is implemented simply to remove the above columns that we have created:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [48]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-r"><pre><span></span>data.table.1<span class="p">[,</span>description <span class="o">:=</span> <span class="kc">NULL</span><span class="p">][,</span>label <span class="o">:=</span> <span class="kc">NULL</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_html rendered_html output_subarea ">
<table>
<thead><tr><th></th><th scope="col">color</th><th scope="col">object</th><th scope="col">price</th><th scope="col">group</th></tr></thead>
<tbody>
<tr><th scope="row">1</th><td>yellow</td><td>pencil</td><td>0.6   </td><td>A     </td></tr>
<tr><th scope="row">2</th><td>red  </td><td>paper</td><td>0.9  </td><td>A    </td></tr>
<tr><th scope="row">3</th><td>blue</td><td>ball</td><td>1.2 </td><td>B   </td></tr>
<tr><th scope="row">4</th><td>green</td><td>pen  </td><td>1    </td><td>B    </td></tr>
<tr><th scope="row">5</th><td>white</td><td>mug  </td><td>1.7  </td><td>C    </td></tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 style="text-align: center">Random Sampling</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>dplyr</code> provides functions for randomly sampling a specifed number (<code>sample_n()</code>) of datapoints or specified fraction (<code>sample_frac()</code>). By default, this is without replacement:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [49]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-r"><pre><span></span><span class="c1">#Setting a seed means the same pseudo-random selection </span>
<span class="c1">#is made every time:</span>
  <span class="kp">set.seed</span><span class="p">(</span><span class="m">1</span><span class="p">)</span>

<span class="c1">#Randomly selecting a sample:</span>
  sample_frac<span class="p">(</span>data<span class="p">,</span> <span class="m">0.2</span><span class="p">)</span>

<span class="c1">#The seed needs to be set before any random sampling</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_html rendered_html output_subarea ">
<table>
<thead><tr><th></th><th scope="col">color</th><th scope="col">object</th><th scope="col">price</th><th scope="col">group</th></tr></thead>
<tbody>
<tr><th scope="row">b</th><td>green</td><td>pen  </td><td>1    </td><td>B    </td></tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can also sample with replacement, which is, for example, useful in <a href="http://machine-learning.martinsewell.com/ensembles/bagging/">bootstrap aggregating</a>:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [50]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-r"><pre><span></span><span class="kp">set.seed</span><span class="p">(</span><span class="m">1</span><span class="p">);</span> sample_frac<span class="p">(</span>data<span class="p">,</span><span class="m">1</span><span class="p">,</span> replace <span class="o">=</span> <span class="kc">TRUE</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_html rendered_html output_subarea ">
<table>
<thead><tr><th></th><th scope="col">color</th><th scope="col">object</th><th scope="col">price</th><th scope="col">group</th></tr></thead>
<tbody>
<tr><th scope="row">b</th><td>green</td><td>pen  </td><td>1    </td><td>B    </td></tr>
<tr><th scope="row">b.1</th><td>green</td><td>pen  </td><td>1    </td><td>B    </td></tr>
<tr><th scope="row">c</th><td>yellow</td><td>pencil</td><td>0.6   </td><td>A     </td></tr>
<tr><th scope="row">e</th><td>white</td><td>mug  </td><td>1.7  </td><td>C    </td></tr>
<tr><th scope="row">b.2</th><td>green</td><td>pen  </td><td>1    </td><td>B    </td></tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Random sampling in base R</strong> is more difficult. One approach is to use <code>sample()</code>, which would require transposing the data frame. This returns a matrix, and so has to be converted back into a data frame:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [51]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-r"><pre><span></span><span class="kp">set.seed</span><span class="p">(</span><span class="m">1</span><span class="p">)</span>

<span class="kt">data.frame</span><span class="p">(</span><span class="kp">t</span><span class="p">(</span><span class="kp">sample</span><span class="p">(</span><span class="kt">data.frame</span><span class="p">(</span><span class="kp">t</span><span class="p">(</span>data<span class="p">)),</span> <span class="m">1</span><span class="p">)))</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_html rendered_html output_subarea ">
<table>
<thead><tr><th></th><th scope="col">color</th><th scope="col">object</th><th scope="col">price</th><th scope="col">group</th></tr></thead>
<tbody>
<tr><th scope="row">b</th><td>green</td><td>pen  </td><td>1    </td><td>B    </td></tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>With data tables, random sampling can be done <a href="http://stackoverflow.com/questions/8273313/random-rows-in-dataframe-in-r">thus</a>:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [52]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-r"><pre><span></span><span class="kp">set.seed</span><span class="p">(</span><span class="m">1</span><span class="p">);</span> data.table.1<span class="p">[</span><span class="kp">sample</span><span class="p">(</span><span class="m">.</span>N<span class="p">,</span><span class="m">1</span><span class="p">)]</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_html rendered_html output_subarea ">
<table>
<thead><tr><th></th><th scope="col">color</th><th scope="col">object</th><th scope="col">price</th><th scope="col">group</th></tr></thead>
<tbody>
<tr><th scope="row">1</th><td>red  </td><td>paper</td><td>0.9  </td><td>A    </td></tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 style="text-align: center">Grouped Operations with dplyr</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>With <code>dplyr</code>, we can break our dataset down into subsets using <code>group_by()</code>. We can then apply functions on the individual subsets. This can be combined with <code>summarise()</code> to apply aggregate functions:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [53]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-r"><pre><span></span><span class="c1">#First need to ensure price is a float:</span>
  data<span class="o">$</span>price <span class="o">=</span> <span class="kp">as.numeric</span><span class="p">(</span>data<span class="o">$</span>price<span class="p">)</span>

<span class="c1">#Grouped operations can be applied through a chain:</span>
  data <span class="o">%>%</span> group_by<span class="p">(</span>group<span class="p">)</span><span class="o">%>%</span> summarise<span class="p">(</span>count <span class="o">=</span> n<span class="p">(),</span> mean_price <span class="o">=</span> <span class="kp">mean</span><span class="p">(</span>price<span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_html rendered_html output_subarea ">
<table>
<thead><tr><th></th><th scope="col">group</th><th scope="col">count</th><th scope="col">mean_price</th></tr></thead>
<tbody>
<tr><th scope="row">1</th><td>A   </td><td>2   </td><td>0.75</td></tr>
<tr><th scope="row">2</th><td>B  </td><td>2  </td><td>1.1</td></tr>
<tr><th scope="row">3</th><td>C  </td><td>1  </td><td>1.7</td></tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>There are a variety of different aggregate functions available. More details are available in this <a href="https://cran.rstudio.com/web/packages/dplyr/vignettes/introduction.html">vignette</a>, under 'Grouped Operations'.</p>
<p>We can also combine the above single table verbs with <code>group_by()</code>. For example, <code>sample_n()</code> or <code>sample_frac()</code> could be used to sample a specified number or fraction of rows from each subset. We can also use <code>filter()</code> and <code>mutate()</code> with <a href="https://cran.rstudio.com/web/packages/dplyr/vignettes/window-functions.html">window functions</a>:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [54]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-r"><pre><span></span><span class="c1">#Ranking by price within each group:</span>
  data <span class="o">%>%</span> group_by<span class="p">(</span>group<span class="p">)</span><span class="o">%>%</span> mutate<span class="p">(</span>group_rank <span class="o">=</span> <span class="kp">rank</span><span class="p">(</span>price<span class="p">))</span>

<span class="c1">#Only the rows with the highest price in each group:</span>
  data <span class="o">%>%</span> group_by<span class="p">(</span>group<span class="p">)</span><span class="o">%>%</span> filter<span class="p">(</span><span class="kp">rank</span><span class="p">(</span>price<span class="p">)</span> <span class="o">==</span> <span class="m">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_html rendered_html output_subarea ">
<table>
<thead><tr><th></th><th scope="col">color</th><th scope="col">object</th><th scope="col">price</th><th scope="col">group</th><th scope="col">group_rank</th></tr></thead>
<tbody>
<tr><th scope="row">1</th><td>blue</td><td>ball</td><td>1.2 </td><td>B   </td><td>2   </td></tr>
<tr><th scope="row">2</th><td>green</td><td>pen  </td><td>1    </td><td>B    </td><td>1    </td></tr>
<tr><th scope="row">3</th><td>yellow</td><td>pencil</td><td>0.6   </td><td>A     </td><td>1     </td></tr>
<tr><th scope="row">4</th><td>red  </td><td>paper</td><td>0.9  </td><td>A    </td><td>2    </td></tr>
<tr><th scope="row">5</th><td>white</td><td>mug  </td><td>1.7  </td><td>C    </td><td>1    </td></tr>
</tbody>
</table>
</div>
</div>
<div class="output_area"><div class="prompt"></div>
<div class="output_html rendered_html output_subarea ">
<table>
<thead><tr><th></th><th scope="col">color</th><th scope="col">object</th><th scope="col">price</th><th scope="col">group</th></tr></thead>
<tbody>
<tr><th scope="row">1</th><td>green</td><td>pen  </td><td>1    </td><td>B    </td></tr>
<tr><th scope="row">2</th><td>yellow</td><td>pencil</td><td>0.6   </td><td>A     </td></tr>
<tr><th scope="row">3</th><td>white</td><td>mug  </td><td>1.7  </td><td>C    </td></tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 style="text-align: center">Grouped Operations with data tables</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The <code>data.table</code> package provides a very concise syntax for grouped operations. However, this can be less readable. Below we find the mean and total price for each group:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [55]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-r"><pre><span></span>data.table.1<span class="p">[,</span>group_mean <span class="o">:=</span> <span class="kp">mean</span><span class="p">(</span>price<span class="p">),</span> by<span class="o">=</span><span class="s">"group"</span><span class="p">][</span>
             <span class="p">,</span>group_sum <span class="o">:=</span> <span class="kp">sum</span><span class="p">(</span>price<span class="p">),</span>   by<span class="o">=</span><span class="s">"group"</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_html rendered_html output_subarea ">
<table>
<thead><tr><th></th><th scope="col">color</th><th scope="col">object</th><th scope="col">price</th><th scope="col">group</th><th scope="col">group_mean</th><th scope="col">group_sum</th></tr></thead>
<tbody>
<tr><th scope="row">1</th><td>yellow</td><td>pencil</td><td>0.6   </td><td>A     </td><td>0.75  </td><td>1.5   </td></tr>
<tr><th scope="row">2</th><td>red  </td><td>paper</td><td>0.9  </td><td>A    </td><td>0.75 </td><td>1.5  </td></tr>
<tr><th scope="row">3</th><td>blue</td><td>ball</td><td>1.2 </td><td>B   </td><td>1.1 </td><td>2.2 </td></tr>
<tr><th scope="row">4</th><td>green</td><td>pen  </td><td>1    </td><td>B    </td><td>1.1  </td><td>2.2  </td></tr>
<tr><th scope="row">5</th><td>white</td><td>mug  </td><td>1.7  </td><td>C    </td><td>1.7  </td><td>1.7  </td></tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Or, if we only wanted the group means:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [56]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-r"><pre><span></span>data.table.1<span class="p">[,</span><span class="kp">mean</span><span class="p">(</span>price<span class="p">),</span> by<span class="o">=</span><span class="s">"group"</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_html rendered_html output_subarea ">
<table>
<thead><tr><th></th><th scope="col">group</th><th scope="col">V1</th></tr></thead>
<tbody>
<tr><th scope="row">1</th><td>A   </td><td>0.75</td></tr>
<tr><th scope="row">2</th><td>B  </td><td>1.1</td></tr>
<tr><th scope="row">3</th><td>C  </td><td>1.7</td></tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Similarly, we can apply window functions:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [57]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-r"><pre><span></span><span class="c1">#Price rankings in each group:</span>
  data.table.1<span class="p">[,</span><span class="kp">rank</span><span class="p">(</span>price<span class="p">),</span> by<span class="o">=</span><span class="s">"group"</span><span class="p">]</span>

<span class="c1">#Top prices from each group:</span>
  data.table.1<span class="p">[,</span>price<span class="p">[</span><span class="kp">rank</span><span class="p">(</span>price<span class="p">)</span> <span class="o">==</span> <span class="m">1</span><span class="p">],</span> by<span class="o">=</span><span class="s">"group"</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_html rendered_html output_subarea ">
<table>
<thead><tr><th></th><th scope="col">group</th><th scope="col">V1</th></tr></thead>
<tbody>
<tr><th scope="row">1</th><td>A</td><td>1</td></tr>
<tr><th scope="row">2</th><td>A</td><td>2</td></tr>
<tr><th scope="row">3</th><td>B</td><td>2</td></tr>
<tr><th scope="row">4</th><td>B</td><td>1</td></tr>
<tr><th scope="row">5</th><td>C</td><td>1</td></tr>
</tbody>
</table>
</div>
</div>
<div class="output_area"><div class="prompt"></div>
<div class="output_html rendered_html output_subarea ">
<table>
<thead><tr><th></th><th scope="col">group</th><th scope="col">V1</th></tr></thead>
<tbody>
<tr><th scope="row">1</th><td>A  </td><td>0.6</td></tr>
<tr><th scope="row">2</th><td>B</td><td>1</td></tr>
<tr><th scope="row">3</th><td>C  </td><td>1.7</td></tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 style="text-align: center"><a name="Joins"></a>Joins: base R vs dplyr vs data tables</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>First we create two data frames and two data tables. The example data is the same as was used with <a href="https://andrew47.github.io/pages/pandas-sql.html">Python pandas</a>, to enable comparison between R and Python pandas joins:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [58]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-r"><pre><span></span>frame1 <span class="o"><-</span> <span class="kt">data.frame</span><span class="p">(</span>id <span class="o">=</span> <span class="kt">c</span><span class="p">(</span><span class="s">"ball"</span><span class="p">,</span><span class="s">"pencil"</span><span class="p">,</span><span class="s">"pen"</span><span class="p">,</span><span class="s">"mug"</span><span class="p">,</span><span class="s">"ashtray"</span><span class="p">),</span>
                     price <span class="o">=</span> <span class="kt">c</span><span class="p">(</span><span class="m">12.33</span><span class="p">,</span><span class="m">11.44</span><span class="p">,</span><span class="m">33.21</span><span class="p">,</span><span class="m">13.23</span><span class="p">,</span><span class="m">33.62</span><span class="p">))</span>

frame2 <span class="o"><-</span> <span class="kt">data.frame</span><span class="p">(</span>id <span class="o">=</span> <span class="kt">c</span><span class="p">(</span><span class="s">"pencil"</span><span class="p">,</span><span class="s">"pencil"</span><span class="p">,</span><span class="s">"ball"</span><span class="p">,</span><span class="s">"pen"</span><span class="p">,</span><span class="s">"desk"</span><span class="p">),</span>
                     color <span class="o">=</span> <span class="kt">c</span><span class="p">(</span><span class="s">"white"</span><span class="p">,</span><span class="s">"red"</span><span class="p">,</span><span class="s">"red"</span><span class="p">,</span><span class="s">"black"</span><span class="p">,</span><span class="s">"orange"</span><span class="p">))</span>

frame2a <span class="o"><-</span> <span class="kt">data.frame</span><span class="p">(</span>identification <span class="o">=</span> <span class="kt">c</span><span class="p">(</span><span class="s">"pencil"</span><span class="p">,</span><span class="s">"pencil"</span><span class="p">,</span><span class="s">"ball"</span><span class="p">,</span><span class="s">"pen"</span><span class="p">,</span><span class="s">"desk"</span><span class="p">),</span>
                      color <span class="o">=</span> <span class="kt">c</span><span class="p">(</span><span class="s">"white"</span><span class="p">,</span><span class="s">"red"</span><span class="p">,</span><span class="s">"red"</span><span class="p">,</span><span class="s">"black"</span><span class="p">,</span><span class="s">"orange"</span><span class="p">))</span>

data.table.1 <span class="o"><-</span> data.table<span class="p">(</span>frame1<span class="p">)</span>

data.table.2 <span class="o"><-</span> data.table<span class="p">(</span>frame2<span class="p">)</span>

data.table.2a <span class="o"><-</span> data.table<span class="p">(</span>frame2a<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li><strong>With base R</strong>:</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [59]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-r"><pre><span></span><span class="kp">print</span><span class="p">(</span><span class="s">"INNER JOIN"</span><span class="p">)</span>
  frame1 <span class="o">%>%</span> <span class="kp">merge</span><span class="p">(</span>frame2<span class="p">,</span> by <span class="o">=</span> <span class="s">"id"</span><span class="p">,</span> all <span class="o">=</span> <span class="kc">FALSE</span><span class="p">)</span>

<span class="kp">print</span><span class="p">(</span><span class="s">"LEFT JOIN"</span><span class="p">)</span>
  frame1 <span class="o">%>%</span> <span class="kp">merge</span><span class="p">(</span>frame2<span class="p">,</span> by <span class="o">=</span> <span class="s">"id"</span><span class="p">,</span> all.x <span class="o">=</span> <span class="kc">TRUE</span><span class="p">)</span>

<span class="kp">print</span><span class="p">(</span><span class="s">"RIGHT JOIN"</span><span class="p">)</span>
  frame1 <span class="o">%>%</span> <span class="kp">merge</span><span class="p">(</span>frame2<span class="p">,</span> by <span class="o">=</span> <span class="s">"id"</span><span class="p">,</span> all.y <span class="o">=</span> <span class="kc">TRUE</span><span class="p">)</span>

<span class="kp">print</span><span class="p">(</span><span class="s">"FULL OUTER JOIN"</span><span class="p">)</span>
  frame1 <span class="o">%>%</span> <span class="kp">merge</span><span class="p">(</span>frame2<span class="p">,</span> by <span class="o">=</span> <span class="s">"id"</span><span class="p">,</span> all <span class="o">=</span> <span class="kc">TRUE</span><span class="p">)</span>

<span class="kp">print</span><span class="p">(</span><span class="s">"MATCH ID WITH IDENTIFICATION"</span><span class="p">)</span>
  frame1 <span class="o">%>%</span> <span class="kp">merge</span><span class="p">(</span>frame2a<span class="p">,</span> 
                   all <span class="o">=</span> <span class="kc">FALSE</span><span class="p">,</span> 
                   by.x <span class="o">=</span> <span class="s">"id"</span><span class="p">,</span>
                   by.y <span class="o">=</span> <span class="s">"identification"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>[1] "INNER JOIN"
</pre>
</div>
</div>
<div class="output_area"><div class="prompt"></div>
<div class="output_html rendered_html output_subarea ">
<table>
<thead><tr><th></th><th scope="col">id</th><th scope="col">price</th><th scope="col">color</th></tr></thead>
<tbody>
<tr><th scope="row">1</th><td>ball </td><td>12.33</td><td>red  </td></tr>
<tr><th scope="row">2</th><td>pen  </td><td>33.21</td><td>black</td></tr>
<tr><th scope="row">3</th><td>pencil</td><td>11.44 </td><td>white </td></tr>
<tr><th scope="row">4</th><td>pencil</td><td>11.44 </td><td>red   </td></tr>
</tbody>
</table>
</div>
</div>
<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>[1] "LEFT JOIN"
</pre>
</div>
</div>
<div class="output_area"><div class="prompt"></div>
<div class="output_html rendered_html output_subarea ">
<table>
<thead><tr><th></th><th scope="col">id</th><th scope="col">price</th><th scope="col">color</th></tr></thead>
<tbody>
<tr><th scope="row">1</th><td>ashtray</td><td>33.62  </td><td>NA     </td></tr>
<tr><th scope="row">2</th><td>ball </td><td>12.33</td><td>red  </td></tr>
<tr><th scope="row">3</th><td>mug  </td><td>13.23</td><td>NA   </td></tr>
<tr><th scope="row">4</th><td>pen  </td><td>33.21</td><td>black</td></tr>
<tr><th scope="row">5</th><td>pencil</td><td>11.44 </td><td>white </td></tr>
<tr><th scope="row">6</th><td>pencil</td><td>11.44 </td><td>red   </td></tr>
</tbody>
</table>
</div>
</div>
<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>[1] "RIGHT JOIN"
</pre>
</div>
</div>
<div class="output_area"><div class="prompt"></div>
<div class="output_html rendered_html output_subarea ">
<table>
<thead><tr><th></th><th scope="col">id</th><th scope="col">price</th><th scope="col">color</th></tr></thead>
<tbody>
<tr><th scope="row">1</th><td>ball </td><td>12.33</td><td>red  </td></tr>
<tr><th scope="row">2</th><td>pen  </td><td>33.21</td><td>black</td></tr>
<tr><th scope="row">3</th><td>pencil</td><td>11.44 </td><td>white </td></tr>
<tr><th scope="row">4</th><td>pencil</td><td>11.44 </td><td>red   </td></tr>
<tr><th scope="row">5</th><td>desk  </td><td>NA    </td><td>orange</td></tr>
</tbody>
</table>
</div>
</div>
<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>[1] "FULL OUTER JOIN"
</pre>
</div>
</div>
<div class="output_area"><div class="prompt"></div>
<div class="output_html rendered_html output_subarea ">
<table>
<thead><tr><th></th><th scope="col">id</th><th scope="col">price</th><th scope="col">color</th></tr></thead>
<tbody>
<tr><th scope="row">1</th><td>ashtray</td><td>33.62  </td><td>NA     </td></tr>
<tr><th scope="row">2</th><td>ball </td><td>12.33</td><td>red  </td></tr>
<tr><th scope="row">3</th><td>mug  </td><td>13.23</td><td>NA   </td></tr>
<tr><th scope="row">4</th><td>pen  </td><td>33.21</td><td>black</td></tr>
<tr><th scope="row">5</th><td>pencil</td><td>11.44 </td><td>white </td></tr>
<tr><th scope="row">6</th><td>pencil</td><td>11.44 </td><td>red   </td></tr>
<tr><th scope="row">7</th><td>desk  </td><td>NA    </td><td>orange</td></tr>
</tbody>
</table>
</div>
</div>
<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>[1] "MATCH ID WITH IDENTIFICATION"
</pre>
</div>
</div>
<div class="output_area"><div class="prompt"></div>
<div class="output_html rendered_html output_subarea ">
<table>
<thead><tr><th></th><th scope="col">id</th><th scope="col">price</th><th scope="col">color</th></tr></thead>
<tbody>
<tr><th scope="row">1</th><td>ball </td><td>12.33</td><td>red  </td></tr>
<tr><th scope="row">2</th><td>pen  </td><td>33.21</td><td>black</td></tr>
<tr><th scope="row">3</th><td>pencil</td><td>11.44 </td><td>white </td></tr>
<tr><th scope="row">4</th><td>pencil</td><td>11.44 </td><td>red   </td></tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li><strong>With dplyr</strong>:</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [60]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-r"><pre><span></span><span class="kp">print</span><span class="p">(</span><span class="s">"INNER JOIN"</span><span class="p">)</span>
  frame1 <span class="o">%>%</span> inner_join<span class="p">(</span>frame2<span class="p">,</span> by <span class="o">=</span> <span class="s">"id"</span><span class="p">)</span>

<span class="kp">print</span><span class="p">(</span><span class="s">"LEFT JOIN"</span><span class="p">)</span>
  frame1 <span class="o">%>%</span> left_join<span class="p">(</span>frame2<span class="p">,</span> by<span class="o">=</span><span class="s">"id"</span><span class="p">)</span>

<span class="kp">print</span><span class="p">(</span><span class="s">"RIGHT JOIN"</span><span class="p">)</span>
  frame1 <span class="o">%>%</span> right_join<span class="p">(</span>frame2<span class="p">,</span> by<span class="o">=</span><span class="s">"id"</span><span class="p">)</span>

<span class="kp">print</span><span class="p">(</span><span class="s">"FULL OUTER JOIN"</span><span class="p">)</span>
  frame1 <span class="o">%>%</span> full_join<span class="p">(</span>frame2<span class="p">,</span> by<span class="o">=</span><span class="s">"id"</span><span class="p">)</span>

<span class="kp">print</span><span class="p">(</span><span class="s">"MATCH ID WITH IDENTIFICATION"</span><span class="p">)</span>
  frame1 <span class="o">%>%</span> inner_join<span class="p">(</span>frame2a<span class="p">,</span> 
                        by<span class="o">=</span><span class="kt">c</span><span class="p">(</span><span class="s">"id"</span> <span class="o">=</span> <span class="s">"identification"</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>[1] "INNER JOIN"
</pre>
</div>
</div>
<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre>Warning message:
In inner_join_impl(x, y, by$x, by$y): joining factors with different levels, coercing to character vector</pre>
</div>
</div>
<div class="output_area"><div class="prompt"></div>
<div class="output_html rendered_html output_subarea ">
<table>
<thead><tr><th></th><th scope="col">id</th><th scope="col">price</th><th scope="col">color</th></tr></thead>
<tbody>
<tr><th scope="row">1</th><td>ball </td><td>12.33</td><td>red  </td></tr>
<tr><th scope="row">2</th><td>pencil</td><td>11.44 </td><td>white </td></tr>
<tr><th scope="row">3</th><td>pencil</td><td>11.44 </td><td>red   </td></tr>
<tr><th scope="row">4</th><td>pen  </td><td>33.21</td><td>black</td></tr>
</tbody>
</table>
</div>
</div>
<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>[1] "LEFT JOIN"
</pre>
</div>
</div>
<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre>Warning message:
In left_join_impl(x, y, by$x, by$y): joining factors with different levels, coercing to character vector</pre>
</div>
</div>
<div class="output_area"><div class="prompt"></div>
<div class="output_html rendered_html output_subarea ">
<table>
<thead><tr><th></th><th scope="col">id</th><th scope="col">price</th><th scope="col">color</th></tr></thead>
<tbody>
<tr><th scope="row">1</th><td>ball </td><td>12.33</td><td>red  </td></tr>
<tr><th scope="row">2</th><td>pencil</td><td>11.44 </td><td>white </td></tr>
<tr><th scope="row">3</th><td>pencil</td><td>11.44 </td><td>red   </td></tr>
<tr><th scope="row">4</th><td>pen  </td><td>33.21</td><td>black</td></tr>
<tr><th scope="row">5</th><td>mug  </td><td>13.23</td><td>NA   </td></tr>
<tr><th scope="row">6</th><td>ashtray</td><td>33.62  </td><td>NA     </td></tr>
</tbody>
</table>
</div>
</div>
<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>[1] "RIGHT JOIN"
</pre>
</div>
</div>
<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre>Warning message:
In right_join_impl(x, y, by$x, by$y): joining factors with different levels, coercing to character vector</pre>
</div>
</div>
<div class="output_area"><div class="prompt"></div>
<div class="output_html rendered_html output_subarea ">
<table>
<thead><tr><th></th><th scope="col">id</th><th scope="col">price</th><th scope="col">color</th></tr></thead>
<tbody>
<tr><th scope="row">1</th><td>pencil</td><td>11.44 </td><td>white </td></tr>
<tr><th scope="row">2</th><td>pencil</td><td>11.44 </td><td>red   </td></tr>
<tr><th scope="row">3</th><td>ball </td><td>12.33</td><td>red  </td></tr>
<tr><th scope="row">4</th><td>pen  </td><td>33.21</td><td>black</td></tr>
<tr><th scope="row">5</th><td>desk  </td><td>NA    </td><td>orange</td></tr>
</tbody>
</table>
</div>
</div>
<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>[1] "FULL OUTER JOIN"
</pre>
</div>
</div>
<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre>Warning message:
In outer_join_impl(x, y, by$x, by$y): joining factors with different levels, coercing to character vector</pre>
</div>
</div>
<div class="output_area"><div class="prompt"></div>
<div class="output_html rendered_html output_subarea ">
<table>
<thead><tr><th></th><th scope="col">id</th><th scope="col">price</th><th scope="col">color</th></tr></thead>
<tbody>
<tr><th scope="row">1</th><td>ball </td><td>12.33</td><td>red  </td></tr>
<tr><th scope="row">2</th><td>pencil</td><td>11.44 </td><td>white </td></tr>
<tr><th scope="row">3</th><td>pencil</td><td>11.44 </td><td>red   </td></tr>
<tr><th scope="row">4</th><td>pen  </td><td>33.21</td><td>black</td></tr>
<tr><th scope="row">5</th><td>mug  </td><td>13.23</td><td>NA   </td></tr>
<tr><th scope="row">6</th><td>ashtray</td><td>33.62  </td><td>NA     </td></tr>
<tr><th scope="row">7</th><td>desk  </td><td>NA    </td><td>orange</td></tr>
</tbody>
</table>
</div>
</div>
<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>[1] "MATCH ID WITH IDENTIFICATION"
</pre>
</div>
</div>
<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre>Warning message:
In inner_join_impl(x, y, by$x, by$y): joining factors with different levels, coercing to character vector</pre>
</div>
</div>
<div class="output_area"><div class="prompt"></div>
<div class="output_html rendered_html output_subarea ">
<table>
<thead><tr><th></th><th scope="col">id</th><th scope="col">price</th><th scope="col">color</th></tr></thead>
<tbody>
<tr><th scope="row">1</th><td>ball </td><td>12.33</td><td>red  </td></tr>
<tr><th scope="row">2</th><td>pencil</td><td>11.44 </td><td>white </td></tr>
<tr><th scope="row">3</th><td>pencil</td><td>11.44 </td><td>red   </td></tr>
<tr><th scope="row">4</th><td>pen  </td><td>33.21</td><td>black</td></tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>A full guide to two table joins in <code>dplyr</code> is available <a href="https://cran.rstudio.com/web/packages/dplyr/vignettes/two-table.html">here</a>. The above focuses on joins with equivalents in SQL</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li><strong>With data tables</strong>:</li>
</ul>
<p>Here we can either use <code>merge()</code>, which operates just as in base R, except the default columns to be used in joins are the keys specified by <code>setkey()</code>. Otherwise, we can use concise data table specific syntax. A full tutorial is available <a href="http://rpubs.com/ronasta/join_data_tables">here</a>.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [61]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-r"><pre><span></span>setkey<span class="p">(</span>data.table.1<span class="p">,</span> <span class="s">"id"</span><span class="p">)</span>
setkey<span class="p">(</span>data.table.2<span class="p">,</span> <span class="s">"id"</span><span class="p">)</span>
setkey<span class="p">(</span>data.table.2a<span class="p">,</span> <span class="s">"identification"</span><span class="p">)</span>

<span class="kp">print</span><span class="p">(</span><span class="s">"INNER JOIN"</span><span class="p">)</span>
  data.table.1<span class="p">[</span>data.table.2<span class="p">,</span> nomatch <span class="o">=</span> <span class="m">0</span><span class="p">]</span>
  <span class="c1">#merge(data.table.1, data.table.2, all = FALSE)</span>

<span class="kp">print</span><span class="p">(</span><span class="s">"LEFT JOIN"</span><span class="p">)</span>
  data.table.2<span class="p">[</span>data.table.1<span class="p">]</span>
  <span class="c1">#merge(data.table.1, data.table.2, all.x = TRUE)</span>

<span class="kp">print</span><span class="p">(</span><span class="s">"RIGHT JOIN"</span><span class="p">)</span>
  data.table.1<span class="p">[</span>data.table.2<span class="p">]</span>
  <span class="c1">#merge(data.table.1, data.table.2, all.y = TRUE)</span>

<span class="kp">print</span><span class="p">(</span><span class="s">"FULL OUTER JOIN"</span><span class="p">)</span>
  <span class="kp">merge</span><span class="p">(</span>data.table.1<span class="p">,</span> data.table.2<span class="p">,</span> all <span class="o">=</span> <span class="kc">TRUE</span><span class="p">)</span>

<span class="kp">print</span><span class="p">(</span><span class="s">"MATCH ID WITH IDENTIFICATION"</span><span class="p">)</span>
  <span class="kp">merge</span><span class="p">(</span>data.table.1<span class="p">,</span> data.table.2<span class="p">,</span> all <span class="o">=</span> <span class="kc">FALSE</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>[1] "INNER JOIN"
</pre>
</div>
</div>
<div class="output_area"><div class="prompt"></div>
<div class="output_html rendered_html output_subarea ">
<table>
<thead><tr><th></th><th scope="col">id</th><th scope="col">price</th><th scope="col">color</th></tr></thead>
<tbody>
<tr><th scope="row">1</th><td>ball </td><td>12.33</td><td>red  </td></tr>
<tr><th scope="row">2</th><td>pen  </td><td>33.21</td><td>black</td></tr>
<tr><th scope="row">3</th><td>pencil</td><td>11.44 </td><td>white </td></tr>
<tr><th scope="row">4</th><td>pencil</td><td>11.44 </td><td>red   </td></tr>
</tbody>
</table>
</div>
</div>
<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>[1] "LEFT JOIN"
</pre>
</div>
</div>
<div class="output_area"><div class="prompt"></div>
<div class="output_html rendered_html output_subarea ">
<table>
<thead><tr><th></th><th scope="col">id</th><th scope="col">color</th><th scope="col">price</th></tr></thead>
<tbody>
<tr><th scope="row">1</th><td>ashtray</td><td>NA     </td><td>33.62  </td></tr>
<tr><th scope="row">2</th><td>ball </td><td>red  </td><td>12.33</td></tr>
<tr><th scope="row">3</th><td>mug  </td><td>NA   </td><td>13.23</td></tr>
<tr><th scope="row">4</th><td>pen  </td><td>black</td><td>33.21</td></tr>
<tr><th scope="row">5</th><td>pencil</td><td>white </td><td>11.44 </td></tr>
<tr><th scope="row">6</th><td>pencil</td><td>red   </td><td>11.44 </td></tr>
</tbody>
</table>
</div>
</div>
<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>[1] "RIGHT JOIN"
</pre>
</div>
</div>
<div class="output_area"><div class="prompt"></div>
<div class="output_html rendered_html output_subarea ">
<table>
<thead><tr><th></th><th scope="col">id</th><th scope="col">price</th><th scope="col">color</th></tr></thead>
<tbody>
<tr><th scope="row">1</th><td>ball </td><td>12.33</td><td>red  </td></tr>
<tr><th scope="row">2</th><td>desk  </td><td>NA    </td><td>orange</td></tr>
<tr><th scope="row">3</th><td>pen  </td><td>33.21</td><td>black</td></tr>
<tr><th scope="row">4</th><td>pencil</td><td>11.44 </td><td>white </td></tr>
<tr><th scope="row">5</th><td>pencil</td><td>11.44 </td><td>red   </td></tr>
</tbody>
</table>
</div>
</div>
<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>[1] "FULL OUTER JOIN"
</pre>
</div>
</div>
<div class="output_area"><div class="prompt"></div>
<div class="output_html rendered_html output_subarea ">
<table>
<thead><tr><th></th><th scope="col">id</th><th scope="col">price</th><th scope="col">color</th></tr></thead>
<tbody>
<tr><th scope="row">1</th><td>ashtray</td><td>33.62  </td><td>NA     </td></tr>
<tr><th scope="row">2</th><td>ball </td><td>12.33</td><td>red  </td></tr>
<tr><th scope="row">3</th><td>mug  </td><td>13.23</td><td>NA   </td></tr>
<tr><th scope="row">4</th><td>pen  </td><td>33.21</td><td>black</td></tr>
<tr><th scope="row">5</th><td>pencil</td><td>11.44 </td><td>white </td></tr>
<tr><th scope="row">6</th><td>pencil</td><td>11.44 </td><td>red   </td></tr>
<tr><th scope="row">7</th><td>desk  </td><td>NA    </td><td>orange</td></tr>
</tbody>
</table>
</div>
</div>
<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>[1] "MATCH ID WITH IDENTIFICATION"
</pre>
</div>
</div>
<div class="output_area"><div class="prompt"></div>
<div class="output_html rendered_html output_subarea ">
<table>
<thead><tr><th></th><th scope="col">id</th><th scope="col">price</th><th scope="col">color</th></tr></thead>
<tbody>
<tr><th scope="row">1</th><td>ball </td><td>12.33</td><td>red  </td></tr>
<tr><th scope="row">2</th><td>pen  </td><td>33.21</td><td>black</td></tr>
<tr><th scope="row">3</th><td>pencil</td><td>11.44 </td><td>white </td></tr>
<tr><th scope="row">4</th><td>pencil</td><td>11.44 </td><td>red   </td></tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 style="text-align: center">Further Reading</h2><p>The above was written using:</p>
<ul>
<li><p>Example data from Nelli, F., 2015. "Python Data Analytics: Data Analysis and Science Using Pandas, Matplotlib, and the Python Programming Language". Apress.</p>
</li>
<li><p>An Introduction to the data.table package in R (revised 2015) - available <a href="https://cran.r-project.org/web/packages/data.table/vignettes/datatable-intro.pdf">here</a></p>
</li>
<li><p>Introduction to dplyr (2016) - available <a href="https://cran.rstudio.com/web/packages/dplyr/vignettes/introduction.html">here</a>, with an introduction to two-table verbs (including joins) available <a href="https://cran.rstudio.com/web/packages/dplyr/vignettes/two-table.html">here</a></p>
</li>
<li><p>Introduction to interacting with remote databases using dplyr is available <a href="(https://cran.r-project.org/web/packages/dplyr/vignettes/databases.html">here</a></p>
</li>
<li><p>Tutorial on how to join data tables available <a href="http://rpubs.com/ronasta/join_data_tables">here</a></p>
</li>
</ul>
</div>
</div>
</div>
<script type="text/javascript">if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = '//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML';
    mathjaxscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: 'center'," +
        "    displayIndent: '0em'," +
        "    showMathMenu: true," +
        "    tex2jax: { " +
        "        inlineMath: [ ['$','$'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }" +
        "    } " +
        "}); ";
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
</script>

    </div>
  </div>
  <hr class="separator">
  <div class="col-md-8 col-md-offset-2">
  </div>
  </div>
<footer class="footer">
  <div class="container">
    <p class="text-center">
      Andrew Burnie, <a href="" target="_blank"></a> unless otherwise noted.
    </p>
    <div class="text-center">
      Generated by <a href="http://getpelican.com" target="_blank">Pelican</a> with the <a href="http://github.com/nairobilug/pelican-alchemy">alchemy</a> theme.
    </div>
  </div>
</footer> <!-- /.footer -->
  <script src="/theme/js/jquery.min.js"></script>
  <script src="/theme/js/bootstrap.min.js"></script>
</body> <!-- 42 -->

</html>